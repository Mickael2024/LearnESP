<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ArduinoLearn - Tutoriels Complets</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary-color: #00979c;
      --secondary-color: #00696b;
      --accent-color: #ff9800;
      --light-color: #f8f9fa;
      --dark-color: #333;
      --gray-color: #6c757d;
      --code-bg: #f4f4f4;
      --success-color: #28a745;
      --danger-color: #dc3545;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background-color: #f5f5f5;
      color: var(--dark-color);
      line-height: 1.6;
    }

    .container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* Header */
    header {
      background-color: var(--primary-color);
      color: white;
      padding: 1rem 0;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      font-size: 1.8rem;
      font-weight: 700;
      display: flex;
      align-items: center;
    }

    .logo i {
      margin-right: 10px;
      color: var(--accent-color);
    }

    .logo span {
      color: var(--accent-color);
    }

    nav ul {
      display: flex;
      list-style: none;
    }

    nav ul li {
      margin-left: 1.5rem;
    }

    nav ul li a {
      color: white;
      text-decoration: none;
      font-weight: 500;
      transition: color 0.3s;
      padding: 5px 10px;
      border-radius: 4px;
    }

    nav ul li a:hover {
      color: var(--accent-color);
      background-color: rgba(255, 255, 255, 0.1);
    }

    /* Hero Section */
    .hero {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      padding: 4rem 0;
      text-align: center;
      margin-bottom: 2rem;
    }

    .hero h1 {
      font-size: 2.8rem;
      margin-bottom: 1rem;
    }

    .hero p {
      font-size: 1.2rem;
      max-width: 800px;
      margin: 0 auto 2rem;
      opacity: 0.9;
    }

    .cta-button {
      display: inline-block;
      background-color: var(--accent-color);
      color: white;
      padding: 0.8rem 2rem;
      text-decoration: none;
      border-radius: 50px;
      font-weight: 600;
      font-size: 1.1rem;
      transition: transform 0.3s, box-shadow 0.3s;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    .cta-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
      color: white;
    }

    /* Main Content */
    .main-content {
      display: flex;
      margin-bottom: 3rem;
      gap: 2rem;
    }

    /* Sidebar */
    .sidebar {
      flex: 0 0 300px;
      background-color: white;
      border-radius: 8px;
      padding: 1.5rem;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      align-self: flex-start;
      position: sticky;
      top: 100px;
      max-height: 80vh;
      overflow-y: auto;
    }

    .sidebar h3 {
      color: var(--primary-color);
      margin-bottom: 1.2rem;
      padding-bottom: 0.5rem;
      border-bottom: 2px solid #eee;
    }

    .sidebar ul {
      list-style: none;
    }

    .sidebar ul li {
      margin-bottom: 0.5rem;
    }

    .sidebar ul li a {
      color: var(--dark-color);
      text-decoration: none;
      display: block;
      padding: 0.5rem 0.8rem;
      border-radius: 4px;
      transition: all 0.3s;
      font-size: 0.95rem;
    }

    .sidebar ul li a:hover,
    .sidebar ul li a.active {
      background-color: #e9f7f7;
      color: var(--primary-color);
      padding-left: 1.2rem;
    }

    .sidebar ul li a i {
      margin-right: 8px;
      width: 20px;
      text-align: center;
    }

    /* Sub-menu */
    .sub-menu {
      margin-left: 1.5rem;
      border-left: 2px solid #eee;
      padding-left: 0.5rem;
      margin-top: 0.3rem;
      margin-bottom: 0.8rem;
    }

    .sub-menu li {
      margin-bottom: 0.3rem !important;
    }

    .sub-menu a {
      font-size: 0.9rem !important;
      padding: 0.3rem 0.8rem !important;
    }

    /* Content */
    .content {
      flex: 1;
      background-color: white;
      border-radius: 8px;
      padding: 2rem;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }

    .content h2 {
      color: var(--primary-color);
      margin-bottom: 1.5rem;
      padding-bottom: 0.8rem;
      border-bottom: 2px solid #eee;
    }

    .content h3 {
      color: var(--secondary-color);
      margin: 2rem 0 1rem;
      padding-top: 1rem;
    }

    .content h4 {
      color: var(--primary-color);
      margin: 1.5rem 0 0.8rem;
    }

    .content p {
      margin-bottom: 1.2rem;
    }

    .content ul,
    .content ol {
      margin-left: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .content li {
      margin-bottom: 0.5rem;
    }

    /* Code examples */
    .code-example {
      background-color: var(--code-bg);
      border-left: 4px solid var(--primary-color);
      padding: 1.5rem;
      margin: 1.5rem 0;
      border-radius: 0 8px 8px 0;
      overflow-x: auto;
    }

    .code-example h4 {
      color: var(--secondary-color);
      margin-bottom: 0.8rem;
      font-size: 1.1rem;
    }

    pre {
      font-family: 'Courier New', Courier, monospace;
      font-size: 0.95rem;
      line-height: 1.5;
      white-space: pre-wrap;
      tab-size: 2;
    }

    .code-comment {
      color: #6a9955;
    }

    .code-keyword {
      color: #569cd6;
      font-weight: bold;
    }

    .code-function {
      color: #ff0000;
    }

    .code-value {
      color: #ce9178;
    }

    .code-type {
      color: #4ec9b0;
    }

    .code-string {
      color: #ce9178;
    }

    .code-number {
      color: #b5cea8;
    }

    .code-define {
      color: #c586c0;
    }

    /* Cards */
    .cards {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 1.5rem;
      margin: 2rem 0;
    }

    .card {
      background-color: white;
      border-radius: 8px;
      padding: 1.5rem;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      transition: transform 0.3s, box-shadow 0.3s;
      border-top: 4px solid var(--primary-color);
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
    }

    .card i {
      font-size: 2.5rem;
      color: var(--primary-color);
      margin-bottom: 1rem;
    }

    .card h3 {
      color: var(--primary-color);
      margin-bottom: 0.8rem;
    }

    /* Tables */
    .table-container {
      overflow-x: auto;
      margin: 1.5rem 0;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
    }

    th {
      background-color: var(--primary-color);
      color: white;
      padding: 0.8rem;
      text-align: left;
    }

    td {
      padding: 0.8rem;
      border-bottom: 1px solid #eee;
    }

    tr:nth-child(even) {
      background-color: #f9f9f9;
    }

    tr:hover {
      background-color: #e9f7f7;
    }

    /* Info boxes */
    .info-box {
      background-color: #e9f7f7;
      border-left: 4px solid var(--primary-color);
      padding: 1.2rem;
      margin: 1.5rem 0;
      border-radius: 0 8px 8px 0;
    }

    .warning-box {
      background-color: #fff3cd;
      border-left: 4px solid #ffc107;
      padding: 1.2rem;
      margin: 1.5rem 0;
      border-radius: 0 8px 8px 0;
    }

    .success-box {
      background-color: #d4edda;
      border-left: 4px solid var(--success-color);
      padding: 1.2rem;
      margin: 1.5rem 0;
      border-radius: 0 8px 8px 0;
    }

    /* Footer */
    footer {
      background-color: var(--dark-color);
      color: white;
      padding: 3rem 0 1.5rem;
    }

    .footer-content {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      margin-bottom: 2rem;
    }

    .footer-section {
      flex: 1;
      min-width: 250px;
      margin-bottom: 1.5rem;
    }

    .footer-section h3 {
      color: var(--accent-color);
      margin-bottom: 1.2rem;
      font-size: 1.3rem;
    }

    .footer-section ul {
      list-style: none;
    }

    .footer-section ul li {
      margin-bottom: 0.6rem;
    }

    .footer-section ul li a {
      color: #ddd;
      text-decoration: none;
      transition: color 0.3s;
    }

    .footer-section ul li a:hover {
      color: var(--accent-color);
    }

    .copyright {
      text-align: center;
      padding-top: 1.5rem;
      border-top: 1px solid #444;
      color: #aaa;
      font-size: 0.9rem;
    }

    /* Responsive */
    @media (max-width: 992px) {
      .sidebar {
        flex: 0 0 250px;
      }
    }

    @media (max-width: 768px) {
      .header-content {
        flex-direction: column;
        text-align: center;
      }

      nav ul {
        margin-top: 1rem;
        justify-content: center;
        flex-wrap: wrap;
      }

      nav ul li {
        margin: 0.3rem 0.5rem;
      }

      .main-content {
        flex-direction: column;
      }

      .sidebar {
        flex: none;
        width: 100%;
        position: static;
        max-height: none;
      }

      .hero h1 {
        font-size: 2.2rem;
      }
    }

    /* Tabs */
    .tabs {
      display: flex;
      border-bottom: 1px solid #ddd;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
    }

    .tab {
      padding: 0.8rem 1.5rem;
      background-color: #f1f1f1;
      border: none;
      cursor: pointer;
      font-weight: 500;
      color: var(--gray-color);
      transition: all 0.3s;
      border-top-left-radius: 8px;
      border-top-right-radius: 8px;
    }

    .tab:hover {
      background-color: #e9e9e9;
    }

    .tab.active {
      background-color: white;
      color: var(--primary-color);
      border-bottom: 3px solid var(--primary-color);
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    /* Breadcrumb */
    .breadcrumb {
      background-color: #e9f7f7;
      padding: 0.8rem 1.5rem;
      border-radius: 8px;
      margin-bottom: 1.5rem;
      font-size: 0.9rem;
    }

    .breadcrumb a {
      color: var(--primary-color);
      text-decoration: none;
    }

    .breadcrumb span {
      color: var(--gray-color);
    }

    .breadcrumb i {
      margin: 0 8px;
      color: var(--gray-color);
    }

    /* Exercise section */
    .exercise {
      background-color: #f8f9fa;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 1.5rem;
      margin: 2rem 0;
    }

    .exercise h4 {
      color: var(--primary-color);
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
    }

    .exercise h4 i {
      margin-right: 10px;
    }

    /* Next/Prev buttons */
    .nav-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 3rem;
      padding-top: 2rem;
      border-top: 1px solid #eee;
    }

    .nav-button {
      padding: 0.8rem 1.5rem;
      background-color: var(--primary-color);
      color: white;
      text-decoration: none;
      border-radius: 4px;
      display: flex;
      align-items: center;
      transition: background-color 0.3s;
    }

    .nav-button:hover {
      background-color: var(--secondary-color);
      color: white;
    }

    .nav-button.prev i {
      margin-right: 8px;
    }

    .nav-button.next i {
      margin-left: 8px;
    }

    /* Project gallery */
    .project-gallery {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
      margin: 2rem 0;
    }

    .project-card {
      border: 1px solid #ddd;
      border-radius: 8px;
      overflow: hidden;
      transition: transform 0.3s, box-shadow 0.3s;
    }

    .project-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }

    .project-image {
      height: 180px;
      background-color: #e9f7f7;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--primary-color);
      font-size: 3rem;
    }

    .project-content {
      padding: 1.5rem;
    }

    .project-content h4 {
      color: var(--primary-color);
      margin-bottom: 0.8rem;
    }

    .difficulty {
      display: inline-block;
      padding: 0.3rem 0.8rem;
      border-radius: 50px;
      font-size: 0.8rem;
      font-weight: 600;
      margin-bottom: 0.8rem;
    }

    .difficulty.beginner {
      background-color: #d4edda;
      color: #155724;
    }

    .difficulty.intermediate {
      background-color: #fff3cd;
      color: #856404;
    }

    .difficulty.advanced {
      background-color: #f8d7da;
      color: #721c24;
    }
    .active{
      color:#ffbf00 ;
    }
  </style>
</head>

<body>
  <!-- Header -->
  <header>
    <div class="container header-content">
      <div class="logo">
        <i class="fas fa-microchip"></i>
        <div><span></span> Arduino/ESP </div>
      </div>
      <nav>
        <ul>
          <li><a href="index.html" class="active"><i class="fas fa-home"></i> Accueil</a></li>
          <li><a href="#tutoriels"><i class="fas fa-graduation-cap"></i> Tutoriels</a></li>
          <li><a href="./exemple.html"><i class="fas fa-code"></i> Exemples</a></li>
          <li><a href="#references"><i class="fas fa-book"></i> Référence</a></li>
          <li><a href="./exercice.html"><i class="fas fa-pencil-alt"></i> Exercices</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- Hero Section -->
  <section class="hero">
    <div class="container">
      <h1>ArduinoLearn - Tutoriels Complets</h1>
      <p>Apprenez la programmation Arduino et ESP de A à Z avec des exemples pratiques et des projets concrets</p>
      <a href="#structure" class="cta-button">Commencer l'apprentissage <i class="fas fa-arrow-right"></i></a>
    </div>
  </section>

  <!-- Main Content -->
  <div class="container main-content">
    <!-- Sidebar avec navigation complète -->
    <aside class="sidebar">
      <h3><i class="fas fa-list"></i> Navigation</h3>
      <ul>
        <li><a href="#introduction"><i class="fas fa-play"></i> Introduction</a></li>
        <li><a href="#premier-programme"><i class="fas fa-code"></i> Premier programme</a></li>

        <li><a href="#structure" class="active"><i class="fas fa-sitemap"></i> Structure avancée</a></li>

        <li>
          <a href="#variables"><i class="fas fa-memory"></i> Variables et types</a>
          <ul class="sub-menu">
            <li><a href="#types-donnees">Types de données</a></li>
            <li><a href="#declaration">Déclaration</a></li>
            <li><a href="#portee">Portée des variables</a></li>
            <li><a href="#constantes">Constantes</a></li>
            <li><a href="#tableaux">Tableaux</a></li>
            <li><a href="#structures">Structures</a></li>
          </ul>
        </li>

        <li>
          <a href="#fonctions"><i class="fas fa-cogs"></i> Fonctions de base</a>
          <ul class="sub-menu">
            <li><a href="#fonctions-arduino">Fonctions Arduino</a></li>
            <li><a href="#fonctions-personnalisees">Fonctions personnalisées</a></li>
            <li><a href="#parametres-retour">Paramètres et retour</a></li>
            <li><a href="#recursivite">Récursivité</a></li>
          </ul>
        </li>

        <li>
          <a href="#entrees-sorties"><i class="fas fa-exchange-alt"></i> Entrées/Sorties</a>
          <ul class="sub-menu">
            <li><a href="#digital">Digital I/O</a></li>
            <li><a href="#analog">Analog I/O</a></li>
            <li><a href="#pwm">PWM</a></li>
            <li><a href="#interruptions">Interruptions</a></li>
          </ul>
        </li>

        <li>
          <a href="#allumer-led"><i class="fas fa-lightbulb"></i> Allumer une LED</a>
          <ul class="sub-menu">
            <li><a href="#led-simple">LED simple</a></li>
            <li><a href="#led-clignotante">LED clignotante</a></li>
            <li><a href="#led-pwm">LED PWM</a></li>
            <li><a href="#led-rvb">LED RVB</a></li>
          </ul>
        </li>

        <li>
          <a href="#bibliotheques"><i class="fas fa-book"></i> Bibliothèques (.h)</a>
          <ul class="sub-menu">
            <li><a href="#utilisation-biblio">Utilisation</a></li>
            <li><a href="#creation-biblio">Création</a></li>
            <li><a href="#biblio-standard">Bibliothèques standard</a></li>
          </ul>
        </li>

        <li>
          <a href="#structures-controle"><i class="fas fa-project-diagram"></i> Structures de contrôle</a>
          <ul class="sub-menu">
            <li><a href="#conditions">Conditions</a></li>
            <li><a href="#boucles">Boucles</a></li>
            <li><a href="#switch-case">Switch Case</a></li>
          </ul>
        </li>

        <li>
          <a href="#communication"><i class="fas fa-wifi"></i> Communication ESP</a>
          <ul class="sub-menu">
            <li><a href="#wifi">WiFi</a></li>
            <li><a href="#bluetooth">Bluetooth</a></li>
            <li><a href="#mqtt">MQTT</a></li>
            <li><a href="#web-server">Serveur Web</a></li>
          </ul>
        </li>

        <li>
          <a href="#projets"><i class="fas fa-rocket"></i> Projets pratiques</a>
          <ul class="sub-menu">
            <li><a href="#projet1">Station météo</a></li>
            <li><a href="#projet2">Contrôle domotique</a></li>
            <li><a href="#projet3">Robot suiveur</a></li>
            <li><a href="#projet4">Système d'arrosage</a></li>
          </ul>
        </li>
      </ul>
    </aside>

    <!-- Content -->
    <main class="content">
      <!-- Breadcrumb -->
      <div class="breadcrumb">
        <a href="index.html">Accueil</a> <i class="fas fa-chevron-right"></i>
        <a href="#tutoriels">Tutoriels</a> <i class="fas fa-chevron-right"></i>
        <span>Structure avancée</span>
      </div>

      <!-- Introduction -->
      <section id="introduction">
        <h2>Introduction à Arduino et ESP</h2>
        <p>Arduino est une plateforme de prototypage électronique open-source basée sur du matériel et des logiciels
          faciles à utiliser. Les modules ESP (ESP32, ESP8266) ajoutent des capacités WiFi et Bluetooth aux projets
          Arduino.</p>

        <h3>Pourquoi apprendre Arduino et ESP ?</h3>
        <ul>
          <li><strong>Accessible aux débutants</strong> : Pas besoin d'être expert en électronique</li>
          <li><strong>Large communauté</strong> : Des milliers de tutoriels et projets</li>
          <li><strong>Polyvalent</strong> : Domotique, robotique, IoT, etc.</li>
          <li><strong>Économique</strong> : Matériel abordable et logiciels gratuits</li>
          <li><strong>Connectivité</strong> (ESP) : WiFi, Bluetooth, communication Internet</li>
        </ul>

        <h3>Matériel nécessaire pour commencer</h3>
        <div class="cards">
          <div class="card">
            <i class="fas fa-microchip"></i>
            <h4>Carte Arduino</h4>
            <p>Uno, Nano, Mega selon vos besoins</p>
          </div>
          <div class="card">
            <i class="fas fa-wifi"></i>
            <h4>Module ESP</h4>
            <p>ESP32 ou ESP8266 pour la connectivité</p>
          </div>
          <div class="card">
            <i class="fas fa-usb"></i>
            <h4>Câble USB</h4>
            <p>Pour programmer et alimenter la carte</p>
          </div>
          <div class="card">
            <i class="fas fa-lightbulb"></i>
            <h4>Composants</h4>
            <p>LEDs, résistances, boutons, capteurs</p>
          </div>
        </div>

        <div class="info-box">
          <p><strong>Conseil :</strong> Commencez avec un kit Arduino débutant qui contient tous les composants
            essentiels pour apprendre.</p>
        </div>
      </section>
      <!-- Installation IDE -->
      <section id="installation">
        <h2>Installation de l'IDE Arduino</h2>
        <p>L'IDE (Integrated Development Environment) Arduino est le logiciel utilisé pour programmer les cartes Arduino
          et ESP.</p>

        <h3>Étapes d'installation</h3>
        <ol>
          <li><strong>Téléchargement</strong> : Rendez-vous sur <a href="https://www.arduino.cc"
              target="_blank">arduino.cc</a> et téléchargez la version correspondant à votre système d'exploitation</li>
          <li><strong>Installation</strong> : Exécutez le fichier d'installation et suivez les instructions</li>
          <li><strong>Drivers</strong> : L'installation inclut généralement les drivers USB nécessaires</li>
          <li><strong>Configuration ESP</strong> : Pour ESP32/ESP8266, ajoutez les URLs des cartes dans Fichier →
            Préférences</li>
        </ol>

        <h3>Configuration pour ESP</h3>
        <div class="code-example">
          <h4>URLs à ajouter pour ESP</h4>
          <pre><code><span class="code-comment">// Pour ESP32 :</span>
https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json

<span class="code-comment">// Pour ESP8266 :</span>
http://arduino.esp8266.com/stable/package_esp8266com_index.json</code></pre>
        </div>

        <div class="info-box">
          <p><strong>Astuce :</strong> Après avoir ajouté les URLs, allez dans Outils → Type de carte → Gestionnaire de
            cartes pour installer les plateformes ESP.</p>
        </div>
      </section>
      <!-- Premier programme -->
      <section id="premier-programme">
        <h2>Votre premier programme Arduino</h2>
        <p>Le programme "Blink" (clignotement) est traditionnellement le premier programme qu'on écrit en Arduino. Il
          fait clignoter la LED intégrée à la carte.</p>

        <h3>Structure de base</h3>
        <div class="code-example">
          <h4>Structure minimale d'un sketch Arduino</h4>
          <pre><code><span class="code-comment">// La fonction setup() s'exécute une fois au démarrage</span>
<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  <span class="code-comment">// Code d'initialisation ici</span>
}

<span class="code-comment">// La fonction loop() s'exécute en boucle indéfiniment</span>
<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
  <span class="code-comment">// Code principal ici</span>
}</code></pre>
        </div>

        <h3>Premier exemple : LED clignotante</h3>
        <div class="code-example">
          <h4>Programme Blink complet</h4>
          <pre><code><span class="code-comment">/*
  Premier programme Arduino - Blink
  Fait clignoter la LED intégrée (broche 13)
*/</span>

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  <span class="code-comment">// Initialise la broche 13 comme sortie</span>
  <span class="code-function">pinMode</span>(LED_BUILTIN, OUTPUT);
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
  <span class="code-comment">// Allume la LED</span>
  <span class="code-function">digitalWrite</span>(LED_BUILTIN, HIGH);
  <span class="code-function">delay</span>(1000);  <span class="code-comment">// Attend 1 seconde</span>
  
  <span class="code-comment">// Éteint la LED</span>
  <span class="code-function">digitalWrite</span>(LED_BUILTIN, LOW);
  <span class="code-function">delay</span>(1000);  <span class="code-comment">// Attend 1 seconde</span>
}</code></pre>
        </div>

        <h3>Explications détaillées</h3>
        <ol>
          <li><code>pinMode(LED_BUILTIN, OUTPUT)</code> : Configure la broche de la LED comme sortie</li>
          <li><code>digitalWrite(LED_BUILTIN, HIGH)</code> : Applique 5V pour allumer la LED</li>
          <li><code>delay(1000)</code> : Met le programme en pause pendant 1000ms (1 seconde)</li>
          <li><code>digitalWrite(LED_BUILTIN, LOW)</code> : Coupe le courant pour éteindre la LED</li>
          <li>La fonction <code>loop()</code> répète ces instructions indéfiniment</li>
        </ol>

        <div class="warning-box">
          <p><strong>Important :</strong> Les fonctions <code>setup()</code> et <code>loop()</code> sont obligatoires
            dans tout programme Arduino, même si elles sont vides.</p>
        </div>

        <h3>Installation de l'IDE Arduino</h3>
        <div class="cards">
          <div class="card">
            <i class="fas fa-download"></i>
            <h4>Étape 1 : Téléchargement</h4>
            <p>Téléchargez l'IDE Arduino sur <a href="https://www.arduino.cc" target="_blank">arduino.cc</a></p>
          </div>
          <div class="card">
            <i class="fas fa-plug"></i>
            <h4>Étape 2 : Installation</h4>
            <p>Installez l'IDE et les drivers USB nécessaires</p>
          </div>
          <div class="card">
            <i class="fas fa-cog"></i>
            <h4>Étape 3 : Configuration</h4>
            <p>Sélectionnez votre carte dans Outils → Type de carte</p>
          </div>
          <div class="card">
            <i class="fas fa-upload"></i>
            <h4>Étape 4 : Upload</h4>
            <p>Compilez et transférez votre programme sur la carte</p>
          </div>
        </div>
      </section>

      <!-- Navigation buttons pour ces sections -->
      <div class="nav-buttons">
        <a href="#installation" class="nav-button prev"><i class="fas fa-arrow-left"></i> Installation IDE</a>
        <a href="#structure" class="nav-button next">Structure avancée <i class="fas fa-arrow-right"></i></a>
      </div>

      <!-- =========================================== -->
      <!-- SECTION STRUCTURE AVANCÉE -->
      <!-- =========================================== -->
      <section id="structure">
        <h2>Structure avancée d'un programme Arduino</h2>
        <p>Un programme Arduino bien structuré est plus lisible, maintenable et réutilisable. Voyons les éléments
          avancés de structure.</p>

        <h3>Organisation d'un programme complet</h3>
        <div class="code-example">
          <h4>Structure complète d'un programme Arduino</h4>
          <pre><code><span class="code-comment">/* 
  Nom du programme : Contrôle de LED avec capteur
  Auteur : Votre Nom
  Date : 2023
  Description : Programme qui contrôle une LED en fonction d'un capteur
*/</span>

<span class="code-comment">// ===========================================
// SECTION 1 : INCLUSIONS DE BIBLIOTHÈQUES
// ===========================================</span>
<span class="code-keyword">#include</span> &lt;Wire.h&gt;      <span class="code-comment">// Pour la communication I2C</span>
<span class="code-keyword">#include</span> &lt;SPI.h&gt;       <span class="code-comment">// Pour la communication SPI</span>

<span class="code-comment">// ===========================================
// SECTION 2 : DÉFINITIONS ET CONSTANTES
// ===========================================</span>
<span class="code-keyword">#define</span> LED_PIN 13      <span class="code-comment">// Broche de la LED</span>
<span class="code-keyword">#define</span> SENSOR_PIN A0   <span class="code-comment">// Broche du capteur analogique</span>
<span class="code-keyword">#define</span> SEUIL 500       <span class="code-comment">// Seuil d'activation</span>

<span class="code-keyword">const</span> <span class="code-keyword">int</span> DELAI_ATTENTE = 100;  <span class="code-comment">// Délai en ms</span>
<span class="code-keyword">const</span> <span class="code-keyword">float</span> VERSION = 1.2;      <span class="code-comment">// Version du programme</span>

<span class="code-comment">// ===========================================
// SECTION 3 : DÉCLARATION DE VARIABLES GLOBALES
// ===========================================</span>
<span class="code-keyword">int</span> valeurCapteur = 0;      <span class="code-comment">// Valeur lue du capteur</span>
<span class="code-keyword">bool</span> ledAllumee = <span class="code-keyword">false</span>;      <span class="code-comment">// État de la LED</span>
<span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> dernierTemps = 0;  <span class="code-comment">// Pour le timing</span>

<span class="code-comment">// ===========================================
// SECTION 4 : DÉCLARATION DE FONCTIONS
// ===========================================</span>
<span class="code-keyword">void</span> lireCapteur();
<span class="code-keyword">void</span> controlerLED(<span class="code-keyword">int</span> valeur);
<span class="code-keyword">void</span> afficherInfos();

<span class="code-comment">// ===========================================
// SECTION 5 : FONCTION SETUP (INITIALISATION)
// ===========================================</span>
<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  <span class="code-comment">// Initialisation de la communication série</span>
  Serial.<span class="code-function">begin</span>(9600);
  
  <span class="code-comment">// Configuration des broches</span>
  <span class="code-function">pinMode</span>(LED_PIN, OUTPUT);
  <span class="code-function">pinMode</span>(SENSOR_PIN, INPUT);
  
  <span class="code-comment">// Message de démarrage</span>
  Serial.<span class="code-function">println</span>(<span class="code-string">"=== Programme de controle LED ==="</span>);
  Serial.<span class="code-function">print</span>(<span class="code-string">"Version: "</span>);
  Serial.<span class="code-function">println</span>(VERSION);
}

<span class="code-comment">// ===========================================
// SECTION 6 : FONCTION LOOP (BOUCLE PRINCIPALE)
// ===========================================</span>
<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
  <span class="code-comment">// Lecture du capteur</span>
  lireCapteur();
  
  <span class="code-comment">// Contrôle de la LED</span>
  controlerLED(valeurCapteur);
  
  <span class="code-comment">// Affichage périodique des informations</span>
  <span class="code-keyword">if</span> (<span class="code-function">millis</span>() - dernierTemps > 5000) {
    afficherInfos();
    dernierTemps = <span class="code-function">millis</span>();
  }
  
  <span class="code-function">delay</span>(DELAI_ATTENTE);
}

<span class="code-comment">// ===========================================
// SECTION 7 : DÉFINITION DES FONCTIONS
// ===========================================</span>

<span class="code-comment">// Fonction pour lire la valeur du capteur</span>
<span class="code-keyword">void</span> <span class="code-function">lireCapteur</span>() {
  valeurCapteur = <span class="code-function">analogRead</span>(SENSOR_PIN);
}

<span class="code-comment">// Fonction pour contrôler la LED</span>
<span class="code-keyword">void</span> <span class="code-function">controlerLED</span>(<span class="code-keyword">int</span> valeur) {
  <span class="code-keyword">if</span> (valeur > SEUIL) {
    <span class="code-function">digitalWrite</span>(LED_PIN, HIGH);
    ledAllumee = <span class="code-keyword">true</span>;
  } <span class="code-keyword">else</span> {
    <span class="code-function">digitalWrite</span>(LED_PIN, LOW);
    ledAllumee = <span class="code-keyword">false</span>;
  }
}

<span class="code-comment">// Fonction pour afficher les informations</span>
<span class="code-keyword">void</span> <span class="code-function">afficherInfos</span>() {
  Serial.<span class="code-function">print</span>(<span class="code-string">"Valeur capteur: "</span>);
  Serial.<span class="code-function">println</span>(valeurCapteur);
  Serial.<span class="code-function">print</span>(<span class="code-string">"LED: "</span>);
  Serial.<span class="code-function">println</span>(ledAllumee ? <span class="code-string">"ALLUMEE"</span> : <span class="code-string">"ETEINTE"</span>);
  Serial.<span class="code-function">println</span>(<span class="code-string">"-------------------"</span>);
}</code></pre>
        </div>

        <div class="info-box">
          <p><strong>Conseil :</strong> Cette structure modulaire facilite la maintenance et le débogage. Chaque section
            a un rôle spécifique et les fonctions sont courtes et ciblées.</p>
        </div>
      </section>

      <!-- =========================================== -->
      <!-- SECTION VARIABLES ET TYPES -->
      <!-- =========================================== -->
      <section id="variables">
        <h2>Variables et types de données en C++/Arduino</h2>
        <p>Les variables sont des emplacements mémoire pour stocker des données. Leur type détermine la taille de la
          mémoire et les opérations possibles.</p>

        <h3 id="types-donnees">Types de données fondamentaux</h3>
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>Type</th>
                <th>Taille (bits)</th>
                <th>Plage de valeurs</th>
                <th>Description</th>
                <th>Exemple</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>boolean</code></td>
                <td>8</td>
                <td>0 (false) ou 1 (true)</td>
                <td>Valeur booléenne</td>
                <td><code>boolean ledOn = true;</code></td>
              </tr>
              <tr>
                <td><code>char</code></td>
                <td>8</td>
                <td>-128 à 127</td>
                <td>Caractère ASCII</td>
                <td><code>char lettre = 'A';</code></td>
              </tr>
              <tr>
                <td><code>byte</code></td>
                <td>8</td>
                <td>0 à 255</td>
                <td>Nombre non signé</td>
                <td><code>byte valeur = 200;</code></td>
              </tr>
              <tr>
                <td><code>int</code></td>
                <td>16</td>
                <td>-32,768 à 32,767</td>
                <td>Entier signé</td>
                <td><code>int temperature = -5;</code></td>
              </tr>
              <tr>
                <td><code>unsigned int</code></td>
                <td>16</td>
                <td>0 à 65,535</td>
                <td>Entier non signé</td>
                <td><code>unsigned int distance = 5000;</code></td>
              </tr>
              <tr>
                <td><code>long</code></td>
                <td>32</td>
                <td>-2,147,483,648 à 2,147,483,647</td>
                <td>Entier long signé</td>
                <td><code>long population = 7000000L;</code></td>
              </tr>
              <tr>
                <td><code>unsigned long</code></td>
                <td>32</td>
                <td>0 à 4,294,967,295</td>
                <td>Entier long non signé</td>
                <td><code>unsigned long temps = 4294967295UL;</code></td>
              </tr>
              <tr>
                <td><code>float</code></td>
                <td>32</td>
                <td>-3.4×10³⁸ à 3.4×10³⁸</td>
                <td>Nombre à virgule flottante</td>
                <td><code>float pi = 3.14159;</code></td>
              </tr>
              <tr>
                <td><code>double</code></td>
                <td>32*</td>
                <td>-3.4×10³⁸ à 3.4×10³⁸</td>
                <td>Double précision*</td>
                <td><code>double precis = 3.1415926535;</code></td>
              </tr>
              <tr>
                <td><code>String</code></td>
                <td>Variable</td>
                <td>Chaîne de caractères</td>
                <td>Objet chaîne de caractères</td>
                <td><code>String message = "Hello";</code></td>
              </tr>
            </tbody>
          </table>
          <p class="code-comment" style="margin-top: 0.5rem;">* Sur Arduino, double a la même taille que float (32 bits)
          </p>
        </div>

        <h3 id="declaration">Déclaration et initialisation des variables</h3>
        <div class="code-example">
          <h4>Exemples complets de déclaration</h4>
          <pre><code><span class="code-comment">// Déclaration simple</span>
<span class="code-keyword">int</span> age;
<span class="code-keyword">float</span> temperature;
<span class="code-type">String</span> nom;

<span class="code-comment">// Déclaration avec initialisation</span>
<span class="code-keyword">int</span> compteur = 0;
<span class="code-keyword">float</span> prix = 19.99;
<span class="code-type">String</span> message = <span class="code-string">"Bienvenue"</span>;
<span class="code-keyword">bool</span> estActif = <span class="code-keyword">true</span>;

<span class="code-comment">// Déclaration multiple</span>
<span class="code-keyword">int</span> x = 0, y = 0, z = 0;
<span class="code-keyword">float</span> tempMin = -10.5, tempMax = 40.0;

<span class="code-comment">// Constantes (ne peuvent pas être modifiées)</span>
<span class="code-keyword">const</span> <span class="code-keyword">int</span> LED_PIN = 13;
<span class="code-keyword">const</span> <span class="code-keyword">float</span> PI = 3.14159;
<span class="code-keyword">const</span> <span class="code-type">String</span> NOM_PROGRAMME = <span class="code-string">"Controle LED"</span>;

<span class="code-comment">// Définition avec #define (préprocesseur)</span>
<span class="code-keyword">#define</span> DELAI_MAX 1000
<span class="code-keyword">#define</span> MESSAGE_ERREUR <span class="code-string">"Erreur de connexion"</span></code></pre>
        </div>

        <h3 id="portee">Portée des variables</h3>
        <div class="code-example">
          <pre><code><span class="code-comment">// Variable globale - accessible partout</span>
<span class="code-keyword">int</span> compteurGlobal = 0;

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  <span class="code-comment">// Variable locale à setup() - accessible seulement dans setup</span>
  <span class="code-keyword">int</span> compteurSetup = 10;
  compteurGlobal = 5;  <span class="code-comment">// OK - variable globale</span>
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
  <span class="code-comment">// Variable locale à loop() - accessible seulement dans loop</span>
  <span class="code-keyword">int</span> compteurLoop = 20;
  
  <span class="code-comment">// compteurSetup = 15; // ERREUR! Variable non accessible</span>
  compteurGlobal = 30;  <span class="code-comment">// OK - variable globale</span>
  
  <span class="code-comment">// Variable statique - conserve sa valeur entre les appels</span>
  <span class="code-keyword">static</span> <span class="code-keyword">int</span> compteurStatique = 0;
  compteurStatique++;
  
  <span class="code-comment">// Variable avec mot-clé volatile (pour les interruptions)</span>
  <span class="code-keyword">volatile</span> <span class="code-keyword">int</span> compteurInterruption = 0;
}

<span class="code-comment">// Variable accessible seulement dans ce fichier</span>
<span class="code-keyword">static</span> <span class="code-keyword">int</span> variableFichier = 100;</code></pre>
        </div>

        <h3 id="tableaux">Tableaux (Arrays)</h3>
        <div class="code-example">
          <pre><code><span class="code-comment">// Déclaration de tableaux</span>
<span class="code-keyword">int</span> temperatures[7];              <span class="code-comment">// Tableau de 7 entiers</span>
<span class="code-keyword">float</span> mesures[10] = {0};          <span class="code-comment">// Initialisé à 0</span>
<span class="code-keyword">char</span> message[] = <span class="code-string">"Hello"</span>;        <span class="code-comment">// Tableau de caractères</span>

<span class="code-comment">// Initialisation explicite</span>
<span class="code-keyword">int</span> pinsLED[] = {2, 4, 7, 8, 12, 13};
<span class="code-keyword">float</span> coefficients[3] = {1.2, 3.4, 5.6};
<span class="code-type">String</span> jours[7] = {<span class="code-string">"Lun"</span>, <span class="code-string">"Mar"</span>, <span class="code-string">"Mer"</span>, <span class="code-string">"Jeu"</span>, <span class="code-string">"Ven"</span>, <span class="code-string">"Sam"</span>, <span class="code-string">"Dim"</span>};

<span class="code-comment">// Tableaux multidimensionnels</span>
<span class="code-keyword">int</span> matrice[3][3] = {
  {1, 2, 3},
  {4, 5, 6},
  {7, 8, 9}
};

<span class="code-comment">// Utilisation des tableaux</span>
<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  Serial.<span class="code-function">begin</span>(9600);
  
  <span class="code-comment">// Accès aux éléments</span>
  temperatures[0] = 20;
  temperatures[1] = 22;
  
  <span class="code-comment">// Parcours d'un tableau</span>
  <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < 6; i++) {
    <span class="code-function">pinMode</span>(pinsLED[i], OUTPUT);
  }
  
  <span class="code-comment">// Taille d'un tableau</span>
  <span class="code-keyword">int</span> taille = <span class="code-function">sizeof</span>(pinsLED) / <span class="code-function">sizeof</span>(pinsLED[0]);
  Serial.<span class="code-function">print</span>(<span class="code-string">"Nombre de LEDs: "</span>);
  Serial.<span class="code-function">println</span>(taille);
}</code></pre>
        </div>

        <!-- Constantes -->
        <section id="constantes">
          <h3>Constantes en Arduino/C++</h3>
          <p>Les constantes sont des valeurs qui ne peuvent pas être modifiées pendant l'exécution du programme.</p>

          <div class="code-example">
            <h4>Différentes façons de définir des constantes</h4>
            <pre><code><span class="code-comment">// 1. Avec le mot-clé const (recommandé)</span>
<span class="code-keyword">const</span> <span class="code-keyword">int</span> LED_PIN = 13;
<span class="code-keyword">const</span> <span class="code-keyword">float</span> PI = 3.14159;
<span class="code-keyword">const</span> <span class="code-type">String</span> NOM_PROGRAMME = <span class="code-string">"Controle LED"</span>;

<span class="code-comment">// 2. Avec #define (préprocesseur)</span>
<span class="code-keyword">#define</span> DELAI_MAX 1000
<span class="code-keyword">#define</span> MESSAGE_ERREUR <span class="code-string">"Erreur de connexion"</span>
<span class="code-keyword">#define</span> SEUIL_TEMPERATURE 30.5

<span class="code-comment">// 3. Constantes prédéfinies d'Arduino</span>
<span class="code-keyword">const</span> <span class="code-keyword">int</span> led = LED_BUILTIN;  <span class="code-comment">// LED intégrée</span>
<span class="code-keyword">const</span> <span class="code-keyword">bool</span> etat = <span class="code-keyword">true</span>;        <span class="code-comment">// true et false sont des constantes</span>
<span class="code-keyword">const</span> <span class="code-keyword">int</span> haut = HIGH;        <span class="code-comment">// HIGH et LOW sont des constantes</span>
<span class="code-keyword">const</span> <span class="code-keyword">int</span> entree = INPUT;     <span class="code-comment">// INPUT, OUTPUT, INPUT_PULLUP</span>

<span class="code-comment">// 4. Enumérations (groupes de constantes)</span>
<span class="code-keyword">enum</span> Etats {
  ATTENTE,
  DEMARRAGE,
  FONCTIONNEMENT,
  ERREUR
};

<span class="code-keyword">enum</span> Couleurs {
  ROUGE = 0xFF0000,
  VERT = 0x00FF00,
  BLEU = 0x0000FF,
  JAUNE = 0xFFFF00
};</code></pre>
          </div>

          <div class="info-box">
            <p><strong>const vs #define :</strong> Utilisez <code>const</code> pour les constantes typées (le
              compilateur vérifie le type). Utilisez <code>#define</code> pour les macros et valeurs simples.</p>
          </div>

          <h4>Exemple d'utilisation des constantes</h4>
          <div class="code-example">
            <pre><code><span class="code-comment">/*
  Programme démontrant l'utilisation des constantes
*/</span>

<span class="code-comment">// Constantes de configuration</span>
<span class="code-keyword">const</span> <span class="code-keyword">int</span> PIN_LED_ROUGE = 9;
<span class="code-keyword">const</span> <span class="code-keyword">int</span> PIN_LED_VERTE = 10;
<span class="code-keyword">const</span> <span class="code-keyword">int</span> PIN_BOUTON = 2;
<span class="code-keyword">const</span> <span class="code-keyword">int</span> DELAI_CLIGNOTEMENT = 500;
<span class="code-keyword">const</span> <span class="code-keyword">float</span> TEMPERATURE_MAX = 85.5;

<span class="code-comment">// Définition avec #define</span>
<span class="code-keyword">#define</span> NOMBRE_CYCLES 10
<span class="code-keyword">#define</span> VERSION <span class="code-string">"1.0.2"</span>

<span class="code-comment">// Énumération pour les états</span>
<span class="code-keyword">enum</span> ModeFonctionnement {
  MODE_NORMAL,
  MODE_RAPIDE,
  MODE_TEST
};

ModeFonctionnement modeActuel = MODE_NORMAL;

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  Serial.<span class="code-function">begin</span>(9600);
  
  <span class="code-comment">// Configuration des broches avec constantes</span>
  <span class="code-function">pinMode</span>(PIN_LED_ROUGE, OUTPUT);
  <span class="code-function">pinMode</span>(PIN_LED_VERTE, OUTPUT);
  <span class="code-function">pinMode</span>(PIN_BOUTON, INPUT_PULLUP);
  
  <span class="code-comment">// Affichage des informations de configuration</span>
  Serial.<span class="code-function">print</span>(<span class="code-string">"Version: "</span>);
  Serial.<span class="code-function">println</span>(VERSION);
  Serial.<span class="code-function">print</span>(<span class="code-string">"Temperature max: "</span>);
  Serial.<span class="code-function">println</span>(TEMPERATURE_MAX);
  Serial.<span class="code-function">print</span>(<span class="code-string">"Delai: "</span>);
  Serial.<span class="code-function">println</span>(DELAI_CLIGNOTEMENT);
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
  <span class="code-comment">// Utilisation des constantes dans le code</span>
  <span class="code-keyword">static</span> <span class="code-keyword">int</span> compteur = 0;
  
  <span class="code-keyword">switch</span> (modeActuel) {
    <span class="code-keyword">case</span> MODE_NORMAL:
      <span class="code-function">clignoterLED</span>(PIN_LED_VERTE, DELAI_CLIGNOTEMENT);
      <span class="code-keyword">break</span>;
      
    <span class="code-keyword">case</span> MODE_RAPIDE:
      <span class="code-function">clignoterLED</span>(PIN_LED_VERTE, DELAI_CLIGNOTEMENT / 2);
      <span class="code-keyword">break</span>;
      
    <span class="code-keyword">case</span> MODE_TEST:
      <span class="code-function">clignoterLED</span>(PIN_LED_ROUGE, 100);
      <span class="code-keyword">break</span>;
  }
  
  compteur++;
  <span class="code-keyword">if</span> (compteur >= NOMBRE_CYCLES) {
    compteur = 0;
    <span class="code-function">changerMode</span>();
  }
  
  <span class="code-comment">// Vérification d'une condition avec constante</span>
  <span class="code-keyword">float</span> temperature = <span class="code-function">lireTemperature</span>();
  <span class="code-keyword">if</span> (temperature > TEMPERATURE_MAX) {
    <span class="code-function">digitalWrite</span>(PIN_LED_ROUGE, HIGH);
    Serial.<span class="code-function">println</span>(<span class="code-string">"ALERTE: Temperature trop elevee!"</span>);
  }
}

<span class="code-keyword">void</span> <span class="code-function">clignoterLED</span>(<span class="code-keyword">int</span> pin, <span class="code-keyword">int</span> delai) {
  <span class="code-function">digitalWrite</span>(pin, HIGH);
  <span class="code-function">delay</span>(delai);
  <span class="code-function">digitalWrite</span>(pin, LOW);
  <span class="code-function">delay</span>(delai);
}

<span class="code-keyword">void</span> <span class="code-function">changerMode</span>() {
  modeActuel = <span class="code-keyword">static_cast</span>&lt;ModeFonctionnement&gt;((modeActuel + 1) % 3);
  Serial.<span class="code-function">print</span>(<span class="code-string">"Mode change: "</span>);
  Serial.<span class="code-function">println</span>(modeActuel);
}

<span class="code-keyword">float</span> <span class="code-function">lireTemperature</span>() {
  <span class="code-comment">// Simulation de lecture de température</span>
  <span class="code-keyword">return</span> <span class="code-function">random</span>(20, 90) + <span class="code-function">random</span>(0, 100) / 100.0;
}</code></pre>
          </div>
        </section>

        <!-- Structures (struct) -->
        <section id="structures">
          <h3>Structures (struct) en C++</h3>
          <p>Les structures permettent de regrouper plusieurs variables de types différents sous un seul nom.</p>

          <div class="code-example">
            <h4>Déclaration et utilisation des structures</h4>
            <pre><code><span class="code-comment">// Déclaration d'une structure</span>
<span class="code-keyword">struct</span> Capteur {
  <span class="code-keyword">int</span> pin;              <span class="code-comment">// Broche du capteur</span>
  <span class="code-keyword">float</span> valeur;         <span class="code-comment">// Valeur lue</span>
  <span class="code-keyword">float</span> valeurMin;      <span class="code-comment">// Valeur minimale</span>
  <span class="code-keyword">float</span> valeurMax;      <span class="code-comment">// Valeur maximale</span>
  <span class="code-type">String</span> nom;          <span class="code-comment">// Nom du capteur</span>
  <span class="code-keyword">bool</span> actif;           <span class="code-comment">// État actif/inactif</span>
};

<span class="code-comment">// Déclaration avec initialisation</span>
<span class="code-keyword">struct</span> Point {
  <span class="code-keyword">int</span> x = 0;
  <span class="code-keyword">int</span> y = 0;
};

<span class="code-comment">// Structure avec méthodes</span>
<span class="code-keyword">struct</span> LED {
  <span class="code-keyword">int</span> pin;
  <span class="code-keyword">bool</span> allumee;
  
  <span class="code-comment">// Constructeur</span>
  LED(<span class="code-keyword">int</span> p) : pin(p), allumee(<span class="code-keyword">false</span>) {
    <span class="code-function">pinMode</span>(pin, OUTPUT);
  }
  
  <span class="code-comment">// Méthodes</span>
  <span class="code-keyword">void</span> <span class="code-function">allumer</span>() {
    <span class="code-function">digitalWrite</span>(pin, HIGH);
    allumee = <span class="code-keyword">true</span>;
  }
  
  <span class="code-keyword">void</span> <span class="code-function">eteindre</span>() {
    <span class="code-function">digitalWrite</span>(pin, LOW);
    allumee = <span class="code-keyword">false</span>;
  }
  
  <span class="code-keyword">void</span> <span class="code-function">toggle</span>() {
    <span class="code-keyword">if</span> (allumee) {
      <span class="code-function">eteindre</span>();
    } <span class="code-keyword">else</span> {
      <span class="code-function">allumer</span>();
    }
  }
};

<span class="code-comment">// Tableau de structures</span>
<span class="code-keyword">struct</span> Etudiant {
  <span class="code-type">String</span> nom;
  <span class="code-keyword">int</span> age;
  <span class="code-keyword">float</span> moyenne;
};

<span class="code-comment">// Structure imbriquée</span>
<span class="code-keyword">struct</span> Adresse {
  <span class="code-type">String</span> rue;
  <span class="code-type">String</span> ville;
  <span class="code-type">String</span> codePostal;
};

<span class="code-keyword">struct</span> Personne {
  <span class="code-type">String</span> nom;
  <span class="code-keyword">int</span> age;
  Adresse adresse;  <span class="code-comment">// Structure imbriquée</span>
};</code></pre>
          </div>

          <h4>Exemple complet avec structures</h4>
          <div class="code-example">
            <pre><code><span class="code-comment">/*
  Programme démontrant l'utilisation des structures
  Gestion de plusieurs capteurs avec structures
*/</span>

<span class="code-comment">// Définition des structures</span>
<span class="code-keyword">struct</span> CapteurTemperature {
  <span class="code-keyword">int</span> pin;
  <span class="code-type">String</span> nom;
  <span class="code-keyword">float</span> temperature;
  <span class="code-keyword">float</span> seuilAlerte;
  <span class="code-keyword">bool</span> alerteActive;
  
  <span class="code-comment">// Méthode pour initialiser le capteur</span>
  <span class="code-keyword">void</span> <span class="code-function">initialiser</span>() {
    temperature = 0.0;
    alerteActive = <span class="code-keyword">false</span>;
    Serial.<span class="code-function">print</span>(<span class="code-string">"Capteur "</span>);
    Serial.<span class="code-function">print</span>(nom);
    Serial.<span class="code-function">print</span>(<span class="code-string">" initialise sur pin "</span>);
    Serial.<span class="code-function">println</span>(pin);
  }
  
  <span class="code-comment">// Méthode pour lire la température (simulée)</span>
  <span class="code-keyword">void</span> <span class="code-function">lireTemperature</span>() {
    <span class="code-comment">// Simulation de lecture</span>
    temperature = 20.0 + <span class="code-function">random</span>(0, 150) / 10.0;
    
    <span class="code-comment">// Vérification d'alerte</span>
    alerteActive = (temperature > seuilAlerte);
  }
  
  <span class="code-comment">// Méthode pour afficher les informations</span>
  <span class="code-keyword">void</span> <span class="code-function">afficher</span>() {
    Serial.<span class="code-function">print</span>(nom);
    Serial.<span class="code-function">print</span>(<span class="code-string">": "</span>);
    Serial.<span class="code-function">print</span>(temperature);
    Serial.<span class="code-function">print</span>(<span class="code-string">"°C"</span>);
    
    <span class="code-keyword">if</span> (alerteActive) {
      Serial.<span class="code-function">println</span>(<span class="code-string">" [ALERTE!]"</span>);
    } <span class="code-keyword">else</span> {
      Serial.<span class="code-function">println</span>();
    }
  }
};

<span class="code-keyword">struct</span> SystemeControle {
  CapteurTemperature capteurs[3];
  <span class="code-keyword">int</span> nombreCapteurs;
  <span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> dernierScan;
  
  <span class="code-comment">// Initialisation du système</span>
  <span class="code-keyword">void</span> <span class="code-function">initialiser</span>() {
    nombreCapteurs = 3;
    
    <span class="code-comment">// Configuration des capteurs</span>
    capteurs[0] = {A0, <span class="code-string">"Salon"</span>, 0.0, 25.0, <span class="code-keyword">false</span>};
    capteurs[1] = {A1, <span class="code-string">"Cuisine"</span>, 0.0, 30.0, <span class="code-keyword">false</span>};
    capteurs[2] = {A2, <span class="code-string">"Chambre"</span>, 0.0, 22.0, <span class="code-keyword">false</span>};
    
    <span class="code-comment">// Initialisation de chaque capteur</span>
    <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < nombreCapteurs; i++) {
      capteurs[i].<span class="code-function">initialiser</span>();
    }
    
    dernierScan = 0;
    Serial.<span class="code-function">println</span>(<span class="code-string">"Systeme de controle initialise"</span>);
  }
  
  <span class="code-comment">// Scanner tous les capteurs</span>
  <span class="code-keyword">void</span> <span class="code-function">scannerCapteurs</span>() {
    <span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> maintenant = <span class="code-function">millis</span>();
    
    <span class="code-keyword">if</span> (maintenant - dernierScan > 2000) { <span class="code-comment">// Toutes les 2 secondes</span>
      dernierScan = maintenant;
      
      Serial.<span class="code-function">println</span>(<span class="code-string">"=== Scan des capteurs ==="</span>);
      
      <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < nombreCapteurs; i++) {
        capteurs[i].<span class="code-function">lireTemperature</span>();
        capteurs[i].<span class="code-function">afficher</span>();
      }
      
      Serial.<span class="code-function">println</span>();
    }
  }
  
  <span class="code-comment">// Vérifier les alertes</span>
  <span class="code-keyword">bool</span> <span class="code-function">verifierAlertes</span>() {
    <span class="code-keyword">bool</span> alerte = <span class="code-keyword">false</span>;
    
    <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < nombreCapteurs; i++) {
      <span class="code-keyword">if</span> (capteurs[i].alerteActive) {
        alerte = <span class="code-keyword">true</span>;
        Serial.<span class="code-function">print</span>(<span class="code-string">"ALERTE: "</span>);
        Serial.<span class="code-function">print</span>(capteurs[i].nom);
        Serial.<span class="code-function">print</span>(<span class="code-string">" temperature trop elevee ("</span>);
        Serial.<span class="code-function">print</span>(capteurs[i].temperature);
        Serial.<span class="code-function">println</span>(<span class="code-string">"°C)"</span>);
      }
    }
    
    <span class="code-keyword">return</span> alerte;
  }
};

<span class="code-comment">// Variables globales</span>
SystemeControle systeme;

<span class="code-keyword">const</span> <span class="code-keyword">int</span> LED_ALERTE = 13;

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  Serial.<span class="code-function">begin</span>(9600);
  <span class="code-function">pinMode</span>(LED_ALERTE, OUTPUT);
  
  <span class="code-comment">// Initialisation avec graine aléatoire</span>
  <span class="code-function">randomSeed</span>(<span class="code-function">analogRead</span>(A5));
  
  <span class="code-comment">// Initialisation du système</span>
  systeme.<span class="code-function">initialiser</span>();
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
  <span class="code-comment">// Scanner les capteurs</span>
  systeme.<span class="code-function">scannerCapteurs</span>();
  
  <span class="code-comment">// Vérifier les alertes</span>
  <span class="code-keyword">bool</span> alerte = systeme.<span class="code-function">verifierAlertes</span>();
  
  <span class="code-comment">// Contrôle de la LED d'alerte</span>
  <span class="code-keyword">if</span> (alerte) {
    <span class="code-function">digitalWrite</span>(LED_ALERTE, HIGH);
  } <span class="code-keyword">else</span> {
    <span class="code-function">digitalWrite</span>(LED_ALERTE, LOW);
  }
  
  <span class="code-function">delay</span>(100);
}</code></pre>
          </div>

          <div class="info-box">
            <p><strong>Note :</strong> En C++, les structures sont très similaires aux classes. La principale différence
              est que par défaut, les membres d'une structure sont publics, tandis que ceux d'une classe sont privés.
            </p>
          </div>
        </section>
      </section>

      <!-- =========================================== -->
      <!-- SECTION FONCTIONS DE BASE -->
      <!-- =========================================== -->
      <section id="fonctions">
        <h2>Fonctions de base Arduino et fonctions personnalisées</h2>
        <p>Les fonctions permettent d'organiser le code en blocs réutilisables. Arduino fournit de nombreuses fonctions
          prédéfinies.</p>

        <h3 id="fonctions-arduino">Fonctions Arduino essentielles</h3>
        <div class="cards">
          <div class="card">
            <i class="fas fa-terminal"></i>
            <h3>Entrées/Sorties Digitales</h3>
            <p><code>pinMode()</code>, <code>digitalWrite()</code>, <code>digitalRead()</code></p>
          </div>
          <div class="card">
            <i class="fas fa-wave-square"></i>
            <h3>Entrées/Sorties Analogiques</h3>
            <p><code>analogRead()</code>, <code>analogWrite()</code>, <code>analogReference()</code></p>
          </div>
          <div class="card">
            <i class="fas fa-clock"></i>
            <h3>Temps et Délais</h3>
            <p><code>delay()</code>, <code>delayMicroseconds()</code>, <code>millis()</code>, <code>micros()</code></p>
          </div>
          <div class="card">
            <i class="fas fa-broadcast-tower"></i>
            <h3>Communication Série</h3>
            <p><code>Serial.begin()</code>, <code>Serial.print()</code>, <code>Serial.read()</code>, etc.</p>
          </div>
        </div>

        <div class="code-example">
          <h4>Exemples d'utilisation des fonctions Arduino</h4>
          <pre><code><span class="code-comment">// Configuration d'une broche</span>
<span class="code-function">pinMode</span>(13, OUTPUT);          <span class="code-comment">// Broche 13 en sortie</span>
<span class="code-function">pinMode</span>(2, INPUT_PULLUP);     <span class="code-comment">// Broche 2 en entrée avec résistance pull-up</span>

<span class="code-comment">// Écriture digitale</span>
<span class="code-function">digitalWrite</span>(13, HIGH);       <span class="code-comment">// Allume la LED</span>
<span class="code-function">digitalWrite</span>(13, LOW);        <span class="code-comment">// Éteint la LED</span>

<span class="code-comment">// Lecture digitale</span>
<span class="code-keyword">int</span> etatBouton = <span class="code-function">digitalRead</span>(2);

<span class="code-comment">// Lecture analogique (0-1023 pour 0-5V)</span>
<span class="code-keyword">int</span> valeurPotentiometre = <span class="code-function">analogRead</span>(A0);

<span class="code-comment">// Écriture PWM (0-255 pour 0%-100%)</span>
<span class="code-function">analogWrite</span>(9, 128);          <span class="code-comment">// 50% de cycle</span>

<span class="code-comment">// Gestion du temps</span>
<span class="code-function">delay</span>(1000);                  <span class="code-comment">// Pause de 1 seconde</span>
<span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> tempsEcoule = <span class="code-function">millis</span>();  <span class="code-comment">// Temps depuis le démarrage</span>

<span class="code-comment">// Mathématiques</span>
<span class="code-keyword">int</span> minimum = <span class="code-function">min</span>(10, 20);     <span class="code-comment">// Retourne 10</span>
<span class="code-keyword">int</span> maximum = <span class="code-function">max</span>(10, 20);     <span class="code-comment">// Retourne 20</span>
<span class="code-keyword">int</span> contrainte = <span class="code-function">constrain</span>(valeur, 0, 100);  <span class="code-comment">// Limite entre 0 et 100</span>
<span class="code-keyword">int</span> mappage = <span class="code-function">map</span>(valeur, 0, 1023, 0, 255);  <span class="code-comment">// Change l'échelle</span></code></pre>
        </div>

        <h3 id="fonctions-personnalisees">Création de fonctions personnalisées</h3>
        <div class="code-example">
          <pre><code><span class="code-comment">// Fonction sans paramètre et sans valeur de retour</span>
<span class="code-keyword">void</span> <span class="code-function">clignoterLED</span>() {
  <span class="code-function">digitalWrite</span>(13, HIGH);
  <span class="code-function">delay</span>(500);
  <span class="code-function">digitalWrite</span>(13, LOW);
  <span class="code-function">delay</span>(500);
}

<span class="code-comment">// Fonction avec paramètres</span>
<span class="code-keyword">void</span> <span class="code-function">clignoterBroche</span>(<span class="code-keyword">int</span> broche, <span class="code-keyword">int</span> duree) {
  <span class="code-function">digitalWrite</span>(broche, HIGH);
  <span class="code-function">delay</span>(duree);
  <span class="code-function">digitalWrite</span>(broche, LOW);
  <span class="code-function">delay</span>(duree);
}

<span class="code-comment">// Fonction avec valeur de retour</span>
<span class="code-keyword">int</span> <span class="code-function">calculerMoyenne</span>(<span class="code-keyword">int</span> a, <span class="code-keyword">int</span> b) {
  <span class="code-keyword">return</span> (a + b) / 2;
}

<span class="code-comment">// Fonction avec paramètre par référence (modifie la variable originale)</span>
<span class="code-keyword">void</span> <span class="code-function">incrementer</span>(<span class="code-keyword">int</span> &valeur) {
  valeur++;
}

<span class="code-comment">// Fonction avec paramètres par défaut</span>
<span class="code-keyword">void</span> <span class="code-function">clignoter</span>(<span class="code-keyword">int</span> broche = 13, <span class="code-keyword">int</span> duree = 1000) {
  <span class="code-function">digitalWrite</span>(broche, HIGH);
  <span class="code-function">delay</span>(duree);
  <span class="code-function">digitalWrite</span>(broche, LOW);
  <span class="code-function">delay</span>(duree);
}

<span class="code-comment">// Fonction surchargée (même nom, paramètres différents)</span>
<span class="code-keyword">void</span> <span class="code-function">afficher</span>(<span class="code-keyword">int</span> nombre) {
  Serial.<span class="code-function">println</span>(nombre);
}

<span class="code-keyword">void</span> <span class="code-function">afficher</span>(<span class="code-type">String</span> texte) {
  Serial.<span class="code-function">println</span>(texte);
}

<span class="code-comment">// Fonction inline (pour les petites fonctions fréquemment appelées)</span>
<span class="code-keyword">inline</span> <span class="code-keyword">int</span> <span class="code-function">carre</span>(<span class="code-keyword">int</span> x) {
  <span class="code-keyword">return</span> x * x;
}

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  Serial.<span class="code-function">begin</span>(9600);
  <span class="code-function">pinMode</span>(13, OUTPUT);
  
  <span class="code-comment">// Utilisation des fonctions</span>
  <span class="code-function">clignoterLED</span>();
  
  <span class="code-function">clignoterBroche</span>(13, 200);
  
  <span class="code-keyword">int</span> moyenne = <span class="code-function">calculerMoyenne</span>(10, 20);
  
  <span class="code-keyword">int</span> compteur = 5;
  <span class="code-function">incrementer</span>(compteur);  <span class="code-comment">// compteur devient 6</span>
  
  <span class="code-function">clignoter</span>();           <span class="code-comment">// Utilise les valeurs par défaut</span>
  <span class="code-function">clignoter</span>(9, 500);     <span class="code-comment">// Spécifie les paramètres</span>
  
  <span class="code-function">afficher</span>(42);          <span class="code-comment">// Appelle afficher(int)</span>
  <span class="code-function">afficher</span>(<span class="code-string">"Hello"</span>);    <span class="code-comment">// Appelle afficher(String)</span>
  
  <span class="code-keyword">int</span> resultat = <span class="code-function">carre</span>(5);  <span class="code-comment">// 25</span>
}</code></pre>
        </div>
        <!-- Paramètres et retour de fonctions -->
        <section id="parametres-retour">
          <h3>Paramètres et valeurs de retour des fonctions</h3>
          <p>Les fonctions peuvent recevoir des paramètres (données d'entrée) et retourner des valeurs (données de
            sortie).</p>

          <h4>Types de paramètres</h4>
          <div class="code-example">
            <pre><code><span class="code-comment">// 1. Paramètres par valeur (copie)</span>
<span class="code-keyword">void</span> <span class="code-function">incrementerParValeur</span>(<span class="code-keyword">int</span> x) {
x = x + 1;  <span class="code-comment">// Ne modifie pas la variable originale</span>
}

<span class="code-comment">// 2. Paramètres par référence (modifie l'original)</span>
<span class="code-keyword">void</span> <span class="code-function">incrementerParReference</span>(<span class="code-keyword">int</span> &x) {
x = x + 1;  <span class="code-comment">// Modifie la variable originale</span>
}

<span class="code-comment">// 3. Paramètres par pointeur</span>
<span class="code-keyword">void</span> <span class="code-function">incrementerParPointeur</span>(<span class="code-keyword">int</span> *x) {
*x = *x + 1;  <span class="code-comment">// Modifie la variable originale via pointeur</span>
}

<span class="code-comment">// 4. Paramètres par tableau</span>
<span class="code-keyword">void</span> <span class="code-function">afficherTableau</span>(<span class="code-keyword">int</span> tableau[], <span class="code-keyword">int</span> taille) {
<span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < taille; i++) {
  Serial.<span class="code-function">println</span>(tableau[i]);
}
}

<span class="code-comment">// 5. Paramètres par structure</span>
<span class="code-keyword">struct</span> Point {
<span class="code-keyword">int</span> x;
<span class="code-keyword">int</span> y;
};

<span class="code-keyword">void</span> <span class="code-function">afficherPoint</span>(Point p) {
Serial.<span class="code-function">print</span>(<span class="code-string">"("</span>);
Serial.<span class="code-function">print</span>(p.x);
Serial.<span class="code-function">print</span>(<span class="code-string">", "</span>);
Serial.<span class="code-function">print</span>(p.y);
Serial.<span class="code-function">println</span>(<span class="code-string">")"</span>);
}

<span class="code-comment">// 6. Paramètres par référence constante (lecture seule)</span>
<span class="code-keyword">void</span> <span class="code-function">afficherPointConst</span>(<span class="code-keyword">const</span> Point &p) {
<span class="code-comment">// p.x = 10;  // ERREUR : p est en lecture seule</span>
Serial.<span class="code-function">print</span>(<span class="code-string">"("</span>);
Serial.<span class="code-function">print</span>(p.x);
Serial.<span class="code-function">print</span>(<span class="code-string">", "</span>);
Serial.<span class="code-function">print</span>(p.y);
Serial.<span class="code-function">println</span>(<span class="code-string">")"</span>);
}</code></pre>
          </div>

          <h4>Valeurs de retour</h4>
          <div class="code-example">
            <pre><code><span class="code-comment">// 1. Fonction sans retour (void)</span>
<span class="code-keyword">void</span> <span class="code-function">afficherMessage</span>() {
Serial.<span class="code-function">println</span>(<span class="code-string">"Bonjour"</span>);
}

<span class="code-comment">// 2. Fonction avec retour simple</span>
<span class="code-keyword">int</span> <span class="code-function">addition</span>(<span class="code-keyword">int</span> a, <span class="code-keyword">int</span> b) {
<span class="code-keyword">return</span> a + b;
}

<span class="code-comment">// 3. Fonction avec retour de booléen</span>
<span class="code-keyword">bool</span> <span class="code-function">estPair</span>(<span class="code-keyword">int</span> nombre) {
<span class="code-keyword">return</span> (nombre % 2 == 0);
}

<span class="code-comment">// 4. Fonction avec retour de float</span>
<span class="code-keyword">float</span> <span class="code-function">calculerMoyenne</span>(<span class="code-keyword">float</span> a, <span class="code-keyword">float</span> b) {
<span class="code-keyword">return</span> (a + b) / 2.0;
}

<span class="code-comment">// 5. Fonction avec retour de String</span>
<span class="code-type">String</span> <span class="code-function">creerMessage</span>(<span class="code-type">String</span> nom, <span class="code-keyword">int</span> age) {
<span class="code-type">String</span> message = <span class="code-string">"Bonjour "</span> + nom + <span class="code-string">", vous avez "</span> + age + <span class="code-string">" ans"</span>;
<span class="code-keyword">return</span> message;
}

<span class="code-comment">// 6. Fonction avec retour de tableau (via pointeur)</span>
<span class="code-keyword">void</span> <span class="code-function">creerTableau</span>(<span class="code-keyword">int</span> *tableau, <span class="code-keyword">int</span> taille) {
<span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < taille; i++) {
  tableau[i] = i * i;  <span class="code-comment">// Carrés des nombres</span>
}
}

<span class="code-comment">// 7. Fonction avec retour de structure</span>
Point <span class="code-function">creerPoint</span>(<span class="code-keyword">int</span> x, <span class="code-keyword">int</span> y) {
Point p;
p.x = x;
p.y = y;
<span class="code-keyword">return</span> p;
}

<span class="code-comment">// 8. Fonction avec plusieurs retours (via paramètres de référence)</span>
<span class="code-keyword">void</span> <span class="code-function">calculerMinMax</span>(<span class="code-keyword">int</span> a, <span class="code-keyword">int</span> b, <span class="code-keyword">int</span> &min, <span class="code-keyword">int</span> &max) {
<span class="code-keyword">if</span> (a < b) {
  min = a;
  max = b;
} <span class="code-keyword">else</span> {
  min = b;
  max = a;
}
}</code></pre>
          </div>

          <h4>Exemple complet</h4>
          <div class="code-example">
            <pre><code><span class="code-comment">/*
Programme démontrant les paramètres et retours de fonctions
*/</span>

<span class="code-keyword">struct</span> Rectangle {
<span class="code-keyword">float</span> largeur;
<span class="code-keyword">float</span> hauteur;
};

<span class="code-comment">// Fonction avec paramètre par valeur</span>
<span class="code-keyword">float</span> <span class="code-function">calculerPerimetre</span>(<span class="code-keyword">float</span> largeur, <span class="code-keyword">float</span> hauteur) {
<span class="code-keyword">return</span> 2 * (largeur + hauteur);
}

<span class="code-comment">// Fonction avec paramètre par référence</span>
<span class="code-keyword">void</span> <span class="code-function">echanger</span>(<span class="code-keyword">int</span> &a, <span class="code-keyword">int</span> &b) {
<span class="code-keyword">int</span> temp = a;
a = b;
b = temp;
}

<span class="code-comment">// Fonction avec paramètre par structure</span>
<span class="code-keyword">float</span> <span class="code-function">calculerAire</span>(<span class="code-keyword">const</span> Rectangle &rect) {
<span class="code-keyword">return</span> rect.largeur * rect.hauteur;
}

<span class="code-comment">// Fonction avec retour de structure</span>
Rectangle <span class="code-function">creerRectangle</span>(<span class="code-keyword">float</span> l, <span class="code-keyword">float</span> h) {
Rectangle rect;
rect.largeur = l;
rect.hauteur = h;
<span class="code-keyword">return</span> rect;
}

<span class="code-comment">// Fonction avec plusieurs retours via références</span>
<span class="code-keyword">void</span> <span class="code-function">analyserTableau</span>(<span class="code-keyword">int</span> tableau[], <span class="code-keyword">int</span> taille, 
                   <span class="code-keyword">int</span> &min, <span class="code-keyword">int</span> &max, <span class="code-keyword">float</span> &moyenne) {
<span class="code-keyword">if</span> (taille == 0) <span class="code-keyword">return</span>;

min = tableau[0];
max = tableau[0];
<span class="code-keyword">int</span> somme = 0;

<span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < taille; i++) {
  <span class="code-keyword">if</span> (tableau[i] < min) min = tableau[i];
  <span class="code-keyword">if</span> (tableau[i] > max) max = tableau[i];
  somme += tableau[i];
}

moyenne = <span class="code-keyword">static_cast</span>&lt;<span class="code-keyword">float</span>&gt;(somme) / taille;
}

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
Serial.<span class="code-function">begin</span>(9600);

<span class="code-comment">// Test des fonctions</span>
Serial.<span class="code-function">println</span>(<span class="code-string">"=== Tests parametres et retours ==="</span>);

<span class="code-comment">// 1. Test paramètre par valeur</span>
<span class="code-keyword">float</span> perimetre = <span class="code-function">calculerPerimetre</span>(5.0, 3.0);
Serial.<span class="code-function">print</span>(<span class="code-string">"Perimetre rectangle 5x3: "</span>);
Serial.<span class="code-function">println</span>(perimetre);

<span class="code-comment">// 2. Test paramètre par référence</span>
<span class="code-keyword">int</span> x = 10, y = 20;
Serial.<span class="code-function">print</span>(<span class="code-string">"Avant echange: x="</span>);
Serial.<span class="code-function">print</span>(x);
Serial.<span class="code-function">print</span>(<span class="code-string">", y="</span>);
Serial.<span class="code-function">println</span>(y);

<span class="code-function">echanger</span>(x, y);
Serial.<span class="code-function">print</span>(<span class="code-string">"Apres echange: x="</span>);
Serial.<span class="code-function">print</span>(x);
Serial.<span class="code-function">print</span>(<span class="code-string">", y="</span>);
Serial.<span class="code-function">println</span>(y);

<span class="code-comment">// 3. Test avec structure</span>
Rectangle monRect = <span class="code-function">creerRectangle</span>(4.0, 6.0);
<span class="code-keyword">float</span> aire = <span class="code-function">calculerAire</span>(monRect);
Serial.<span class="code-function">print</span>(<span class="code-string">"Aire rectangle 4x6: "</span>);
Serial.<span class="code-function">println</span>(aire);

<span class="code-comment">// 4. Test avec tableau et retours multiples</span>
<span class="code-keyword">int</span> donnees[] = {12, 45, 23, 67, 34, 89, 10};
<span class="code-keyword">int</span> taille = <span class="code-function">sizeof</span>(donnees) / <span class="code-function">sizeof</span>(donnees[0]);

<span class="code-keyword">int</span> min, max;
<span class="code-keyword">float</span> moyenne;
<span class="code-function">analyserTableau</span>(donnees, taille, min, max, moyenne);

Serial.<span class="code-function">println</span>(<span class="code-string">"Analyse du tableau:"</span>);
Serial.<span class="code-function">print</span>(<span class="code-string">"  Minimum: "</span>);
Serial.<span class="code-function">println</span>(min);
Serial.<span class="code-function">print</span>(<span class="code-string">"  Maximum: "</span>);
Serial.<span class="code-function">println</span>(max);
Serial.<span class="code-function">print</span>(<span class="code-string">"  Moyenne: "</span>);
Serial.<span class="code-function">println</span>(moyenne);

<span class="code-comment">// 5. Test fonction avec retour booléen</span>
Serial.<span class="code-function">print</span>(<span class="code-string">"15 est pair? "</span>);
Serial.<span class="code-function">println</span>(<span class="code-function">estPair</span>(15) ? <span class="code-string">"Oui"</span> : <span class="code-string">"Non"</span>);

Serial.<span class="code-function">print</span>(<span class="code-string">"20 est pair? "</span>);
Serial.<span class="code-function">println</span>(<span class="code-function">estPair</span>(20) ? <span class="code-string">"Oui"</span> : <span class="code-string">"Non"</span>);
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
<span class="code-comment">// Rien dans loop pour cet exemple</span>
<span class="code-function">delay</span>(1000);
}</code></pre>
          </div>
        </section>

        <!-- Récursivité -->
        <section id="recursivite">
          <h3>Récursivité en programmation</h3>
          <p>Une fonction récursive est une fonction qui s'appelle elle-même. Elle doit avoir une condition d'arrêt pour
            éviter la récursion infinie.</p>

          <div class="warning-box">
            <p><strong>Attention :</strong> Sur Arduino, l'espace mémoire est limité. Les fonctions récursives utilisent
              la pile (stack) et peuvent causer un débordement si la récursion est trop profonde.</p>
          </div>

          <h4>Exemples classiques de récursivité</h4>
          <div class="code-example">
            <pre><code><span class="code-comment">// 1. Factorielle (n!)</span>
<span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> <span class="code-function">factorielle</span>(<span class="code-keyword">int</span> n) {
<span class="code-comment">// Condition d'arrêt</span>
<span class="code-keyword">if</span> (n <= 1) {
  <span class="code-keyword">return</span> 1;
}
<span class="code-comment">// Appel récursif</span>
<span class="code-keyword">return</span> n * <span class="code-function">factorielle</span>(n - 1);
}

<span class="code-comment">// 2. Suite de Fibonacci</span>
<span class="code-keyword">int</span> <span class="code-function">fibonacci</span>(<span class="code-keyword">int</span> n) {
<span class="code-comment">// Conditions d'arrêt</span>
<span class="code-keyword">if</span> (n <= 0) <span class="code-keyword">return</span> 0;
<span class="code-keyword">if</span> (n == 1) <span class="code-keyword">return</span> 1;

<span class="code-comment">// Appel récursif</span>
<span class="code-keyword">return</span> <span class="code-function">fibonacci</span>(n - 1) + <span class="code-function">fibonacci</span>(n - 2);
}

<span class="code-comment">// 3. Exponentiation récursive</span>
<span class="code-keyword">int</span> <span class="code-function">puissance</span>(<span class="code-keyword">int</span> base, <span class="code-keyword">int</span> exposant) {
<span class="code-comment">// Condition d'arrêt</span>
<span class="code-keyword">if</span> (exposant == 0) {
  <span class="code-keyword">return</span> 1;
}
<span class="code-comment">// Appel récursif</span>
<span class="code-keyword">return</span> base * <span class="code-function">puissance</span>(base, exposant - 1);
}

<span class="code-comment">// 4. Somme des éléments d'un tableau (récursif)</span>
<span class="code-keyword">int</span> <span class="code-function">sommeTableau</span>(<span class="code-keyword">int</span> tableau[], <span class="code-keyword">int</span> taille) {
<span class="code-comment">// Condition d'arrêt</span>
<span class="code-keyword">if</span> (taille == 0) {
  <span class="code-keyword">return</span> 0;
}
<span class="code-comment">// Appel récursif : dernier élément + somme du reste</span>
<span class="code-keyword">return</span> tableau[taille - 1] + <span class="code-function">sommeTableau</span>(tableau, taille - 1);
}

<span class="code-comment">// 5. Recherche binaire récursive (tableau trié)</span>
<span class="code-keyword">int</span> <span class="code-function">rechercheBinaire</span>(<span class="code-keyword">int</span> tableau[], <span class="code-keyword">int</span> debut, <span class="code-keyword">int</span> fin, <span class="code-keyword">int</span> valeur) {
<span class="code-comment">// Condition d'arrêt : élément non trouvé</span>
<span class="code-keyword">if</span> (debut > fin) {
  <span class="code-keyword">return</span> -1;
}

<span class="code-keyword">int</span> milieu = (debut + fin) / 2;

<span class="code-comment">// Condition d'arrêt : élément trouvé</span>
<span class="code-keyword">if</span> (tableau[milieu] == valeur) {
  <span class="code-keyword">return</span> milieu;
}

<span class="code-comment">// Appels récursifs</span>
<span class="code-keyword">if</span> (tableau[milieu] > valeur) {
  <span class="code-comment">// Recherche dans la moitié gauche</span>
  <span class="code-keyword">return</span> <span class="code-function">rechercheBinaire</span>(tableau, debut, milieu - 1, valeur);
} <span class="code-keyword">else</span> {
  <span class="code-comment">// Recherche dans la moitié droite</span>
  <span class="code-keyword">return</span> <span class="code-function">rechercheBinaire</span>(tableau, milieu + 1, fin, valeur);
}
}

<span class="code-comment">// 6. Parcours récursif d'une structure arborescente (simulée)</span>
<span class="code-keyword">struct</span> Noeud {
<span class="code-keyword">int</span> valeur;
Noeud* gauche;
Noeud* droit;
};

<span class="code-keyword">void</span> <span class="code-function">parcoursPrefixe</span>(Noeud* racine) {
<span class="code-comment">// Condition d'arrêt</span>
<span class="code-keyword">if</span> (racine == <span class="code-keyword">nullptr</span>) {
  <span class="code-keyword">return</span>;
}

<span class="code-comment">// Traitement du noeud courant</span>
Serial.<span class="code-function">println</span>(racine-&gt;valeur);

<span class="code-comment">// Appels récursifs</span>
<span class="code-function">parcoursPrefixe</span>(racine-&gt;gauche);
<span class="code-function">parcoursPrefixe</span>(racine-&gt;droit);
}</code></pre>
          </div>

          <h4>Exemple complet avec récursivité</h4>
          <div class="code-example">
            <pre><code><span class="code-comment">/*
Programme démontrant la récursivité sur Arduino
Attention : utiliser avec prudence à cause des limites de mémoire
*/</span>

<span class="code-comment">// Compteur pour suivre la profondeur de récursivité</span>
<span class="code-keyword">int</span> profondeurMax = 0;

<span class="code-comment">// 1. Fonction pour afficher un compte à rebours récursif</span>
<span class="code-keyword">void</span> <span class="code-function">compteRebours</span>(<span class="code-keyword">int</span> n, <span class="code-keyword">int</span> profondeur = 0) {
<span class="code-comment">// Mise à jour de la profondeur maximale</span>
<span class="code-keyword">if</span> (profondeur > profondeurMax) {
  profondeurMax = profondeur;
}

<span class="code-comment">// Condition d'arrêt</span>
<span class="code-keyword">if</span> (n < 0) {
  Serial.<span class="code-function">println</span>(<span class="code-string">"Fin du compte a rebours!"</span>);
  <span class="code-keyword">return</span>;
}

<span class="code-comment">// Affichage du nombre courant</span>
Serial.<span class="code-function">print</span>(<span class="code-string">"Compte rebours: "</span>);
Serial.<span class="code-function">println</span>(n);

<span class="code-function">delay</span>(500);  <span class="code-comment">// Pause pour visualiser</span>

<span class="code-comment">// Appel récursif</span>
<span class="code-function">compteRebours</span>(n - 1, profondeur + 1);
}

<span class="code-comment">// 2. Fonction pour calculer le PGCD (récursif)</span>
<span class="code-keyword">int</span> <span class="code-function">pgcd</span>(<span class="code-keyword">int</span> a, <span class="code-keyword">int</span> b) {
<span class="code-comment">// Condition d'arrêt</span>
<span class="code-keyword">if</span> (b == 0) {
  <span class="code-keyword">return</span> a;
}

<span class="code-comment">// Appel récursif</span>
<span class="code-keyword">return</span> <span class="code-function">pgcd</span>(b, a % b);
}

<span class="code-comment">// 3. Fonction pour inverser une chaîne (simulée avec tableau)</span>
<span class="code-keyword">void</span> <span class="code-function">inverserChaine</span>(<span class="code-type">char</span> chaine[], <span class="code-keyword">int</span> debut, <span class="code-keyword">int</span> fin) {
<span class="code-comment">// Condition d'arrêt</span>
<span class="code-keyword">if</span> (debut >= fin) {
  <span class="code-keyword">return</span>;
}

<span class="code-comment">// Échange des caractères aux extrémités</span>
<span class="code-type">char</span> temp = chaine[debut];
chaine[debut] = chaine[fin];
chaine[fin] = temp;

<span class="code-comment">// Appel récursif pour le reste de la chaîne</span>
<span class="code-function">inverserChaine</span>(chaine, debut + 1, fin - 1);
}

<span class="code-comment">// 4. Fonction pour générer la séquence de Collatz (récursive)</span>
<span class="code-keyword">void</span> <span class="code-function">collatz</span>(<span class="code-keyword">int</span> n, <span class="code-keyword">int</span> etape = 0) {
Serial.<span class="code-function">print</span>(<span class="code-string">"Etape "</span>);
Serial.<span class="code-function">print</span>(etape);
Serial.<span class="code-function">print</span>(<span class="code-string">": "</span>);
Serial.<span class="code-function">println</span>(n);

<span class="code-comment">// Condition d'arrêt</span>
<span class="code-keyword">if</span> (n == 1) {
  Serial.<span class="code-function">println</span>(<span class="code-string">"Sequence terminee en "</span> + <span class="code-type">String</span>(etape) + <span class="code-string">" etapes"</span>);
  <span class="code-keyword">return</span>;
}

<span class="code-function">delay</span>(200);  <span class="code-comment">// Pause pour visualiser</span>

<span class="code-comment">// Règle de Collatz et appel récursif</span>
<span class="code-keyword">if</span> (n % 2 == 0) {  <span class="code-comment">// Si n est pair</span>
  <span class="code-function">collatz</span>(n / 2, etape + 1);
} <span class="code-keyword">else</span> {              <span class="code-comment">// Si n est impair</span>
  <span class="code-function">collatz</span>(3 * n + 1, etape + 1);
}
}

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
Serial.<span class="code-function">begin</span>(9600);

Serial.<span class="code-function">println</span>(<span class="code-string">"=== Demonstration de la recursivite ==="</span>);
Serial.<span class="code-function">println</span>();

<span class="code-comment">// Test 1 : Compte à rebours</span>
Serial.<span class="code-function">println</span>(<span class="code-string">"1. Compte a rebours recursif:"</span>);
profondeurMax = 0;
<span class="code-function">compteRebours</span>(5);
Serial.<span class="code-function">print</span>(<span class="code-string">"Profondeur maximale: "</span>);
Serial.<span class="code-function">println</span>(profondeurMax);
Serial.<span class="code-function">println</span>();

<span class="code-function">delay</span>(1000);

<span class="code-comment">// Test 2 : PGCD</span>
Serial.<span class="code-function">println</span>(<span class="code-string">"2. Calcul du PGCD:"</span>);
<span class="code-keyword">int</span> a = 48, b = 18;
<span class="code-keyword">int</span> resultatPGCD = <span class="code-function">pgcd</span>(a, b);
Serial.<span class="code-function">print</span>(<span class="code-string">"PGCD("</span>);
Serial.<span class="code-function">print</span>(a);
Serial.<span class="code-function">print</span>(<span class="code-string">", "</span>);
Serial.<span class="code-function">print</span>(b);
Serial.<span class="code-function">print</span>(<span class="code-string">") = "</span>);
Serial.<span class="code-function">println</span>(resultatPGCD);
Serial.<span class="code-function">println</span>();

<span class="code-function">delay</span>(1000);

<span class="code-comment">// Test 3 : Inversion de chaîne</span>
Serial.<span class="code-function">println</span>(<span class="code-string">"3. Inversion de chaine:"</span>);
<span class="code-type">char</span> message[] = <span class="code-string">"ARDUINO"</span>;
Serial.<span class="code-function">print</span>(<span class="code-string">"Original: "</span>);
Serial.<span class="code-function">println</span>(message);

<span class="code-function">inverserChaine</span>(message, 0, <span class="code-function">strlen</span>(message) - 1);
Serial.<span class="code-function">print</span>(<span class="code-string">"Inverse: "</span>);
Serial.<span class="code-function">println</span>(message);
Serial.<span class="code-function">println</span>();

<span class="code-function">delay</span>(1000);

<span class="code-comment">// Test 4 : Factorielle (avec limitation)</span>
Serial.<span class="code-function">println</span>(<span class="code-string">"4. Factorielle (limitee pour Arduino):"</span>);
<span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i <= 7; i++) {  <span class="code-comment">// Limité à 7! à cause de la mémoire</span>
  Serial.<span class="code-function">print</span>(i);
  Serial.<span class="code-function">print</span>(<span class="code-string">"! = "</span>);
  Serial.<span class="code-function">println</span>(<span class="code-function">factorielle</span>(i));
}
Serial.<span class="code-function">println</span>();

<span class="code-function">delay</span>(1000);

<span class="code-comment">// Test 5 : Séquence de Collatz</span>
Serial.<span class="code-function">println</span>(<span class="code-string">"5. Sequence de Collatz pour n=27:"</span>);
<span class="code-function">collatz</span>(27);

Serial.<span class="code-function">println</span>();
Serial.<span class="code-function">println</span>(<span class="code-string">"=== Fin de la demonstration ==="</span>);
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
<span class="code-comment">// Programme en une seule exécution</span>
<span class="code-function">delay</span>(1000);
}</code></pre>
          </div>

          <div class="info-box">
            <p><strong>Conseil :</strong> Sur Arduino, préférez les solutions itératives (boucles) aux solutions
              récursives pour économiser la mémoire de la pile (stack), sauf lorsque la récursivité simplifie
              considérablement le code.</p>
          </div>
        </section>
      </section>

      <!-- =========================================== -->
      <!-- SECTION ENTRÉES/SORTIES -->
      <!-- =========================================== -->
      <section id="entrees-sorties">
        <h2>Entrées et Sorties (I/O) sur Arduino</h2>
        <p>Les broches d'entrée/sortie permettent d'interagir avec le monde extérieur : lire des capteurs, contrôler des
          actionneurs, etc.</p>

        <h3 id="digital">Entrées/Sorties Digitales</h3>
        <div class="code-example">
          <pre><code><span class="code-comment">/*
  Programme complet : Contrôle d'une LED avec un bouton
  Bouton connecté à la broche 2, LED connectée à la broche 13
*/</span>

<span class="code-keyword">const</span> <span class="code-keyword">int</span> BOUTON_PIN = 2;
<span class="code-keyword">const</span> <span class="code-keyword">int</span> LED_PIN = 13;

<span class="code-keyword">int</span> etatBouton = LOW;
<span class="code-keyword">int</span> dernierEtatBouton = LOW;
<span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> dernierDebounce = 0;
<span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> delaiDebounce = 50;

<span class="code-keyword">bool</span> ledAllumee = <span class="code-keyword">false</span>;

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  Serial.<span class="code-function">begin</span>(9600);
  
  <span class="code-comment">// Configuration des broches</span>
  <span class="code-function">pinMode</span>(BOUTON_PIN, INPUT_PULLUP);  <span class="code-comment">// Résistance pull-up interne</span>
  <span class="code-function">pinMode</span>(LED_PIN, OUTPUT);
  
  Serial.<span class="code-function">println</span>(<span class="code-string">"Controle LED avec bouton - Pret"</span>);
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
  <span class="code-comment">// Lecture de l'état du bouton</span>
  <span class="code-keyword">int</span> lecture = <span class="code-function">digitalRead</span>(BOUTON_PIN);
  
  <span class="code-comment">// Anti-rebond (debounce)</span>
  <span class="code-keyword">if</span> (lecture != dernierEtatBouton) {
    dernierDebounce = <span class="code-function">millis</span>();
  }
  
  <span class="code-keyword">if</span> ((<span class="code-function">millis</span>() - dernierDebounce) > delaiDebounce) {
    <span class="code-comment">// Si l'état a changé</span>
    <span class="code-keyword">if</span> (lecture != etatBouton) {
      etatBouton = lecture;
      
      <span class="code-comment">// Si le bouton est appuyé (LOW avec pull-up)</span>
      <span class="code-keyword">if</span> (etatBouton == LOW) {
        ledAllumee = !ledAllumee;  <span class="code-comment">// Inverse l'état</span>
        
        <span class="code-keyword">if</span> (ledAllumee) {
          <span class="code-function">digitalWrite</span>(LED_PIN, HIGH);
          Serial.<span class="code-function">println</span>(<span class="code-string">"LED allumee"</span>);
        } <span class="code-keyword">else</span> {
          <span class="code-function">digitalWrite</span>(LED_PIN, LOW);
          Serial.<span class="code-function">println</span>(<span class="code-string">"LED eteinte"</span>);
        }
      }
    }
  }
  
  dernierEtatBouton = lecture;
}</code></pre>
        </div>

        <h3 id="analog">Entrées/Sorties Analogiques</h3>
        <div class="code-example">
          <pre><code><span class="code-comment">/*
  Lecture d'un potentiomètre et contrôle d'une LED en PWM
  Potentiomètre connecté à A0, LED connectée à la broche 9 (PWM)
*/</span>

<span class="code-keyword">const</span> <span class="code-keyword">int</span> POT_PIN = A0;
<span class="code-keyword">const</span> <span class="code-keyword">int</span> LED_PIN = 9;

<span class="code-keyword">int</span> valeurPot = 0;
<span class="code-keyword">int</span> luminosite = 0;

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  Serial.<span class="code-function">begin</span>(9600);
  
  <span class="code-comment">// Pas besoin de pinMode pour les entrées analogiques</span>
  <span class="code-comment">// La broche LED est configurée automatiquement par analogWrite</span>
  
  Serial.<span class="code-function">println</span>(<span class="code-string">"Controle LED PWM avec potentiometre"</span>);
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
  <span class="code-comment">// Lecture du potentiomètre (0-1023)</span>
  valeurPot = <span class="code-function">analogRead</span>(POT_PIN);
  
  <span class="code-comment">// Conversion en valeur PWM (0-255)</span>
  luminosite = <span class="code-function">map</span>(valeurPot, 0, 1023, 0, 255);
  
  <span class="code-comment">// Application de la luminosité à la LED</span>
  <span class="code-function">analogWrite</span>(LED_PIN, luminosite);
  
  <span class="code-comment">// Affichage des valeurs (toutes les 100ms)</span>
  <span class="code-keyword">static</span> <span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> dernierAffichage = 0;
  <span class="code-keyword">if</span> (<span class="code-function">millis</span>() - dernierAffichage > 100) {
    Serial.<span class="code-function">print</span>(<span class="code-string">"Potentiometre: "</span>);
    Serial.<span class="code-function">print</span>(valeurPot);
    Serial.<span class="code-function">print</span>(<span class="code-string">" | Luminosite: "</span>);
    Serial.<span class="code-function">println</span>(luminosite);
    
    dernierAffichage = <span class="code-function">millis</span>();
  }
  
  <span class="code-function">delay</span>(10);  <span class="code-comment">// Petit délai pour stabilité</span>
}</code></pre>
        </div>

        <h3 id="pwm">PWM (Pulse Width Modulation)</h3>
        <div class="info-box">
          <p><strong>PWM (Modulation par Largeur d'Impulsion)</strong> : Technique pour simuler une sortie analogique
            avec une sortie digitale. Les broches PWM sur Arduino Uno sont : 3, 5, 6, 9, 10, 11 (marquées ~).</p>
        </div>
        <!-- Interruptions -->
        <section id="interruptions">
          <h3>Interruptions (Interrupts) sur Arduino</h3>
          <p>Les interruptions permettent d'interrompre l'exécution normale du programme pour exécuter une fonction
            spécifique lorsqu'un événement se produit.</p>

          <div class="info-box">
            <p><strong>Important :</strong> Les fonctions d'interruption (ISR - Interrupt Service Routine) doivent être
              courtes et rapides. Évitez les <code>delay()</code>, <code>millis()</code> et les communications série
              complexes dans les ISR.</p>
          </div>

          <h4>Types d'interruptions sur Arduino</h4>
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>Carte</th>
                  <th>Broches d'interruption</th>
                  <th>Numéros d'interruption</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Arduino Uno, Nano</td>
                  <td>2, 3</td>
                  <td>0 (pin 2), 1 (pin 3)</td>
                </tr>
                <tr>
                  <td>Arduino Mega</td>
                  <td>2, 3, 18, 19, 20, 21</td>
                  <td>0 à 5</td>
                </tr>
                <tr>
                  <td>Arduino Leonardo, Micro</td>
                  <td>0, 1, 2, 3, 7</td>
                  <td>0, 1, 2, 3, 4</td>
                </tr>
                <tr>
                  <td>ESP32</td>
                  <td>Toutes les broches GPIO*</td>
                  <td>Numéros variables</td>
                </tr>
                <tr>
                  <td>ESP8266</td>
                  <td>Toutes les broches* (sauf GPIO16)</td>
                  <td>Numéros variables</td>
                </tr>
              </tbody>
            </table>
            <p class="code-comment" style="margin-top: 0.5rem;">* Sur ESP, la plupart des broches supportent les
              interruptions</p>
          </div>

          <h4>Modes d'interruption disponibles</h4>
          <div class="code-example">
            <pre><code><span class="code-comment">// Modes d'interruption disponibles :</span>
LOW        <span class="code-comment">// Déclenche quand la broche est BASSE</span>
CHANGE     <span class="code-comment">// Déclenche quand la broche change d'état</span>
RISING     <span class="code-comment">// Déclenche quand la broche passe de LOW à HIGH</span>
FALLING    <span class="code-comment">// Déclenche quand la broche passe de HIGH à LOW</span>
HIGH       <span class="code-comment">// Déclenche quand la broche est HAUTE (certaines cartes seulement)</span></code></pre>
          </div>

          <h4>Exemples d'utilisation des interruptions</h4>

          <div class="code-example">
            <h5>Exemple 1 : Compteur d'interruptions simple</h5>
            <pre><code><span class="code-comment">/*
Compteur d'interruptions avec bouton
Bouton connecté à la broche d'interruption 2
*/</span>

<span class="code-keyword">volatile</span> <span class="code-keyword">int</span> compteur = 0;        <span class="code-comment">// volatile pour les variables partagées avec ISR</span>
<span class="code-keyword">const</span> <span class="code-keyword">int</span> BOUTON_INTERRUPT = 2;  <span class="code-comment">// Broche d'interruption</span>
<span class="code-keyword">const</span> <span class="code-keyword">int</span> LED_PIN = 13;

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
Serial.<span class="code-function">begin</span>(9600);

<span class="code-comment">// Configuration des broches</span>
<span class="code-function">pinMode</span>(BOUTON_INTERRUPT, INPUT_PULLUP);
<span class="code-function">pinMode</span>(LED_PIN, OUTPUT);

<span class="code-comment">// Attachement de l'interruption</span>
<span class="code-comment">// attachInterrupt(digitalPinToInterrupt(pin), ISR, mode)</span>
<span class="code-function">attachInterrupt</span>(<span class="code-function">digitalPinToInterrupt</span>(BOUTON_INTERRUPT), interruptionBouton, FALLING);

Serial.<span class="code-function">println</span>(<span class="code-string">"Systeme interruptions pret"</span>);
Serial.<span class="code-function">println</span>(<span class="code-string">"Appuyez sur le bouton..."</span>);
}

<span class="code-comment">// Fonction d'interruption (ISR) - DOIT ETRE COURTE ET RAPIDE</span>
<span class="code-keyword">void</span> <span class="code-function">interruptionBouton</span>() {
compteur++;  <span class="code-comment">// Incrémente le compteur</span>
<span class="code-function">digitalWrite</span>(LED_PIN, HIGH);  <span class="code-comment">// Allume la LED brièvement</span>
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
<span class="code-comment">// Éteint la LED après un court instant</span>
<span class="code-function">digitalWrite</span>(LED_PIN, LOW);

<span class="code-comment">// Affiche le compteur périodiquement</span>
<span class="code-keyword">static</span> <span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> dernierAffichage = 0;
<span class="code-keyword">if</span> (<span class="code-function">millis</span>() - dernierAffichage > 1000) {
  Serial.<span class="code-function">print</span>(<span class="code-string">"Compteur: "</span>);
  Serial.<span class="code-function">println</span>(compteur);
  dernierAffichage = <span class="code-function">millis</span>();
}
}</code></pre>
          </div>

          <div class="code-example">
            <h5>Exemple 2 : Anti-rebond (debounce) avec interruptions</h5>
            <pre><code><span class="code-comment">/*
Anti-rebond amélioré avec interruptions et gestion du temps
*/</span>

<span class="code-keyword">volatile</span> <span class="code-keyword">bool</span> boutonAppuye = <span class="code-keyword">false</span>;
<span class="code-keyword">volatile</span> <span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> dernierAppui = 0;
<span class="code-keyword">const</span> <span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> DELAI_ANTI_REBOND = 50;  <span class="code-comment">// 50ms pour l'anti-rebond</span>

<span class="code-keyword">const</span> <span class="code-keyword">int</span> BOUTON_PIN = 2;
<span class="code-keyword">const</span> <span class="code-keyword">int</span> LED_PIN = 13;

<span class="code-keyword">bool</span> ledAllumee = <span class="code-keyword">false</span>;

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
Serial.<span class="code-function">begin</span>(9600);

<span class="code-function">pinMode</span>(BOUTON_PIN, INPUT_PULLUP);
<span class="code-function">pinMode</span>(LED_PIN, OUTPUT);

<span class="code-comment">// Attachement de l'interruption sur changement d'état</span>
<span class="code-function">attachInterrupt</span>(<span class="code-function">digitalPinToInterrupt</span>(BOUTON_PIN), interruptionBouton, CHANGE);

Serial.<span class="code-function">println</span>(<span class="code-string">"Systeme anti-rebond avec interruptions pret"</span>);
}

<span class="code-comment">// ISR avec anti-rebond</span>
<span class="code-keyword">void</span> <span class="code-function">interruptionBouton</span>() {
<span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> tempsActuel = <span class="code-function">micros</span>();  <span class="code-comment">// Utilise micros() pour plus de précision</span>

<span class="code-comment">// Anti-rebond : ignore les appuis trop rapprochés</span>
<span class="code-keyword">if</span> (tempsActuel - dernierAppui > DELAI_ANTI_REBOND * 1000) {
  boutonAppuye = <span class="code-keyword">true</span>;
  dernierAppui = tempsActuel;
}
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
<span class="code-keyword">if</span> (boutonAppuye) {
  boutonAppuye = <span class="code-keyword">false</span>;  <span class="code-comment">// Réinitialise le flag</span>
  
  <span class="code-comment">// Inversion de l'état de la LED</span>
  ledAllumee = !ledAllumee;
  
  <span class="code-keyword">if</span> (ledAllumee) {
    <span class="code-function">digitalWrite</span>(LED_PIN, HIGH);
    Serial.<span class="code-function">println</span>(<span class="code-string">"LED allumee"</span>);
  } <span class="code-keyword">else</span> {
    <span class="code-function">digitalWrite</span>(LED_PIN, LOW);
    Serial.<span class="code-function">println</span>(<span class="code-string">"LED eteinte"</span>);
  }
}

<span class="code-comment">// Autres tâches peuvent s'exécuter ici sans être bloquées</span>
<span class="code-function">delay</span>(10);  <span class="code-comment">// Petit délai pour réduire la charge CPU</span>
}</code></pre>
          </div>

          <div class="code-example">
            <h5>Exemple 3 : Gestion de plusieurs interruptions</h5>
            <pre><code><span class="code-comment">/*
Gestion de plusieurs boutons avec interruptions
*/</span>

<span class="code-keyword">volatile</span> <span class="code-keyword">bool</span> bouton1Appuye = <span class="code-keyword">false</span>;
<span class="code-keyword">volatile</span> <span class="code-keyword">bool</span> bouton2Appuye = <span class="code-keyword">false</span>;

<span class="code-keyword">const</span> <span class="code-keyword">int</span> BOUTON1_PIN = 2;   <span class="code-comment">// Interruption 0</span>
<span class="code-keyword">const</span> <span class="code-keyword">int</span> BOUTON2_PIN = 3;   <span class="code-comment">// Interruption 1</span>
<span class="code-keyword">const</span> <span class="code-keyword">int</span> LED_ROUGE = 9;
<span class="code-keyword">const</span> <span class="code-keyword">int</span> LED_VERTE = 10;

<span class="code-keyword">int</span> luminositeRouge = 0;
<span class="code-keyword">int</span> luminositeVerte = 0;

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
Serial.<span class="code-function">begin</span>(9600);

<span class="code-comment">// Configuration des broches</span>
<span class="code-function">pinMode</span>(BOUTON1_PIN, INPUT_PULLUP);
<span class="code-function">pinMode</span>(BOUTON2_PIN, INPUT_PULLUP);
<span class="code-function">pinMode</span>(LED_ROUGE, OUTPUT);
<span class="code-function">pinMode</span>(LED_VERTE, OUTPUT);

<span class="code-comment">// Attachement des interruptions</span>
<span class="code-function">attachInterrupt</span>(<span class="code-function">digitalPinToInterrupt</span>(BOUTON1_PIN), interruptionBouton1, FALLING);
<span class="code-function">attachInterrupt</span>(<span class="code-function">digitalPinToInterrupt</span>(BOUTON2_PIN), interruptionBouton2, FALLING);

Serial.<span class="code-function">println</span>(<span class="code-string">"Systeme multi-interruptions pret"</span>);
Serial.<span class="code-function">println</span>(<span class="code-string">"Bouton 1: Augmente LED rouge"</span>);
Serial.<span class="code-function">println</span>(<span class="code-string">"Bouton 2: Augmente LED verte"</span>);
}

<span class="code-comment">// ISR pour le bouton 1</span>
<span class="code-keyword">void</span> <span class="code-function">interruptionBouton1</span>() {
bouton1Appuye = <span class="code-keyword">true</span>;
}

<span class="code-comment">// ISR pour le bouton 2</span>
<span class="code-keyword">void</span> <span class="code-function">interruptionBouton2</span>() {
bouton2Appuye = <span class="code-keyword">true</span>;
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
<span class="code-comment">// Traitement du bouton 1</span>
<span class="code-keyword">if</span> (bouton1Appuye) {
  bouton1Appuye = <span class="code-keyword">false</span>;
  
  luminositeRouge += 25;
  <span class="code-keyword">if</span> (luminositeRouge > 255) {
    luminositeRouge = 0;
  }
  
  <span class="code-function">analogWrite</span>(LED_ROUGE, luminositeRouge);
  
  Serial.<span class="code-function">print</span>(<span class="code-string">"LED rouge: "</span>);
  Serial.<span class="code-function">println</span>(luminositeRouge);
}

<span class="code-comment">// Traitement du bouton 2</span>
<span class="code-keyword">if</span> (bouton2Appuye) {
  bouton2Appuye = <span class="code-keyword">false</span>;
  
  luminositeVerte += 25;
  <span class="code-keyword">if</span> (luminositeVerte > 255) {
    luminositeVerte = 0;
  }
  
  <span class="code-function">analogWrite</span>(LED_VERTE, luminositeVerte);
  
  Serial.<span class="code-function">print</span>(<span class="code-string">"LED verte: "</span>);
  Serial.<span class="code-function">println</span>(luminositeVerte);
}

<span class="code-comment">// Tâche de fond : effet de respiration sur les deux LEDs</span>
<span class="code-keyword">static</span> <span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> dernierUpdate = 0;
<span class="code-keyword">if</span> (<span class="code-function">millis</span>() - dernierUpdate > 20) {
  dernierUpdate = <span class="code-function">millis</span>();
  
  <span class="code-comment">// Maintien des luminosités (déjà définies par les interruptions)</span>
  <span class="code-function">analogWrite</span>(LED_ROUGE, luminositeRouge);
  <span class="code-function">analogWrite</span>(LED_VERTE, luminositeVerte);
}
}</code></pre>
          </div>

          <div class="code-example">
            <h5>Exemple 4 : Interruptions sur ESP32 (plus de broches disponibles)</h5>
            <pre><code><span class="code-comment">/*
Interruptions sur ESP32 avec plusieurs broches
ESP32 permet d'utiliser presque toutes les broches GPIO
*/</span>

<span class="code-comment">// Pour ESP32, inclure cette bibliothèque</span>
<span class="code-keyword">#include</span> &lt;Arduino.h&gt;

<span class="code-keyword">volatile</span> <span class="code-keyword">int</span> compteurInterruptions = 0;
<span class="code-keyword">volatile</span> <span class="code-keyword">bool</span> interruptionDeclenchee = <span class="code-keyword">false</span>;

<span class="code-keyword">const</span> <span class="code-keyword">int</span> BOUTON_PIN = 4;    <span class="code-comment">// GPIO4 sur ESP32</span>
<span class="code-keyword">const</span> <span class="code-keyword">int</span> LED_PIN = 2;      <span class="code-comment">// LED intégrée sur GPIO2</span>

<span class="code-comment">// Pour stocker le temps du dernier appui (anti-rebond)</span>
<span class="code-keyword">portMUX_TYPE</span> mux = portMUX_INITIALIZER_UNLOCKED;
<span class="code-keyword">volatile</span> <span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> dernierAppui = 0;
<span class="code-keyword">const</span> <span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> DELAI_ANTI_REBOND = 200000;  <span class="code-comment">// 200ms en microsecondes</span>

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
Serial.<span class="code-function">begin</span>(115200);

<span class="code-function">pinMode</span>(BOUTON_PIN, INPUT_PULLUP);
<span class="code-function">pinMode</span>(LED_PIN, OUTPUT);

<span class="code-comment">// Configuration de l'interruption sur ESP32</span>
<span class="function-name">attachInterrupt</span>(<span class="function-name">digitalPinToInterrupt</span>(BOUTON_PIN), interruptionESP32, FALLING);

Serial.<span class="function-name">println</span>("Systeme interruptions ESP32 pret");
Serial.<span class="function-name">println</span>("Appuyez sur le bouton connecte a GPIO4");
}

<span class="comment">// ISR pour ESP32 (avec protection contre les accès concurrents)</span>
<span class="type">void</span> <span class="function-name">interruptionESP32</span>() {
<span class="comment">// Protection contre les accès concurrents (multi-core)</span>
portENTER_CRITICAL_ISR(&mux);

<span class="type">unsigned</span> <span class="type">long</span> tempsActuel = micros();

<span class="comment">// Anti-rebond</span>
<span class="keyword">if</span> (tempsActuel - dernierAppui > DELAI_ANTI_REBOND) {
  compteurInterruptions++;
  interruptionDeclenchee = <span class="keyword">true</span>;
  dernierAppui = tempsActuel;
}

portEXIT_CRITICAL_ISR(&mux);
}

<span class="type">void</span> <span class="function-name">loop</span>() {
<span class="keyword">if</span> (interruptionDeclenchee) {
  interruptionDeclenchee = <span class="keyword">false</span>;
  
  <span class="comment">// Allume la LED brièvement</span>
  <span class="function-name">digitalWrite</span>(LED_PIN, HIGH);
  delay(50);
  <span class="function-name">digitalWrite</span>(LED_PIN, LOW);
  
  <span class="function-name">Serial.print</span>("Interruption ! Compteur: ");
  <span class="function-name">Serial.println</span>(compteurInterruptions);
}

<span class="comment">// Affiche l'état périodiquement</span>
<span class="keyword">static</span> <span class="type">unsigned</span> <span class="type">long</span> dernierAffichage = 0;
<span class="keyword">if</span> (millis() - dernierAffichage > 5000) {
  dernierAffichage = millis();
  <span class="function-name">Serial.print</span>("Etat actuel - Compteur total: ");
  <span class="function-name">Serial.println</span>(compteurInterruptions);
}

delay(10);
}</code></pre>
          </div>

          <h4>Bonnes pratiques pour les interruptions</h4>
          <div class="info-box">
            <ol>
              <li><strong>Gardez les ISR courtes :</strong> Ne faites que le minimum nécessaire (drapeaux, compteurs)
              </li>
              <li><strong>Utilisez <code>volatile</code> :</strong> Pour les variables partagées entre ISR et programme
                principal</li>
              <li><strong>Évitez les appels bloquants :</strong> Pas de <code>delay()</code>,
                <code>Serial.print()</code> complexes
              </li>
              <li><strong>Implémentez l'anti-rebond :</strong> Soit en hardware, soit en software avec gestion du temps
              </li>
              <li><strong>Désactivez les interruptions si nécessaire :</strong> <code>noInterrupts()</code> et
                <code>interrupts()</code>
              </li>
              <li><strong>Sur ESP32, protégez les accès :</span> Avec <code>portENTER_CRITICAL_ISR()</code> pour les
                  variables partagées</li>
            </ol>
          </div>

          <h4>Fonctions de gestion des interruptions</h4>
          <div class="code-example">
            <pre><code><span class="code-comment">// Activation/désactivation globale des interruptions</span>
<span class="code-function">interrupts</span>();      <span class="code-comment">// Active les interruptions</span>
<span class="code-function">noInterrupts</span>();    <span class="code-comment">// Désactive les interruptions</span>

<span class="code-comment">// Attachement et détachement d'interruptions</span>
<span class="code-function">attachInterrupt</span>(<span class="code-function">digitalPinToInterrupt</span>(pin), ISR, mode);
<span class="code-function">detachInterrupt</span>(<span class="code-function">digitalPinToInterrupt</span>(pin));

<span class="code-comment">// Exemple de section critique</span>
<span class="code-function">noInterrupts</span>();      <span class="code-comment">// Désactive les interruptions</span>
<span class="code-comment">// Code critique qui ne doit pas être interrompu</span>
variablePartagee++;
<span class="code-function">interrupts</span>();        <span class="code-comment">// Réactive les interruptions</span></code></pre>
          </div>
        </section>
        <div class="code-example">
          <pre><code><span class="code-comment">/*
  Effet de respiration (fade) sur une LED avec PWM
*/</span>

<span class="code-keyword">const</span> <span class="code-keyword">int</span> LED_PIN = 9;
<span class="code-keyword">int</span> luminosite = 0;
<span class="code-keyword">int</span> increment = 5;

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  <span class="code-comment">// Pas besoin de pinMode pour PWM avec analogWrite</span>
  Serial.<span class="code-function">begin</span>(9600);
  Serial.<span class="code-function">println</span>(<span class="code-string">"Effet de respiration LED PWM"</span>);
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
  <span class="code-comment">// Applique la luminosité courante</span>
  <span class="code-function">analogWrite</span>(LED_PIN, luminosite);
  
  <span class="code-comment">// Change la luminosité pour le prochain cycle</span>
  luminosite = luminosite + increment;
  
  <span class="code-comment">// Inverse la direction aux limites</span>
  <span class="code-keyword">if</span> (luminosite <= 0 || luminosite >= 255) {
    increment = -increment;
  }
  
  <span class="code-comment">// Affiche la luminosité</span>
  Serial.<span class="code-function">print</span>(<span class="code-string">"Luminosite: "</span>);
  Serial.<span class="code-function">println</span>(luminosite);
  
  <span class="code-function">delay</span>(30);  <span class="code-comment">// Contrôle la vitesse de l'effet</span>
}</code></pre>
        </div>
      </section>

      <!-- =========================================== -->
      <!-- SECTION ALLUMER UNE LED -->
      <!-- =========================================== -->
      <section id="allumer-led">
        <h2>Allumer une LED - Techniques avancées</h2>
        <p>Contrôler une LED est la base de nombreux projets Arduino. Voici différentes techniques.</p>

        <h3 id="led-simple">LED simple avec résistance</h3>
        <div class="info-box">
          <p><strong>Important :</strong> Toujours utiliser une résistance en série avec une LED pour limiter le
            courant. Valeur typique : 220Ω à 1kΩ.</p>
        </div>

        <div class="code-example">
          <pre><code><span class="code-comment">/*
  Allumage simple d'une LED externe
  LED connectée à la broche 7 via une résistance 220Ω
*/</span>

<span class="code-keyword">const</span> <span class="code-keyword">int</span> LED_PIN = 7;

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  <span class="code-function">pinMode</span>(LED_PIN, OUTPUT);
  Serial.<span class="code-function">begin</span>(9600);
  Serial.<span class="code-function">println</span>(<span class="code-string">"Controle LED simple"</span>);
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
  <span class="code-comment">// Allume la LED</span>
  <span class="code-function">digitalWrite</span>(LED_PIN, HIGH);
  Serial.<span class="code-function">println</span>(<span class="code-string">"LED allumee"</span>);
  <span class="code-function">delay</span>(2000);
  
  <span class="code-comment">// Éteint la LED</span>
  <span class="code-function">digitalWrite</span>(LED_PIN, LOW);
  Serial.<span class="code-function">println</span>(<span class="code-string">"LED eteinte"</span>);
  <span class="code-function">delay</span>(2000);
}</code></pre>
        </div>

        <h3 id="led-clignotante">LED clignotante avec motifs</h3>
        <div class="code-example">
          <pre><code><span class="code-comment">/*
  LED clignotante avec différents motifs
*/</span>

<span class="code-keyword">const</span> <span class="code-keyword">int</span> LED_PIN = 13;

<span class="code-comment">// Tableau de motifs : {temps allumé, temps éteint} en ms</span>
<span class="code-keyword">int</span> motifs[][2] = {
  {100, 100},    <span class="code-comment">// Rapide</span>
  {500, 500},    <span class="code-comment">// Moyen</span>
  {1000, 1000},  <span class="code-comment">// Lent</span>
  {100, 900},    <span class="code-comment">// Clignotement court</span>
  {50, 50, 50, 200}  <span class="code-comment">// SOS (modifié)</span>
};

<span class="code-keyword">int</span> motifActuel = 0;
<span class="code-keyword">int</span> nombreMotifs = 5;

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  <span class="code-function">pinMode</span>(LED_PIN, OUTPUT);
  Serial.<span class="code-function">begin</span>(9600);
  Serial.<span class="code-function">println</span>(<span class="code-string">"LED clignotante avec motifs"</span>);
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
  Serial.<span class="code-function">print</span>(<span class="code-string">"Motif "</span>);
  Serial.<span class="code-function">println</span>(motifActuel + 1);
  
  <span class="code-keyword">if</span> (motifActuel < 4) {  <span class="code-comment">// Motifs simples</span>
    <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < 10; i++) {  <span class="code-comment">// Répète 10 fois</span>
      <span class="code-function">digitalWrite</span>(LED_PIN, HIGH);
      <span class="code-function">delay</span>(motifs[motifActuel][0]);
      <span class="code-function">digitalWrite</span>(LED_PIN, LOW);
      <span class="code-function">delay</span>(motifs[motifActuel][1]);
    }
  } <span class="code-keyword">else</span> {  <span class="code-comment">// Motif SOS</span>
    <span class="code-comment">// S (3 courts)</span>
    <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < 3; i++) {
      <span class="code-function">digitalWrite</span>(LED_PIN, HIGH);
      <span class="code-function">delay</span>(motifs[motifActuel][0]);
      <span class="code-function">digitalWrite</span>(LED_PIN, LOW);
      <span class="code-function">delay</span>(motifs[motifActuel][1]);
    }
    
    <span class="code-comment">// O (3 longs)</span>
    <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < 3; i++) {
      <span class="code-function">digitalWrite</span>(LED_PIN, HIGH);
      <span class="code-function">delay</span>(motifs[motifActuel][2]);
      <span class="code-function">digitalWrite</span>(LED_PIN, LOW);
      <span class="code-function">delay</span>(motifs[motifActuel][1]);
    }
    
    <span class="code-comment">// S (3 courts)</span>
    <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < 3; i++) {
      <span class="code-function">digitalWrite</span>(LED_PIN, HIGH);
      <span class="code-function">delay</span>(motifs[motifActuel][0]);
      <span class="code-function">digitalWrite</span>(LED_PIN, LOW);
      <span class="code-function">delay</span>(motifs[motifActuel][1]);
    }
    
    <span class="code-function">delay</span>(1000);  <span class="code-comment">// Pause entre les SOS</span>
  }
  
  <span class="code-comment">// Passe au motif suivant</span>
  motifActuel = (motifActuel + 1) % nombreMotifs;
  <span class="code-function">delay</span>(1000);  <span class="code-comment">// Pause entre les motifs</span>
}</code></pre>
        </div>

        <h3 id="led-rvb">LED RGB (Cathode commune)</h3>
        <div class="code-example">
          <pre><code><span class="code-comment">/*
  Controle d'une LED RGB (cathode commune)
  Broches PWM requises : R=9, G=10, B=11
*/</span>

<span class="code-keyword">const</span> <span class="code-keyword">int</span> PIN_ROUGE = 9;
<span class="code-keyword">const</span> <span class="code-keyword">int</span> PIN_VERT = 10;
<span class="code-keyword">const</span> <span class="code-keyword">int</span> PIN_BLEU = 11;

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  Serial.<span class="code-function">begin</span>(9600);
  Serial.<span class="code-function">println</span>(<span class="code-string">"Controle LED RGB"</span>);
}

<span class="code-comment">// Fonction pour définir une couleur RGB</span>
<span class="code-keyword">void</span> <span class="code-function">setCouleur</span>(<span class="code-keyword">int</span> rouge, <span class="code-keyword">int</span> vert, <span class="code-keyword">int</span> bleu) {
  <span class="code-function">analogWrite</span>(PIN_ROUGE, rouge);
  <span class="code-function">analogWrite</span>(PIN_VERT, vert);
  <span class="code-function">analogWrite</span>(PIN_BLEU, bleu);
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
  Serial.<span class="code-function">println</span>(<span class="code-string">"Rouge"</span>);
  <span class="code-function">setCouleur</span>(255, 0, 0);   <span class="code-comment">// Rouge pur</span>
  <span class="code-function">delay</span>(1000);
  
  Serial.<span class="code-function">println</span>(<span class="code-string">"Vert"</span>);
  <span class="code-function">setCouleur</span>(0, 255, 0);   <span class="code-comment">// Vert pur</span>
  <span class="code-function">delay</span>(1000);
  
  Serial.<span class="code-function">println</span>(<span class="code-string">"Bleu"</span>);
  <span class="code-function">setCouleur</span>(0, 0, 255);   <span class="code-comment">// Bleu pur</span>
  <span class="code-function">delay</span>(1000);
  
  Serial.<span class="code-function">println</span>(<span class="code-string">"Jaune"</span>);
  <span class="code-function">setCouleur</span>(255, 255, 0); <span class="code-comment">// Jaune</span>
  <span class="code-function">delay</span>(1000);
  
  Serial.<span class="code-function">println</span>(<span class="code-string">"Magenta"</span>);
  <span class="code-function">setCouleur</span>(255, 0, 255); <span class="code-comment">// Magenta</span>
  <span class="code-function">delay</span>(1000);
  
  Serial.<span class="code-function">println</span>(<span class="code-string">"Cyan"</span>);
  <span class="code-function">setCouleur</span>(0, 255, 255); <span class="code-comment">// Cyan</span>
  <span class="code-function">delay</span>(1000);
  
  Serial.<span class="code-function">println</span>(<span class="code-string">"Blanc"</span>);
  <span class="code-function">setCouleur</span>(255, 255, 255); <span class="code-comment">// Blanc</span>
  <span class="code-function">delay</span>(1000);
  
  Serial.<span class="code-function">println</span>(<span class="code-string">"Eteint"</span>);
  <span class="code-function">setCouleur</span>(0, 0, 0);     <span class="code-comment">// Eteint</span>
  <span class="code-function">delay</span>(1000);
  
  <span class="code-comment">// Dégradé de couleurs</span>
  Serial.<span class="code-function">println</span>(<span class="code-string">"D degrade de couleurs..."</span>);
  <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i <= 255; i++) {
    <span class="code-function">setCouleur</span>(i, 255 - i, 128);
    <span class="code-function">delay</span>(10);
  }
}</code></pre>
        </div>
      </section>

      <!-- =========================================== -->
      <!-- SECTION BIBLIOTHÈQUES (.H) -->
      <!-- =========================================== -->
      <section id="bibliotheques">
        <h2>Bibliothèques Arduino (.h et .cpp)</h2>
        <p>Les bibliothèques étendent les fonctionnalités d'Arduino en fournissant du code réutilisable.</p>

        <h3 id="utilisation-biblio">Utilisation des bibliothèques</h3>
        <div class="code-example">
          <pre><code><span class="code-comment">/*
  Exemple d'utilisation de bibliothèques standard
  Utilise Servo.h pour contrôler un servomoteur
  et LiquidCrystal.h pour un écran LCD
*/</span>

<span class="code-comment">// Inclusion des bibliothèques</span>
<span class="code-keyword">#include</span> &lt;Servo.h&gt;
<span class="code-keyword">#include</span> &lt;LiquidCrystal.h&gt;

<span class="code-comment">// Création des objets</span>
Servo monServo;
<span class="code-comment">// LCD: RS, EN, D4, D5, D6, D7</span>
LiquidCrystal lcd(12, 11, 5, 4, 3, 2);

<span class="code-comment">// Définition des broches</span>
<span class="code-keyword">const</span> <span class="code-keyword">int</span> PIN_SERVO = 9;
<span class="code-keyword">const</span> <span class="code-keyword">int</span> POT_PIN = A0;

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  Serial.<span class="code-function">begin</span>(9600);
  
  <span class="code-comment">// Initialisation du servomoteur</span>
  monServo.<span class="code-function">attach</span>(PIN_SERVO);
  
  <span class="code-comment">// Initialisation de l'écran LCD (16 colonnes, 2 lignes)</span>
  lcd.<span class="code-function">begin</span>(16, 2);
  lcd.<span class="code-function">print</span>(<span class="code-string">"Servo Control"</span>);
  
  Serial.<span class="code-function">println</span>(<span class="code-string">"Systeme pret"</span>);
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
  <span class="code-comment">// Lecture du potentiomètre</span>
  <span class="code-keyword">int</span> valeurPot = <span class="code-function">analogRead</span>(POT_PIN);
  
  <span class="code-comment">// Conversion en angle (0-180 degrés)</span>
  <span class="code-keyword">int</span> angle = <span class="code-function">map</span>(valeurPot, 0, 1023, 0, 180);
  
  <span class="code-comment">// Déplacement du servomoteur</span>
  monServo.<span class="code-function">write</span>(angle);
  
  <span class="code-comment">// Affichage sur LCD</span>
  lcd.<span class="code-function">setCursor</span>(0, 1);
  lcd.<span class="code-function">print</span>(<span class="code-string">"Angle: "</span>);
  lcd.<span class="code-function">print</span>(angle);
  lcd.<span class="code-function">print</span>(<span class="code-string">"   "</span>);  <span class="code-comment">// Pour effacer les caractères restants</span>
  
  <span class="code-comment">// Affichage sur moniteur série</span>
  Serial.<span class="code-function">print</span>(<span class="code-string">"Potentiometre: "</span>);
  Serial.<span class="code-function">print</span>(valeurPot);
  Serial.<span class="code-function">print</span>(<span class="code-string">" | Angle: "</span>);
  Serial.<span class="code-function">println</span>(angle);
  
  <span class="code-function">delay</span>(50);
}</code></pre>
        </div>

        <h3 id="creation-biblio">Création d'une bibliothèque personnalisée</h3>

        <div class="code-example">
          <h4>Fichier LEDController.h (en-tête)</h4>
          <pre><code><span class="code-comment">/*
  LEDController.h - Bibliothèque pour contrôler des LEDs
  Créé par Votre Nom, Date
*/</span>

<span class="code-comment">// Garde contre les inclusions multiples</span>
<span class="code-keyword">#ifndef</span> LEDController_h
<span class="code-keyword">#define</span> LEDController_h

<span class="code-comment">// Inclusion des bibliothèques nécessaires</span>
<span class="code-keyword">#include</span> <span class="code-string">"Arduino.h"</span>

<span class="code-comment">// Définition de la classe</span>
<span class="code-keyword">class</span> LEDController {
  <span class="code-keyword">public</span>:
    <span class="code-comment">// Constructeurs</span>
    LEDController(<span class="code-keyword">int</span> pin);                     <span class="code-comment">// Constructeur simple</span>
    LEDController(<span class="code-keyword">int</span> pin, <span class="code-keyword">bool</span> initialState); <span class="code-comment">// Avec état initial</span>
    
    <span class="code-comment">// Méthodes publiques</span>
    <span class="code-keyword">void</span> <span class="code-function">begin</span>();                          <span class="code-comment">// Initialisation</span>
    <span class="code-keyword">void</span> <span class="code-function">on</span>();                             <span class="code-comment">// Allume la LED</span>
    <span class="code-keyword">void</span> <span class="code-function">off</span>();                            <span class="code-comment">// Éteint la LED</span>
    <span class="code-keyword">void</span> <span class="code-function">toggle</span>();                         <span class="code-comment">// Inverse l'état</span>
    <span class="code-keyword">void</span> <span class="code-function">blink</span>(<span class="code-keyword">int</span> delayTime);               <span class="code-comment">// Fait clignoter</span>
    <span class="code-keyword">void</span> <span class="code-function">setBrightness</span>(<span class="code-keyword">int</span> brightness);      <span class="code-comment">// PWM (0-255)</span>
    <span class="code-keyword">bool</span> <span class="code-function">isOn</span>();                           <span class="code-comment">// Retourne l'état</span>
    
  <span class="code-keyword">private</span>:
    <span class="code-comment">// Variables membres privées</span>
    <span class="code-keyword">int</span> _pin;                               <span class="code-comment">// Broche de la LED</span>
    <span class="code-keyword">bool</span> _state;                            <span class="code-comment">// État courant</span>
    <span class="code-keyword">bool</span> _isPWM;                            <span class="code-comment">// Si la broche supporte PWM</span>
    <span class="code-keyword">int</span> _brightness;                        <span class="code-comment">// Luminosité (0-255)</span>
    
    <span class="code-comment">// Méthode privée</span>
    <span class="code-keyword">void</span> <span class="code-function">_updateLED</span>();                     <span class="code-comment">// Met à jour la LED</span>
};

<span class="code-keyword">#endif</span></code></pre>
        </div>

        <div class="code-example">
          <h4>Fichier LEDController.cpp (implémentation)</h4>
          <pre><code><span class="code-comment">/*
  LEDController.cpp - Implémentation de la bibliothèque LEDController
*/</span>

<span class="code-keyword">#include</span> <span class="code-string">"Arduino.h"</span>
<span class="code-keyword">#include</span> <span class="code-string">"LEDController.h"</span>

<span class="code-comment">// Liste des broches PWM sur Arduino Uno</span>
<span class="code-keyword">const</span> <span class="code-keyword">int</span> pwmPins[] = {3, 5, 6, 9, 10, 11};
<span class="code-keyword">const</span> <span class="code-keyword">int</span> numPwmPins = 6;

<span class="code-comment">// Constructeur simple</span>
LEDController::LEDController(<span class="code-keyword">int</span> pin) {
  _pin = pin;
  _state = <span class="code-keyword">false</span>;
  _brightness = 255;
  _isPWM = <span class="code-keyword">false</span>;
  
  <span class="code-comment">// Vérifie si la broche supporte PWM</span>
  <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < numPwmPins; i++) {
    <span class="code-keyword">if</span> (pin == pwmPins[i]) {
      _isPWM = <span class="code-keyword">true</span>;
      <span class="code-keyword">break</span>;
    }
  }
}

<span class="code-comment">// Constructeur avec état initial</span>
LEDController::LEDController(<span class="code-keyword">int</span> pin, <span class="code-keyword">bool</span> initialState) {
  _pin = pin;
  _state = initialState;
  _brightness = 255;
  _isPWM = <span class="code-keyword">false</span>;
  
  <span class="code-comment">// Vérifie si la broche supporte PWM</span>
  <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < numPwmPins; i++) {
    <span class="code-keyword">if</span> (pin == pwmPins[i]) {
      _isPWM = <span class="code-keyword">true</span>;
      <span class="code-keyword">break</span>;
    }
  }
}

<span class="code-comment">// Initialisation</span>
<span class="code-keyword">void</span> LEDController::<span class="code-function">begin</span>() {
  <span class="code-function">pinMode</span>(_pin, OUTPUT);
  <span class="code-function">_updateLED</span>();
}

<span class="code-comment">// Allume la LED</span>
<span class="code-keyword">void</span> LEDController::<span class="code-function">on</span>() {
  _state = <span class="code-keyword">true</span>;
  <span class="code-function">_updateLED</span>();
}

<span class="code-comment">// Éteint la LED</span>
<span class="code-keyword">void</span> LEDController::<span class="code-function">off</span>() {
  _state = <span class="code-keyword">false</span>;
  <span class="code-function">_updateLED</span>();
}

<span class="code-comment">// Inverse l'état</span>
<span class="code-keyword">void</span> LEDController::<span class="code-function">toggle</span>() {
  _state = !_state;
  <span class="code-function">_updateLED</span>();
}

<span class="code-comment">// Fait clignoter la LED</span>
<span class="code-keyword">void</span> LEDController::<span class="code-function">blink</span>(<span class="code-keyword">int</span> delayTime) {
  <span class="code-function">on</span>();
  <span class="code-function">delay</span>(delayTime);
  <span class="code-function">off</span>();
  <span class="code-function">delay</span>(delayTime);
}

<span class="code-comment">// Définit la luminosité (PWM)</span>
<span class="code-keyword">void</span> LEDController::<span class="code-function">setBrightness</span>(<span class="code-keyword">int</span> brightness) {
  <span class="code-keyword">if</span> (brightness < 0) brightness = 0;
  <span class="code-keyword">if</span> (brightness > 255) brightness = 255;
  _brightness = brightness;
  <span class="code-function">_updateLED</span>();
}

<span class="code-comment">// Retourne l'état de la LED</span>
<span class="code-keyword">bool</span> LEDController::<span class="code-function">isOn</span>() {
  <span class="code-keyword">return</span> _state;
}

<span class="code-comment">// Méthode privée : met à jour la LED</span>
<span class="code-keyword">void</span> LEDController::<span class="code-function">_updateLED</span>() {
  <span class="code-keyword">if</span> (_state) {
    <span class="code-keyword">if</span> (_isPWM) {
      <span class="code-function">analogWrite</span>(_pin, _brightness);
    } <span class="code-keyword">else</span> {
      <span class="code-function">digitalWrite</span>(_pin, HIGH);
    }
  } <span class="code-keyword">else</span> {
    <span class="code-function">digitalWrite</span>(_pin, LOW);
  }
}</code></pre>
        </div>

        <div class="code-example">
          <h4>Exemple d'utilisation de la bibliothèque</h4>
          <pre><code><span class="code-comment">/*
  Test de la bibliothèque LEDController
*/</span>

<span class="code-keyword">#include</span> <span class="code-string">"LEDController.h"</span>

<span class="code-comment">// Création d'objets LEDController</span>
LEDController led1(13);          <span class="code-comment">// LED sur broche 13 (digital)</span>
LEDController led2(9, <span class="code-keyword">false</span>);   <span class="code-comment">// LED sur broche 9 (PWM), éteinte au départ</span>

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  Serial.<span class="code-function">begin</span>(9600);
  
  <span class="code-comment">// Initialisation des LEDs</span>
  led1.<span class="code-function">begin</span>();
  led2.<span class="code-function">begin</span>();
  
  Serial.<span class="code-function">println</span>(<span class="code-string">"Test bibliothèque LEDController"</span>);
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
  Serial.<span class="code-function">println</span>(<span class="code-string">"LED1: Clignotement simple"</span>);
  led1.<span class="code-function">blink</span>(500);  <span class="code-comment">// Clignote toutes les 500ms</span>
  
  Serial.<span class="code-function">println</span>(<span class="code-string">"LED2: Variation de luminosite"</span>);
  <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i <= 255; i += 5) {
    led2.<span class="code-function">on</span>();
    led2.<span class="code-function">setBrightness</span>(i);
    <span class="code-function">delay</span>(20);
  }
  
  <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 255; i >= 0; i -= 5) {
    led2.<span class="code-function">setBrightness</span>(i);
    <span class="code-function">delay</span>(20);
  }
  
  led2.<span class="code-function">off</span>();
  
  Serial.<span class="code-function">println</span>(<span class="code-string">"Test toggle"</span>);
  <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < 5; i++) {
    led1.<span class="code-function">toggle</span>();
    led2.<span class="code-function">toggle</span>();
    <span class="code-function">delay</span>(200);
  }
  
  <span class="code-comment">// Vérification de l'état</span>
  <span class="code-keyword">if</span> (led1.<span class="code-function">isOn</span>()) {
    Serial.<span class="code-function">println</span>(<span class="code-string">"LED1 est allumee"</span>);
  } <span class="code-keyword">else</span> {
    Serial.<span class="code-function">println</span>(<span class="code-string">"LED1 est eteinte"</span>);
  }
}</code></pre>
        </div>
      </section>

      <!-- =========================================== -->
      <!-- SECTION STRUCTURES DE CONTRÔLE -->
      <!-- =========================================== -->
      <section id="structures-controle">
        <h2>Structures de contrôle en C++/Arduino</h2>
        <p>Les structures de contrôle permettent de diriger l'exécution du code en fonction de conditions ou de répéter
          des blocs de code.</p>

        <h3 id="conditions">Structures conditionnelles</h3>
        <div class="code-example">
          <pre><code><span class="code-comment">/*
  Exemples complets de structures conditionnelles
*/</span>

<span class="code-keyword">const</span> <span class="code-keyword">int</span> CAPTEUR_PIN = A0;
<span class="code-keyword">const</span> <span class="code-keyword">int</span> LED_PIN = 13;
<span class="code-keyword">const</span> <span class="code-keyword">int</span> SEUIL_BAS = 300;
<span class="code-keyword">const</span> <span class="code-keyword">int</span> SEUIL_HAUT = 700;

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  Serial.<span class="code-function">begin</span>(9600);
  <span class="code-function">pinMode</span>(LED_PIN, OUTPUT);
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
  <span class="code-keyword">int</span> valeur = <span class="code-function">analogRead</span>(CAPTEUR_PIN);
  
  <span class="code-comment">// =======================</span>
  <span class="code-comment">// 1. Structure if simple</span>
  <span class="code-comment">// =======================</span>
  <span class="code-keyword">if</span> (valeur > SEUIL_HAUT) {
    <span class="code-function">digitalWrite</span>(LED_PIN, HIGH);
    Serial.<span class="code-function">println</span>(<span class="code-string">"LED allumee (valeur haute)"</span>);
  }
  
  <span class="code-comment">// ==========================</span>
  <span class="code-comment">// 2. Structure if-else</span>
  <span class="code-comment">// ==========================</span>
  <span class="code-keyword">if</span> (valeur > 500) {
    Serial.<span class="code-function">println</span>(<span class="code-string">"Valeur superieure a 500"</span>);
  } <span class="code-keyword">else</span> {
    Serial.<span class="code-function">println</span>(<span class="code-string">"Valeur inferieure ou egale a 500"</span>);
  }
  
  <span class="code-comment">// ==============================</span>
  <span class="code-comment">// 3. Structure if-else if-else</span>
  <span class="code-comment">// ==============================</span>
  <span class="code-keyword">if</span> (valeur < SEUIL_BAS) {
    Serial.<span class="code-function">println</span>(<span class="code-string">"Niveau BAS"</span>);
    <span class="code-function">digitalWrite</span>(LED_PIN, LOW);
  } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (valeur >= SEUIL_BAS && valeur <= SEUIL_HAUT) {
    Serial.<span class="code-function">println</span>(<span class="code-string">"Niveau MOYEN"</span>);
    <span class="code-function">digitalWrite</span>(LED_PIN, HIGH);
    <span class="code-function">delay</span>(100);
    <span class="code-function">digitalWrite</span>(LED_PIN, LOW);
    <span class="code-function">delay</span>(100);
  } <span class="code-keyword">else</span> {
    Serial.<span class="code-function">println</span>(<span class="code-string">"Niveau HAUT"</span>);
    <span class="code-function">digitalWrite</span>(LED_PIN, HIGH);
  }
  
  <span class="code-comment">// ==============================</span>
  <span class="code-comment">// 4. Opérateur ternaire</span>
  <span class="code-comment">// ==============================</span>
  <span class="code-type">String</span> etat = (valeur > 500) ? <span class="code-string">"HAUT"</span> : <span class="code-string">"BAS"</span>;
  Serial.<span class="code-function">print</span>(<span class="code-string">"Etat (ternaire): "</span>);
  Serial.<span class="code-function">println</span>(etat);
  
  <span class="code-comment">// Condition complexe avec opérateurs logiques</span>
  <span class="code-keyword">bool</span> condition1 = (valeur > 200);
  <span class="code-keyword">bool</span> condition2 = (valeur < 800);
  
  <span class="code-keyword">if</span> (condition1 && condition2) {          <span class="code-comment">// ET logique</span>
    Serial.<span class="code-function">println</span>(<span class="code-string">"Valeur entre 200 et 800"</span>);
  }
  
  <span class="code-keyword">if</span> (valeur < 100 || valeur > 900) {     <span class="code-comment">// OU logique</span>
    Serial.<span class="code-function">println</span>(<span class="code-string">"Valeur extreme!"</span>);
  }
  
  <span class="code-keyword">if</span> (!(valeur < 0)) {                    <span class="code-comment">// NON logique</span>
    Serial.<span class="code-function">println</span>(<span class="code-string">"Valeur positive"</span>);
  }
  
  <span class="code-function">delay</span>(1000);
}</code></pre>
        </div>

        <h3 id="switch-case">Structure switch-case</h3>
        <div class="code-example">
          <pre><code><span class="code-comment">/*
  Exemple de switch-case pour un menu de commandes
*/</span>

<span class="code-keyword">char</span> commande;
<span class="code-keyword">int</span> ledPin = 13;

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  Serial.<span class="code-function">begin</span>(9600);
  <span class="code-function">pinMode</span>(ledPin, OUTPUT);
  
  Serial.<span class="code-function">println</span>(<span class="code-string">"Systeme de commandes LED"</span>);
  Serial.<span class="code-function">println</span>(<span class="code-string">"Commandes disponibles:"</span>);
  Serial.<span class="code-function">println</span>(<span class="code-string">"  a - Allumer LED"</span>);
  Serial.<span class="code-function">println</span>(<span class="code-string">"  e - Eteindre LED"</span>);
  Serial.<span class="code-function">println</span>(<span class="code-string">"  c - Clignoter LED"</span>);
  Serial.<span class="code-function">println</span>(<span class="code-string">"  s - SOS"</span>);
  Serial.<span class="code-function">println</span>(<span class="code-string">"  q - Quitter"</span>);
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
  <span class="code-keyword">if</span> (Serial.<span class="code-function">available</span>()) {
    commande = Serial.<span class="code-function">read</span>();
    
    <span class="code-comment">// Structure switch-case pour traiter la commande</span>
    <span class="code-keyword">switch</span> (commande) {
      <span class="code-keyword">case</span> <span class="code-string">'a'</span>:
      <span class="code-keyword">case</span> <span class="code-string">'A'</span>:
        Serial.<span class="code-function">println</span>(<span class="code-string">"Commande: Allumer LED"</span>);
        <span class="code-function">digitalWrite</span>(ledPin, HIGH);
        <span class="code-keyword">break</span>;
        
      <span class="code-keyword">case</span> <span class="code-string">'e'</span>:
      <span class="code-keyword">case</span> <span class="code-string">'E'</span>:
        Serial.<span class="code-function">println</span>(<span class="code-string">"Commande: Eteindre LED"</span>);
        <span class="code-function">digitalWrite</span>(ledPin, LOW);
        <span class="code-keyword">break</span>;
        
      <span class="code-keyword">case</span> <span class="code-string">'c'</span>:
      <span class="code-keyword">case</span> <span class="code-string">'C'</span>:
        Serial.<span class="code-function">println</span>(<span class="code-string">"Commande: Clignoter LED"</span>);
        <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < 5; i++) {
          <span class="code-function">digitalWrite</span>(ledPin, HIGH);
          <span class="code-function">delay</span>(200);
          <span class="code-function">digitalWrite</span>(ledPin, LOW);
          <span class="code-function">delay</span>(200);
        }
        <span class="code-keyword">break</span>;
        
      <span class="code-keyword">case</span> <span class="code-string">'s'</span>:
      <span class="code-keyword">case</span> <span class="code-string">'S'</span>:
        Serial.<span class="code-function">println</span>(<span class="code-string">"Commande: SOS"</span>);
        <span class="code-function">sosSignal</span>();
        <span class="code-keyword">break</span>;
        
      <span class="code-keyword">case</span> <span class="code-string">'q'</span>:
      <span class="code-keyword">case</span> <span class="code-string">'Q'</span>:
        Serial.<span class="code-function">println</span>(<span class="code-string">"Fin du programme"</span>);
        <span class="code-keyword">while</span> (1) { <span class="code-comment">// Boucle infinie pour arrêter</span>
          <span class="code-function">delay</span>(1000);
        }
        <span class="code-keyword">break</span>;
        
      <span class="code-keyword">case</span> <span class="code-string">'\n'</span>:
      <span class="code-keyword">case</span> <span class="code-string">'\r'</span>:
        <span class="code-comment">// Ignorer les caractères de nouvelle ligne</span>
        <span class="code-keyword">break</span>;
        
      <span class="code-keyword">default</span>:
        Serial.<span class="code-function">println</span>(<span class="code-string">"Commande inconnue"</span>);
        Serial.<span class="code-function">println</span>(<span class="code-string">"Tapez 'h' pour l'aide"</span>);
        <span class="code-keyword">break</span>;
    }
  }
}

<span class="code-keyword">void</span> <span class="code-function">sosSignal</span>() {
  <span class="code-comment">// S (3 courts)</span>
  <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < 3; i++) {
    <span class="code-function">digitalWrite</span>(ledPin, HIGH);
    <span class="code-function">delay</span>(200);
    <span class="code-function">digitalWrite</span>(ledPin, LOW);
    <span class="code-function">delay</span>(200);
  }
  
  <span class="code-comment">// O (3 longs)</span>
  <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < 3; i++) {
    <span class="code-function">digitalWrite</span>(ledPin, HIGH);
    <span class="code-function">delay</span>(600);
    <span class="code-function">digitalWrite</span>(ledPin, LOW);
    <span class="code-function">delay</span>(200);
  }
  
  <span class="code-comment">// S (3 courts)</span>
  <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < 3; i++) {
    <span class="code-function">digitalWrite</span>(ledPin, HIGH);
    <span class="code-function">delay</span>(200);
    <span class="code-function">digitalWrite</span>(ledPin, LOW);
    <span class="code-function">delay</span>(200);
  }
  
  <span class="code-function">delay</span>(1000);
}</code></pre>
        </div>

        <h3 id="boucles">Boucles de répétition</h3>
        <div class="code-example">
          <pre><code><span class="code-comment">/*
  Exemples complets de boucles
*/</span>

<span class="code-keyword">const</span> <span class="code-keyword">int</span> LED_PIN = 13;

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  Serial.<span class="code-function">begin</span>(9600);
  <span class="code-function">pinMode</span>(LED_PIN, OUTPUT);
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
  Serial.<span class="code-function">println</span>(<span class="code-string">"=== Demonstration des boucles ==="</span>);
  
  <span class="code-comment">// ==============================</span>
  <span class="code-comment">// 1. Boucle for classique</span>
  <span class="code-comment">// ==============================</span>
  Serial.<span class="code-function">println</span>(<span class="code-string">"Boucle for:"</span>);
  <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < 5; i++) {
    Serial.<span class="code-function">print</span>(<span class="code-string">"Iteration "</span>);
    Serial.<span class="code-function">println</span>(i);
    <span class="code-function">digitalWrite</span>(LED_PIN, HIGH);
    <span class="code-function">delay</span>(100);
    <span class="code-function">digitalWrite</span>(LED_PIN, LOW);
    <span class="code-function">delay</span>(100);
  }
  
  <span class="code-comment">// Boucle for avec pas de 2</span>
  <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i <= 10; i += 2) {
    Serial.<span class="code-function">print</span>(<span class="code-string">"i = "</span>);
    Serial.<span class="code-function">println</span>(i);
  }
  
  <span class="code-comment">// Boucle for décroissante</span>
  <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 10; i > 0; i--) {
    Serial.<span class="code-function">print</span>(<span class="code-string">"Decount: "</span>);
    Serial.<span class="code-function">println</span>(i);
    <span class="code-function">delay</span>(200);
  }
  
  <span class="code-comment">// ==============================</span>
  <span class="code-comment">// 2. Boucle while</span>
  <span class="code-comment">// ==============================</span>
  Serial.<span class="code-function">println</span>(<span class="code-string">"Boucle while:"</span>);
  <span class="code-keyword">int</span> compteur = 0;
  <span class="code-keyword">while</span> (compteur < 3) {
    Serial.<span class="code-function">print</span>(<span class="code-string">"Compteur = "</span>);
    Serial.<span class="code-function">println</span>(compteur);
    <span class="code-function">digitalWrite</span>(LED_PIN, HIGH);
    <span class="code-function">delay</span>(300);
    <span class="code-function">digitalWrite</span>(LED_PIN, LOW);
    <span class="code-function">delay</span>(300);
    compteur++;
  }
  
  <span class="code-comment">// ==============================</span>
  <span class="code-comment">// 3. Boucle do-while</span>
  <span class="code-comment">// ==============================</span>
  Serial.<span class="code-function">println</span>(<span class="code-string">"Boucle do-while:"</span>);
  compteur = 0;
  <span class="code-keyword">do</span> {
    Serial.<span class="code-function">print</span>(<span class="code-string">"Compteur do-while = "</span>);
    Serial.<span class="code-function">println</span>(compteur);
    compteur++;
  } <span class="code-keyword">while</span> (compteur < 3);
  
  <span class="code-comment">// La différence avec while : do-while s'exécute au moins une fois</span>
  compteur = 10;
  <span class="code-keyword">do</span> {
    Serial.<span class="code-function">println</span>(<span class="code-string">"Ce message s'affiche malgre compteur = 10"</span>);
  } <span class="code-keyword">while</span> (compteur < 3);
  
  <span class="code-comment">// ==============================</span>
  <span class="code-comment">// 4. Boucles imbriquées</span>
  <span class="code-comment">// ==============================</span>
  Serial.<span class="code-function">println</span>(<span class="code-string">"Boucles imbriquees:"</span>);
  <span class="code-keyword">for</span> (<span class="code-keyword">int</span> ligne = 1; ligne <= 3; ligne++) {
    <span class="code-keyword">for</span> (<span class="code-keyword">int</span> colonne = 1; colonne <= 3; colonne++) {
      Serial.<span class="code-function">print</span>(<span class="code-string">"("</span>);
      Serial.<span class="code-function">print</span>(ligne);
      Serial.<span class="code-function">print</span>(<span class="code-string">","</span>);
      Serial.<span class="code-function">print</span>(colonne);
      Serial.<span class="code-function">print</span>(<span class="code-string">") "</span>);
    }
    Serial.<span class="code-function">println</span>();
  }
  
  <span class="code-comment">// ==============================</span>
  <span class="code-comment">// 5. Instructions de contrôle</span>
  <span class="code-comment">// ==============================</span>
  Serial.<span class="code-function">println</span>(<span class="code-string">"Instructions break et continue:"</span>);
  
  <span class="code-comment">// break : sort de la boucle</span>
  <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < 10; i++) {
    <span class="code-keyword">if</span> (i == 5) {
      Serial.<span class="code-function">println</span>(<span class="code-string">"Break a i = 5"</span>);
      <span class="code-keyword">break</span>;  <span class="code-comment">// Sort de la boucle</span>
    }
    Serial.<span class="code-function">print</span>(i);
    Serial.<span class="code-function">print</span>(<span class="code-string">" "</span>);
  }
  Serial.<span class="code-function">println</span>();
  
  <span class="code-comment">// continue : passe à l'itération suivante</span>
  <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < 10; i++) {
    <span class="code-keyword">if</span> (i % 2 == 0) {
      <span class="code-keyword">continue</span>;  <span class="code-comment">// Passe les nombres pairs</span>
    }
    Serial.<span class="code-function">print</span>(i);
    Serial.<span class="code-function">print</span>(<span class="code-string">" "</span>);
  }
  Serial.<span class="code-function">println</span>();
  
  <span class="code-function">delay</span>(3000);
}</code></pre>
        </div>
      </section>

      <!-- =========================================== -->
      <!-- SECTION COMMUNICATION ESP -->
      <!-- =========================================== -->
      <section id="communication">
        <h2>Communication avec ESP32/ESP8266</h2>
        <p>Les modules ESP ajoutent des capacités WiFi et Bluetooth aux projets Arduino.</p>

        <h3 id="wifi">Connexion WiFi (ESP32/ESP8266)</h3>
        <div class="code-example">
          <pre><code><span class="code-comment">/*
  Connexion WiFi avec ESP32
  Nécessite la bibliothèque WiFi.h
*/</span>

<span class="code-keyword">#include</span> &lt;WiFi.h&gt;      <span class="code-comment">// Pour ESP32</span>
<span class="code-comment">// #include &lt;ESP8266WiFi.h&gt; // Pour ESP8266</span>

<span class="code-comment">// Identifiants WiFi</span>
<span class="code-keyword">const</span> <span class="code-type">char</span>* ssid = <span class="code-string">"Votre_SSID"</span>;
<span class="code-keyword">const</span> <span class="code-type">char</span>* password = <span class="code-string">"Votre_Mot_De_Passe"</span>;

<span class="code-comment">// Serveur web sur le port 80</span>
WiFiServer server(80);

<span class="code-comment">// Variable pour stocker la requête HTTP</span>
<span class="code-type">String</span> header;

<span class="code-comment">// Variables pour contrôler la LED</span>
<span class="code-keyword">const</span> <span class="code-keyword">int</span> ledPin = 2;  <span class="code-comment">// LED intégrée de l'ESP32</span>
<span class="code-keyword">bool</span> ledState = <span class="code-keyword">false</span>;

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  Serial.<span class="code-function">begin</span>(115200);
  
  <span class="code-comment">// Configuration de la LED</span>
  <span class="code-function">pinMode</span>(ledPin, OUTPUT);
  <span class="code-function">digitalWrite</span>(ledPin, LOW);
  
  <span class="code-comment">// Connexion au WiFi</span>
  Serial.<span class="code-function">print</span>(<span class="code-string">"Connexion au WiFi "</span>);
  Serial.<span class="code-function">println</span>(ssid);
  
  WiFi.<span class="code-function">begin</span>(ssid, password);
  
  <span class="code-keyword">while</span> (WiFi.<span class="code-function">status</span>() != WL_CONNECTED) {
    <span class="code-function">delay</span>(500);
    Serial.<span class="code-function">print</span>(<span class="code-string">"."</span>);
  }
  
  <span class="code-comment">// Connexion réussie</span>
  Serial.<span class="code-function">println</span>(<span class="code-string">""</span>);
  Serial.<span class="code-function">println</span>(<span class="code-string">"WiFi connecte!"</span>);
  Serial.<span class="code-function">print</span>(<span class="code-string">"Adresse IP: "</span>);
  Serial.<span class="code-function">println</span>(WiFi.<span class="code-function">localIP</span>());
  
  <span class="code-comment">// Démarrage du serveur web</span>
  server.<span class="code-function">begin</span>();
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
  WiFiClient client = server.<span class="code-function">available</span>();
  
  <span class="code-keyword">if</span> (client) {
    Serial.<span class="code-function">println</span>(<span class="code-string">"Nouveau client"</span>);
    <span class="code-type">String</span> currentLine = <span class="code-string">""</span>;
    
    <span class="code-keyword">while</span> (client.<span class="code-function">connected</span>()) {
      <span class="code-keyword">if</span> (client.<span class="code-function">available</span>()) {
        <span class="code-type">char</span> c = client.<span class="code-function">read</span>();
        Serial.<span class="code-function">write</span>(c);
        header += c;
        
        <span class="code-keyword">if</span> (c == <span class="code-string">'\n'</span>) {
          <span class="code-keyword">if</span> (currentLine.<span class="code-function">length</span>() == 0) {
            <span class="code-comment">// Envoi de la réponse HTTP</span>
            client.<span class="code-function">println</span>(<span class="code-string">"HTTP/1.1 200 OK"</span>);
            client.<span class="code-function">println</span>(<span class="code-string">"Content-type:text/html"</span>);
            client.<span class="code-function">println</span>(<span class="code-string">"Connection: close"</span>);
            client.<span class="code-function">println</span>();
            
            <span class="code-comment">// Page web HTML</span>
            client.<span class="code-function">println</span>(<span class="code-string">"&lt;!DOCTYPE html&gt;&lt;html&gt;"</span>);
            client.<span class="code-function">println</span>(<span class="code-string">"&lt;head&gt;&lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"&gt;"</span>);
            client.<span class="code-function">println</span>(<span class="code-string">"&lt;title&gt;Controle LED ESP32&lt;/title&gt;"</span>);
            client.<span class="code-function">println</span>(<span class="code-string">"&lt;style&gt;body { font-family: Arial; text-align: center; }"</span>);
            client.<span class="code-function">println</span>(<span class="code-string">".button { background-color: #4CAF50; border: none; color: white;"</span>);
            client.<span class="code-function">println</span>(<span class="code-string">"padding: 16px 40px; text-decoration: none; font-size: 30px; margin: 2px; cursor: pointer; }"</span>);
            client.<span class="code-function">println</span>(<span class="code-string">".button2 { background-color: #f44336; }&lt;/style&gt;&lt;/head&gt;"</span>);
            client.<span class="code-function">println</span>(<span class="code-string">"&lt;body&gt;&lt;h1&gt;Controle LED ESP32&lt;/h1&gt;"</span>);
            
            <span class="code-keyword">if</span> (ledState) {
              client.<span class="code-function">println</span>(<span class="code-string">"&lt;p&gt;Etat LED: ALLUMEE&lt;/p&gt;"</span>);
              client.<span class="code-function">println</span>(<span class="code-string">"&lt;p&gt;&lt;a href=\"/off\"&gt;&lt;button class=\"button button2\"&gt;ETEINDRE&lt;/button&gt;&lt;/a&gt;&lt;/p&gt;"</span>);
            } <span class="code-keyword">else</span> {
              client.<span class="code-function">println</span>(<span class="code-string">"&lt;p&gt;Etat LED: ETEINTE&lt;/p&gt;"</span>);
              client.<span class="code-function">println</span>(<span class="code-string">"&lt;p&gt;&lt;a href=\"/on\"&gt;&lt;button class=\"button\"&gt;ALLUMER&lt;/button&gt;&lt;/a&gt;&lt;/p&gt;"</span>);
            }
            
            client.<span class="code-function">println</span>(<span class="code-string">"&lt;/body&gt;&lt;/html&gt;"</span>);
            client.<span class="code-function">println</span>();
            
            <span class="code-keyword">break</span>;
          } <span class="code-keyword">else</span> {
            currentLine = <span class="code-string">""</span>;
          }
        } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (c != <span class="code-string">'\r'</span>) {
          currentLine += c;
        }
        
        <span class="code-comment">// Traitement des requêtes</span>
        <span class="code-keyword">if</span> (currentLine.<span class="code-function">endsWith</span>(<span class="code-string">"GET /on"</span>)) {
          Serial.<span class="code-function">println</span>(<span class="code-string">"Commande: ALLUMER LED"</span>);
          ledState = <span class="code-keyword">true</span>;
          <span class="code-function">digitalWrite</span>(ledPin, HIGH);
        } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (currentLine.<span class="code-function">endsWith</span>(<span class="code-string">"GET /off"</span>)) {
          Serial.<span class="code-function">println</span>(<span class="code-string">"Commande: ETEINDRE LED"</span>);
          ledState = <span class="code-keyword">false</span>;
          <span class="code-function">digitalWrite</span>(ledPin, LOW);
        }
      }
    }
    
    <span class="code-comment">// Nettoyage</span>
    header = <span class="code-string">""</span>;
    client.<span class="code-function">stop</span>();
    Serial.<span class="code-function">println</span>(<span class="code-string">"Client deconnecte"</span>);
    Serial.<span class="code-function">println</span>(<span class="code-string">""</span>);
  }
}</code></pre>
        </div>

        <h3 id="mqtt">Communication MQTT (Internet des Objets)</h3>
        <div class="info-box">
          <h4>Explication du Code MQTT ESP</h4>
          <p>Ce code implémente un <strong>client MQTT complet</strong> sur ESP32/ESP8266 pour l'Internet des Objets (IoT).</p>
          
          <h5>Qu'est-ce que MQTT ?</h5>
          <p><strong>MQTT (Message Queuing Telemetry Transport)</strong> est un protocole de messagerie léger conçu pour les appareils IoT. Il fonctionne sur le modèle <strong>publish/subscribe</strong> :</p>
          <ul>
              <li><strong>Broker</strong> : Serveur central qui gère les messages (ex: broker.hivemq.com)</li>
              <li><strong>Publisher</strong> : Envoie des messages sur des "topics"</li>
              <li><strong>Subscriber</strong> : Reçoit des messages des topics auxquels il est abonné</li>
          </ul>
          
          <h5>Architecture du code :</h5>
          <ol>
              <li><strong>Connexion WiFi</strong> : L'ESP se connecte d'abord au réseau</li>
              <li><strong>Connexion MQTT</strong> : Établit une connexion avec le broker MQTT public</li>
              <li><strong>Abonnement</strong> : S'abonne aux topics pour recevoir des commandes</li>
              <li><strong>Publication</strong> : Envoie périodiquement des données (température)</li>
              <li><strong>Callback</strong> : Traite les messages reçus via une fonction callback</li>
          </ol>
          
          <h5>Topics utilisés :</h5>
          <ul>
              <li><code>maison/salon/temperature</code> → Publication des données de température</li>
              <li><code>maison/salon/led/commande</code> → Réception des commandes pour la LED</li>
              <li><code>maison/salon/led/etat</code> → Publication de l'état de la LED</li>
          </ul>
          
          <h5>Fonctionnement en détail :</h5>
          
          <div class="code-example" style="margin: 1rem 0; padding: 1rem;">
              <h6>1. Setup MQTT</h6>
              <pre style="margin: 0; font-size: 0.9rem;">client.setServer(mqtt_server, mqtt_port);
      client.setCallback(callback);</pre>
              <p style="margin-top: 0.5rem;">Configure le broker et la fonction de callback pour traiter les messages reçus.</p>
          </div>
          
          <div class="code-example" style="margin: 1rem 0; padding: 1rem;">
              <h6>2. Fonction Callback</h6>
              <pre style="margin: 0; font-size: 0.9rem;">void callback(char* topic, byte* payload, unsigned int length) {
        // Traite les messages reçus
      }</pre>
              <p style="margin-top: 0.5rem;">Appelée automatiquement quand un message arrive sur un topic auquel on est abonné.</p>
          </div>
          
          <div class="code-example" style="margin: 1rem 0; padding: 1rem;">
              <h6>3. Publication de données</h6>
              <pre style="margin: 0; font-size: 0.9rem;">client.publish(topic_temperature, tempString);</pre>
              <p style="margin-top: 0.5rem;">Envoie les données de température toutes les 5 secondes.</p>
          </div>
          
          <div class="code-example" style="margin: 1rem 0; padding: 1rem;">
              <h6>4. Abonnement aux topics</h6>
              <pre style="margin: 0; font-size: 0.9rem;">client.subscribe(topic_led);</pre>
              <p style="margin-top: 0.5rem;">S'abonne au topic des commandes LED pour pouvoir les recevoir.</p>
          </div>
          
          <h5>Avantages de MQTT pour l'IoT :</h5>
          <ul>
              <li><strong>Léger</strong> : Peu de consommation de mémoire et bande passante</li>
              <li><strong>Asynchrone</strong> : Les appareils peuvent publier/s'abonner indépendamment</li>
              <li><strong>Scalable</strong> : Supporte des milliers de clients connectés</li>
              <li><strong>Fiabilité</strong> : Niveaux de qualité de service (QoS) garantissant la livraison</li>
              <li><strong>Sécurité</strong> : Supporte l'authentification et le chiffrement</li>
          </ul>
          
          <h5>Cas d'usage typiques :</h5>
          <ul>
              <li><strong>Domotique</strong> : Contrôle à distance des appareils</li>
              <li><strong>Monitoring</strong> : Surveillance de capteurs environnementaux</li>
              <li><strong>Télémétrie</strong> : Collecte de données à partir de plusieurs sources</li>
              <li><strong>Notifications</strong> : Alertes et notifications en temps réel</li>
          </ul>
          
          <div class="warning-box">
              <p><strong>Points importants :</strong></p>
              <ul>
                  <li>Le broker MQTT peut être local (Mosquitto) ou cloud (HiveMQ, AWS IoT)</li>
                  <li>Les topics sont hiérarchiques (ex: <code>maison/etage1/salon/temperature</code>)</li>
                  <li>MQTT maintient une connexion persistante avec le broker</li>
                  <li>Parfait pour les connexions intermittentes ou à faible bande passante</li>
              </ul>
          </div>
          
          <p>Avec ce code, l'ESP32 devient un <strong>nœud IoT intelligent</strong> qui peut envoyer des données au cloud et recevoir des commandes à distance, ouvrant la porte à des applications domotiques et industrielles avancées.</p>
      </div>
        <div class="code-example">
          <pre><code><span class="code-comment">/*
  Client MQTT avec ESP32
  Publie la température et reçoit des commandes
  Nécessite la bibliothèque PubSubClient
*/</span>

<span class="code-keyword">#include</span> &lt;WiFi.h&gt;
<span class="code-keyword">#include</span> &lt;PubSubClient.h&gt;

<span class="code-comment">// Configuration WiFi</span>
<span class="code-keyword">const</span> <span class="code-type">char</span>* ssid = <span class="code-string">"Votre_SSID"</span>;
<span class="code-keyword">const</span> <span class="code-type">char</span>* password = <span class="code-string">"Votre_Mot_De_Passe"</span>;

<span class="code-comment">// Configuration MQTT</span>
<span class="code-keyword">const</span> <span class="code-type">char</span>* mqtt_server = <span class="code-string">"broker.hivemq.com"</span>;  <span class="code-comment">// Broker public gratuit</span>
<span class="code-keyword">const</span> <span class="code-keyword">int</span> mqtt_port = 1883;
<span class="code-keyword">const</span> <span class="code-type">char</span>* mqtt_client_id = <span class="code-string">"ESP32_Client_01"</span>;

<span class="code-comment">// Topics MQTT</span>
<span class="code-keyword">const</span> <span class="code-type">char</span>* topic_temperature = <span class="code-string">"maison/salon/temperature"</span>;
<span class="code-keyword">const</span> <span class="code-type">char</span>* topic_led = <span class="code-string">"maison/salon/led/commande"</span>;
<span class="code-keyword">const</span> <span class="code-type">char</span>* topic_led_status = <span class="code-string">"maison/salon/led/etat"</span>;

<span class="code-comment">// Broches</span>
<span class="code-keyword">const</span> <span class="code-keyword">int</span> ledPin = 2;
<span class="code-keyword">const</span> <span class="code-keyword">int</span> sensorPin = 34;  <span class="code-comment">// Broche ADC pour capteur simulé</span>

<span class="code-comment">// Objets</span>
WiFiClient espClient;
PubSubClient client(espClient);

<span class="code-comment">// Variables</span>
<span class="code-keyword">bool</span> ledState = <span class="code-keyword">false</span>;
<span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> lastMsg = 0;

<span class="code-comment">// Connexion WiFi</span>
<span class="code-keyword">void</span> <span class="code-function">setup_wifi</span>() {
  <span class="code-function">delay</span>(10);
  Serial.<span class="code-function">println</span>();
  Serial.<span class="code-function">print</span>(<span class="code-string">"Connexion au WiFi: "</span>);
  Serial.<span class="code-function">println</span>(ssid);
  
  WiFi.<span class="code-function">begin</span>(ssid, password);
  
  <span class="code-keyword">while</span> (WiFi.<span class="code-function">status</span>() != WL_CONNECTED) {
    <span class="code-function">delay</span>(500);
    Serial.<span class="code-function">print</span>(<span class="code-string">"."</span>);
  }
  
  Serial.<span class="code-function">println</span>(<span class="code-string">""</span>);
  Serial.<span class="code-function">println</span>(<span class="code-string">"WiFi connecte"</span>);
  Serial.<span class="code-function">print</span>(<span class="code-string">"Adresse IP: "</span>);
  Serial.<span class="code-function">println</span>(WiFi.<span class="code-function">localIP</span>());
}

<span class="code-comment">// Callback pour les messages MQTT reçus</span>
<span class="code-keyword">void</span> <span class="code-function">callback</span>(<span class="code-type">char</span>* topic, <span class="code-type">byte</span>* payload, <span class="code-keyword">unsigned</span> <span class="code-keyword">int</span> length) {
  Serial.<span class="code-function">print</span>(<span class="code-string">"Message recu sur le topic: "</span>);
  Serial.<span class="code-function">println</span>(topic);
  
  <span class="code-comment">// Conversion du payload en String</span>
  <span class="code-type">String</span> message;
  <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < length; i++) {
    message += (<span class="code-type">char</span>)payload[i];
  }
  Serial.<span class="code-function">print</span>(<span class="code-string">"Message: "</span>);
  Serial.<span class="code-function">println</span>(message);
  
  <span class="code-comment">// Traitement selon le topic</span>
  <span class="code-keyword">if</span> (<span class="code-function">strcmp</span>(topic, topic_led) == 0) {
    <span class="code-keyword">if</span> (message == <span class="code-string">"ON"</span>) {
      ledState = <span class="code-keyword">true</span>;
      <span class="code-function">digitalWrite</span>(ledPin, HIGH);
      client.<span class="code-function">publish</span>(topic_led_status, <span class="code-string">"LED ON"</span>);
      Serial.<span class="code-function">println</span>(<span class="code-string">"LED allumee"</span>);
    } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (message == <span class="code-string">"OFF"</span>) {
      ledState = <span class="code-keyword">false</span>;
      <span class="code-function">digitalWrite</span>(ledPin, LOW);
      client.<span class="code-function">publish</span>(topic_led_status, <span class="code-string">"LED OFF"</span>);
      Serial.<span class="code-function">println</span>(<span class="code-string">"LED eteinte"</span>);
    }
  }
}

<span class="code-comment">// Reconnexion MQTT</span>
<span class="code-keyword">void</span> <span class="code-function">reconnect</span>() {
  <span class="code-keyword">while</span> (!client.<span class="code-function">connected</span>()) {
    Serial.<span class="code-function">print</span>(<span class="code-string">"Connexion au broker MQTT..."</span>);
    
    <span class="code-keyword">if</span> (client.<span class="code-function">connect</span>(mqtt_client_id)) {
      Serial.<span class="code-function">println</span>(<span class="code-string">"connecte"</span>);
      
      <span class="code-comment">// Abonnement aux topics</span>
      client.<span class="code-function">subscribe</span>(topic_led);
      Serial.<span class="code-function">print</span>(<span class="code-string">"Abonne au topic: "</span>);
      Serial.<span class="code-function">println</span>(topic_led);
      
      <span class="code-comment">// Publication d'un message de connexion</span>
      client.<span class="code-function">publish</span>(topic_led_status, <span class="code-string">"ESP32 connecte"</span>);
    } <span class="code-keyword">else</span> {
      Serial.<span class="code-function">print</span>(<span class="code-string">"echec, rc="</span>);
      Serial.<span class="code-function">print</span>(client.<span class="code-function">state</span>());
      Serial.<span class="code-function">println</span>(<span class="code-string">" nouvel essai dans 5 secondes"</span>);
      <span class="code-function">delay</span>(5000);
    }
  }
}

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  Serial.<span class="code-function">begin</span>(115200);
  
  <span class="code-comment">// Configuration des broches</span>
  <span class="code-function">pinMode</span>(ledPin, OUTPUT);
  <span class="code-function">digitalWrite</span>(ledPin, LOW);
  
  <span class="code-comment">// Connexion WiFi</span>
  <span class="code-function">setup_wifi</span>();
  
  <span class="code-comment">// Configuration MQTT</span>
  client.<span class="code-function">setServer</span>(mqtt_server, mqtt_port);
  client.<span class="code-function">setCallback</span>(callback);
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
  <span class="code-keyword">if</span> (!client.<span class="code-function">connected</span>()) {
    <span class="code-function">reconnect</span>();
  }
  client.<span class="code-function">loop</span>();
  
  <span class="code-comment">// Publication périodique de la température (simulée)</span>
  <span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> now = <span class="code-function">millis</span>();
  <span class="code-keyword">if</span> (now - lastMsg > 5000) {
    lastMsg = now;
    
    <span class="code-comment">// Lecture de la température simulée (20-30°C)</span>
    <span class="code-keyword">int</span> sensorValue = <span class="code-function">analogRead</span>(sensorPin);
    <span class="code-keyword">float</span> temperature = 20.0 + (sensorValue / 4095.0) * 10.0;
    
    <span class="code-comment">// Conversion en String</span>
    <span class="code-type">char</span> tempString[8];
    <span class="code-function">dtostrf</span>(temperature, 1, 2, tempString);
    
    <span class="code-comment">// Publication</span>
    Serial.<span class="code-function">print</span>(<span class="code-string">"Temperature: "</span>);
    Serial.<span class="code-function">print</span>(tempString);
    Serial.<span class="code-function">println</span>(<span class="code-string">"°C"</span>);
    
    client.<span class="code-function">publish</span>(topic_temperature, tempString);
  }
}</code></pre>
        </div>
        <!-- Bluetooth (ESP32) -->
        <section id="bluetooth">
          <h3>Communication Bluetooth avec ESP32</h3>
          <p>L'ESP32 dispose d'un module Bluetooth classique et Bluetooth Low Energy (BLE) intégré, permettant des
            communications sans fil à courte portée.</p>

          <div class="info-box">
            <p><strong>Note :</strong> Le Bluetooth est disponible seulement sur ESP32, pas sur ESP8266. L'ESP32
              supporte à la fois Bluetooth classique (SPP) et Bluetooth Low Energy (BLE).</p>
          </div>

          <h4>Bluetooth Série (Classique) - Similaire au Bluetooth HC-05</h4>
          <div class="code-example">
            <h5>Exemple : Communication Bluetooth série ESP32 vers smartphone</h5>
            <pre><code><span class="code-comment">/*
Communication Bluetooth série avec ESP32
Crée un port série virtuel Bluetooth
Compatible avec les apps Serial Bluetooth Terminal
*/</span>

<span class="code-keyword">#include</span> "BluetoothSerial.h"

<span class="code-comment">// Vérifie si le Bluetooth est disponible</span>
<span class="code-keyword">#if</span> !defined(CONFIG_BT_ENABLED) || !defined(CONFIG_BLUEDROID_ENABLED)
<span class="code-keyword">#error</span> Bluetooth n'est pas disponible! Activez-le dans l'IDE
<span class="code-keyword">#endif</span>

<span class="code-comment">// Objet Bluetooth</span>
BluetoothSerial SerialBT;

<span class="code-comment">// Broches</span>
<span class="code-keyword">const</span> <span class="code-keyword">int</span> LED_PIN = 2;  <span class="code-comment">// LED intégrée ESP32</span>

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
Serial.<span class="code-function">begin</span>(115200);

<span class="code-comment">// Configuration de la LED</span>
<span class="code-function">pinMode</span>(LED_PIN, OUTPUT);
<span class="code-function">digitalWrite</span>(LED_PIN, LOW);

<span class="code-comment">// Démarrage du Bluetooth</span>
<span class="code-type">String</span> nomBluetooth = <span class="code-string">"ESP32_Controller"</span>;
SerialBT.<span class="code-function">begin</span>(nomBluetooth);  <span class="code-comment">// Nom du périphérique Bluetooth</span>

Serial.<span class="code-function">println</span>(<span class="code-string">"Bluetooth demarre!"</span>);
Serial.<span class="code-function">print</span>(<span class="code-string">"Nom du peripherique: "</span>);
Serial.<span class="code-function">println</span>(nomBluetooth);
Serial.<span class="code-function">println</span>(<span class="code-string">"Connectez-vous via Bluetooth et envoyez des commandes:"</span>);
Serial.<span class="code-function">println</span>(<span class="code-string">"  '1' - Allumer LED"</span>);
Serial.<span class="code-function">println</span>(<span class="code-string">"  '0' - Eteindre LED"</span>);
Serial.<span class="code-function">println</span>(<span class="code-string">"  's' - Etat du systeme"</span>);
Serial.<span class="code-function">println</span>(<span class="code-string">"  '?' - Aide"</span>);
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
<span class="code-comment">// Lecture des données Bluetooth</span>
<span class="code-keyword">if</span> (SerialBT.<span class="code-function">available</span>()) {
  <span class="code-type">char</span> commande = SerialBT.<span class="code-function">read</span>();
  <span class="code-function">traiterCommande</span>(commande);
}

<span class="code-comment">// Lecture des données série USB (pour debug)</span>
<span class="code-keyword">if</span> (Serial.<span class="code-function">available</span>()) {
  <span class="code-type">char</span> commande = Serial.<span class="code-function">read</span>();
  SerialBT.<span class="code-function">write</span>(commande);  <span class="code-comment">// Echo vers Bluetooth</span>
  <span class="code-function">traiterCommande</span>(commande);
}

<span class="code-comment">// Envoi périodique de données (toutes les 5 secondes)</span>
<span class="code-keyword">static</span> <span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> dernierEnvoi = 0;
<span class="code-keyword">if</span> (<span class="code-function">millis</span>() - dernierEnvoi > 5000) {
  dernierEnvoi = <span class="code-function">millis</span>();
  
  <span class="code-comment">// Envoi de données de télémétrie</span>
  <span class="code-keyword">float</span> temperature = <span class="code-function">lireTemperatureSimulee</span>();
  <span class="code-keyword">int</span> valeurAnalogique = <span class="code-function">analogRead</span>(34);  <span class="code-comment">// GPIO34 (entrée seulement)</span>
  
  <span class="code-type">String</span> telemetrie = <span class="code-string">"Telemetrie: Temp="</span> + <span class="code-type">String</span>(temperature, 1) + 
                     <span class="code-string">"C, ADC="</span> + <span class="code-type">String</span>(valeurAnalogique);
  
  SerialBT.<span class="code-function">println</span>(telemetrie);
  Serial.<span class="code-function">println</span>(telemetrie);
}

<span class="code-function">delay</span>(20);
}

<span class="code-keyword">void</span> <span class="code-function">traiterCommande</span>(<span class="code-type">char</span> commande) {
<span class="code-keyword">switch</span> (commande) {
  <span class="code-keyword">case</span> <span class="code-string">'1'</span>:
    <span class="code-function">digitalWrite</span>(LED_PIN, HIGH);
    SerialBT.<span class="code-function">println</span>(<span class="code-string">"LED allumee"</span>);
    Serial.<span class="code-function">println</span>(<span class="code-string">"LED allumee via Bluetooth"</span>);
    <span class="code-keyword">break</span>;
    
  <span class="code-keyword">case</span> <span class="code-string">'0'</span>:
    <span class="code-function">digitalWrite</span>(LED_PIN, LOW);
    SerialBT.<span class="code-function">println</span>(<span class="code-string">"LED eteinte"</span>);
    Serial.<span class="code-function">println</span>(<span class="code-string">"LED eteinte via Bluetooth"</span>);
    <span class="code-keyword">break</span>;
    
  <span class="code-keyword">case</span> <span class="code-string">'s'</span>:
    <span class="code-function">envoyerEtatSysteme</span>();
    <span class="code-keyword">break</span>;
    
  <span class="code-keyword">case</span> <span class="code-string">'?'</span>:
    <span class="code-function">envoyerAide</span>();
    <span class="code-keyword">break</span>;
    
  <span class="code-keyword">case</span> <span class="code-string">'b'</span>:
    <span class="code-comment">// Test du bip (clignotement rapide)</span>
    <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = 0; i < 5; i++) {
      <span class="code-function">digitalWrite</span>(LED_PIN, HIGH);
      <span class="code-function">delay</span>(100);
      <span class="code-function">digitalWrite</span>(LED_PIN, LOW);
      <span class="code-function">delay</span>(100);
    }
    SerialBT.<span class="code-function">println</span>(<span class="code-string">"Bip execute"</span>);
    <span class="code-keyword">break</span>;
    
  <span class="code-keyword">default</span>:
    <span class="code-keyword">if</span> (commande != <span class="code-string">'\n'</span> && commande != <span class="code-string">'\r'</span>) {
      SerialBT.<span class="code-function">print</span>(<span class="code-string">"Commande inconnue: '"</span>);
      SerialBT.<span class="code-function">write</span>(commande);
      SerialBT.<span class="code-function">println</span>(<span class="code-string">"'"</span>);
    }
    <span class="code-keyword">break</span>;
}
}

<span class="code-keyword">void</span> <span class="code-function">envoyerEtatSysteme</span>() {
<span class="code-type">String</span> etat = <span class="code-string">"=== Etat du systeme ===\n"</span>;
etat += <span class="code-string">"Uptime: "</span> + <span class="code-type">String</span>(<span class="code-function">millis</span>() / 1000) + <span class="code-string">"s\n"</span>;
etat += <span class="code-string">"LED: "</span> + <span class="code-type">String</span>(<span class="code-function">digitalRead</span>(LED_PIN) ? <span class="code-string">"ALLUMEE"</span> : <span class="code-string">"ETEINTE"</span>) + <span class="code-string">"\n"</span>;
etat += <span class="code-string">"Temperature: "</span> + <span class="code-type">String</span>(<span class="code-function">lireTemperatureSimulee</span>(), 1) + <span class="code-string">"C\n"</span>;
etat += <span class="code-string">"Memoire libre: "</span> + <span class="code-type">String</span>(<span class="code-function">ESP.getFreeHeap</span>()) + <span class="code-string">" bytes"</span>;

SerialBT.<span class="code-function">println</span>(etat);
Serial.<span class="code-function">println</span>(etat);
}

<span class="code-keyword">void</span> <span class="code-function">envoyerAide</span>() {
<span class="code-type">String</span> aide = <span class="code-string">"=== Commandes disponibles ===\n"</span>;
aide += <span class="code-string">"1 - Allumer LED\n"</span>;
aide += <span class="code-string">"0 - Eteindre LED\n"</span>;
aide += <span class="code-string">"s - Etat du systeme\n"</span>;
aide += <span class="code-string">"b - Bip (clignotement)\n"</span>;
aide += <span class="code-string">"? - Aide (ce message)"</span>;

SerialBT.<span class="code-function">println</span>(aide);
}

<span class="code-keyword">float</span> <span class="code-function">lireTemperatureSimulee</span>() {
<span class="code-comment">// Simulation de lecture de température</span>
<span class="code-keyword">return</span> 20.0 + (<span class="code-function">sin</span>(<span class="code-function">millis</span>() / 10000.0) * 10.0);
}</code></pre>
          </div>

          <h4>Bluetooth Low Energy (BLE) - Pour applications IoT</h4>
          <div class="code-example">
            <h5>Exemple : Serveur BLE avec caractéristiques personnalisées</h5>
            <pre><code><span class="code-comment">/*
Serveur BLE ESP32 avec services et caractéristiques
Contrôle une LED et lit un bouton via BLE
*/</span>

<span class="code-keyword">#include</span> &lt;BLEDevice.h&gt;
<span class="code-keyword">#include</span> &lt;BLEUtils.h&gt;
<span class="code-keyword">#include</span> &lt;BLEServer.h&gt;

<span class="code-comment">// UUIDs pour le service et les caractéristiques</span>
<span class="code-keyword">#define</span> SERVICE_UUID        <span class="code-string">"4fafc201-1fb5-459e-8fcc-c5c9c331914b"</span>
<span class="code-keyword">#define</span> CHARACTERISTIC_LED_UUID <span class="code-string">"beb5483e-36e1-4688-b7f5-ea07361b26a8"</span>
<span class="code-keyword">#define</span> CHARACTERISTIC_BOUTON_UUID <span class="code-string">"cba1d466-344c-4be3-ab3f-189f80dd7518"</span>
<span class="code-keyword">#define</span> CHARACTERISTIC_TEMP_UUID <span class="code-string">"d61f4c2e-6b3c-4a9d-bb5c-8c5d7a3e8c1a"</span>

<span class="code-comment">// Broches</span>
<span class="code-keyword">const</span> <span class="code-keyword">int</span> LED_PIN = 2;
<span class="code-keyword">const</span> <span class="code-keyword">int</span> BOUTON_PIN = 4;

<span class="code-comment">// Variables globales</span>
BLEServer *pServer = <span class="code-keyword">nullptr</span>;
BLECharacteristic *pCharacteristicLED = <span class="code-keyword">nullptr</span>;
BLECharacteristic *pCharacteristicBouton = <span class="code-keyword">nullptr</span>;
BLECharacteristic *pCharacteristicTemp = <span class="code-keyword">nullptr</span>;

<span class="code-keyword">bool</span> deviceConnected = <span class="code-keyword">false</span>;
<span class="code-keyword">bool</span> ancienDeviceConnected = <span class="code-keyword">false</span>;

<span class="code-comment">// Callback pour les événements de connexion BLE</span>
<span class="code-keyword">class</span> MyServerCallbacks: <span class="code-keyword">public</span> BLEServerCallbacks {
<span class="code-keyword">void</span> <span class="code-function">onConnect</span>(BLEServer* pServer) {
  deviceConnected = <span class="code-keyword">true</span>;
  Serial.<span class="code-function">println</span>(<span class="code-string">"Device BLE connecte"</span>);
}

<span class="code-keyword">void</span> <span class="code-function">onDisconnect</span>(BLEServer* pServer) {
  deviceConnected = <span class="code-keyword">false</span>;
  Serial.<span class="code-function">println</span>(<span class="code-string">"Device BLE deconnecte"</span>);
  <span class="code-comment">// Redémarrage de l'annonce pour permettre une reconnexion</span>
  pServer-&gt;<span class="code-function">getAdvertising</span>()-&gt;<span class="code-function">start</span>();
}
};

<span class="code-comment">// Callback pour les écritures sur la caractéristique LED</span>
<span class="code-keyword">class</span> LEDCharacteristicCallbacks: <span class="code-keyword">public</span> BLECharacteristicCallbacks {
<span class="code-keyword">void</span> <span class="code-function">onWrite</span>(BLECharacteristic *pCharacteristic) {
  <span class="code-type">std::string</span> value = pCharacteristic-&gt;<span class="code-function">getValue</span>();
  
  <span class="code-keyword">if</span> (value.<span class="code-function">length</span>() > 0) {
    <span class="code-type">char</span> commande = value[0];
    
    <span class="code-keyword">switch</span> (commande) {
      <span class="code-keyword">case</span> <span class="code-string">'1'</span>:
        <span class="code-function">digitalWrite</span>(LED_PIN, HIGH);
        Serial.<span class="code-function">println</span>(<span class="code-string">"LED allumee via BLE"</span>);
        <span class="code-keyword">break</span>;
        
      <span class="code-keyword">case</span> <span class="code-string">'0'</span>:
        <span class="code-function">digitalWrite</span>(LED_PIN, LOW);
        Serial.<span class="code-function">println</span>(<span class="code-string">"LED eteinte via BLE"</span>);
        <span class="code-keyword">break</span>;
        
      <span class="code-keyword">default</span>:
        Serial.<span class="code-function">print</span>(<span class="code-string">"Commande BLE inconnue: "</span>);
        Serial.<span class="code-function">println</span>(commande);
        <span class="code-keyword">break</span>;
    }
  }
}
};

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
Serial.<span class="code-function">begin</span>(115200);

<span class="code-comment">// Configuration des broches</span>
<span class="code-function">pinMode</span>(LED_PIN, OUTPUT);
<span class="code-function">pinMode</span>(BOUTON_PIN, INPUT_PULLUP);
<span class="code-function">digitalWrite</span>(LED_PIN, LOW);

Serial.<span class="code-function">println</span>(<span class="code-string">"Demarrage serveur BLE..."</span>);

<span class="code-comment">// Initialisation BLE</span>
BLEDevice::<span class="code-function">init</span>(<span class="code-string">"ESP32_BLE_Server"</span>);

<span class="code-comment">// Création du serveur BLE</span>
pServer = BLEDevice::<span class="code-function">createServer</span>();
pServer-&gt;<span class="code-function">setCallbacks</span>(<span class="code-keyword">new</span> MyServerCallbacks());

<span class="code-comment">// Création du service BLE</span>
BLEService *pService = pServer-&gt;<span class="code-function">createService</span>(SERVICE_UUID);

<span class="code-comment">// Création de la caractéristique LED (lecture/écriture)</span>
pCharacteristicLED = pService-&gt;<span class="code-function">createCharacteristic</span>(
  CHARACTERISTIC_LED_UUID,
  BLECharacteristic::PROPERTY_READ |
  BLECharacteristic::PROPERTY_WRITE
);
pCharacteristicLED-&gt;<span class="code-function">setCallbacks</span>(<span class="code-keyword">new</span> LEDCharacteristicCallbacks());
pCharacteristicLED-&gt;<span class="code-function">setValue</span>(<span class="code-string">"LED: 0"</span>);

<span class="code-comment">// Création de la caractéristique bouton (notify)</span>
pCharacteristicBouton = pService-&gt;<span class="code-function">createCharacteristic</span>(
  CHARACTERISTIC_BOUTON_UUID,
  BLECharacteristic::PROPERTY_READ |
  BLECharacteristic::PROPERTY_NOTIFY
);
pCharacteristicBouton-&gt;<span class="code-function">setValue</span>(<span class="code-string">"0"</span>);

<span class="code-comment">// Création de la caractéristique température (notify)</span>
pCharacteristicTemp = pService-&gt;<span class="code-function">createCharacteristic</span>(
  CHARACTERISTIC_TEMP_UUID,
  BLECharacteristic::PROPERTY_READ |
  BLECharacteristic::PROPERTY_NOTIFY
);
pCharacteristicTemp-&gt;<span class="code-function">setValue</span>(<span class="code-string">"20.0"</span>);

<span class="code-comment">// Démarrage du service</span>
pService-&gt;<span class="code-function">start</span>();

<span class="code-comment">// Démarrage de l'annonce BLE</span>
BLEAdvertising *pAdvertising = BLEDevice::<span class="code-function">getAdvertising</span>();
pAdvertising-&gt;<span class="code-function">addServiceUUID</span>(SERVICE_UUID);
pAdvertising-&gt;<span class="code-function">setScanResponse</span>(<span class="code-keyword">true</span>);
pAdvertising-&gt;<span class="code-function">setMinPreferred</span>(0x06);  <span class="code-comment">// Utile pour les connexions iPhone</span>
pAdvertising-&gt;<span class="code-function">setMinPreferred</span>(0x12);
BLEDevice::<span class="code-function">startAdvertising</span>();

Serial.<span class="code-function">println</span>(<span class="code-string">"Serveur BLE pret! Nom: ESP32_BLE_Server"</span>);
Serial.<span class="code-function">println</span>(<span class="code-string">"Connectez-vous avec une app BLE (ex: nRF Connect)"</span>);
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
<span class="code-comment">// Gestion des connexions/déconnexions</span>
<span class="code-keyword">if</span> (!deviceConnected && ancienDeviceConnected) {
  <span class="code-function">delay</span>(500);  <span class="code-comment">// Délai pour la pile Bluetooth</span>
  pServer-&gt;<span class="code-function">startAdvertising</span>();
  Serial.<span class="code-function">println</span>(<span class="code-string">"Annonce BLE redemarree"</span>);
  ancienDeviceConnected = deviceConnected;
}

<span class="code-keyword">if</span> (deviceConnected && !ancienDeviceConnected) {
  ancienDeviceConnected = deviceConnected;
}

<span class="code-keyword">static</span> <span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> dernierUpdate = 0;
<span class="code-keyword">if</span> (deviceConnected && (<span class="code-function">millis</span>() - dernierUpdate > 1000)) {
  dernierUpdate = <span class="code-function">millis</span>();
  
  <span class="code-comment">// Mise à jour de l'état du bouton</span>
  <span class="code-keyword">int</span> etatBouton = <span class="code-function">digitalRead</span>(BOUTON_PIN);
  <span class="code-type">String</span> valeurBouton = <span class="code-type">String</span>(etatBouton);
  pCharacteristicBouton-&gt;<span class="code-function">setValue</span>(valeurBouton.<span class="code-function">c_str</span>());
  pCharacteristicBouton-&gt;<span class="code-function">notify</span>();
  
  <span class="code-comment">// Mise à jour de la température simulée</span>
  <span class="code-keyword">float</span> temperature = <span class="code-function">lireTemperatureSimulee</span>();
  <span class="code-type">String</span> valeurTemp = <span class="code-type">String</span>(temperature, 1);
  pCharacteristicTemp-&gt;<span class="code-function">setValue</span>(valeurTemp.<span class="code-function">c_str</span>());
  pCharacteristicTemp-&gt;<span class="code-function">notify</span>();
  
  <span class="code-comment">// Mise à jour de l'état LED</span>
  <span class="code-keyword">int</span> etatLED = <span class="code-function">digitalRead</span>(LED_PIN);
  <span class="code-type">String</span> valeurLED = <span class="code-string">"LED: "</span> + <span class="code-type">String</span>(etatLED);
  pCharacteristicLED-&gt;<span class="code-function">setValue</span>(valeurLED.<span class="code-function">c_str</span>());
  
  <span class="code-keyword">if</span> (Serial.<span class="code-function">availableForWrite</span>()) {
    Serial.<span class="code-function">print</span>(<span class="code-string">"Bouton: "</span>);
    Serial.<span class="code-function">print</span>(valeurBouton);
    Serial.<span class="code-function">print</span>(<span class="code-string">" | Temp: "</span>);
    Serial.<span class="code-function">print</span>(valeurTemp);
    Serial.<span class="code-function">print</span>(<span class="code-string">"C | LED: "</span>);
    Serial.<span class="code-function">println</span>(etatLED);
  }
}

<span class="code-function">delay</span>(10);
}

<span class="code-keyword">float</span> <span class="code-function">lireTemperatureSimulee</span>() {
<span class="code-comment">// Simulation de température</span>
<span class="code-keyword">static</span> <span class="code-keyword">float</span> temp = 20.0;
temp += (<span class="code-function">random</span>(-10, 11) / 10.0);  <span class="code-comment">// Variation aléatoire</span>
temp = <span class="code-function">constrain</span>(temp, 15.0, 35.0);  <span class="code-comment">// Limites réalistes</span>
<span class="code-keyword">return</span> temp;
}</code></pre>
          </div>
        </section>

        <!-- Serveur Web ESP -->
        <section id="web-server">
          <h3>Serveur Web sur ESP32/ESP8266</h3>
          <p>Les modules ESP peuvent héberger des pages web pour contrôler et surveiller des dispositifs via un
            navigateur.</p>

          <h4>Serveur Web de base avec API REST</h4>
          <div class="info-box">
            <h4>Architecture du Serveur Web ESP</h4>
            <p>Ce code crée un <strong>serveur web complet</strong> sur ESP32/ESP8266 permettant de contrôler des LEDs et lire des capteurs à distance via un navigateur web.</p>
            
            <h5>Fonctionnement principal :</h5>
            <ol>
                <li><strong>Connexion WiFi</strong> : L'ESP se connecte au réseau et obtient une adresse IP accessible depuis n'importe quel navigateur</li>
                <li><strong>Serveur HTTP</strong> : Écoute sur le port 80 et gère les requêtes HTTP entrantes</li>
                <li><strong>API REST</strong> : Fournit des endpoints JSON pour la communication programme-programme</li>
                <li><strong>Interface Web</strong> : Génère dynamiquement une page HTML avec JavaScript pour l'interaction utilisateur</li>
            </ol>
            
            <h5>Routes principales :</h5>
            <ul>
                <li><code>/</code> → Page d'accueil HTML complète avec interface de contrôle</li>
                <li><code>/api/etat</code> → Retourne l'état des LEDs au format JSON</li>
                <li><code>/api/led/[couleur]</code> → Contrôle une LED spécifique (POST)</li>
                <li><code>/api/capteurs</code> → Lit les valeurs des capteurs (JSON)</li>
                <li><code>/api/leds</code> → Contrôle toutes les LEDs simultanément</li>
            </ul>
            
            <h5>Caractéristiques avancées :</h5>
            <ul>
                <li><strong>HTML généré dynamiquement</strong> : La page web est construite directement dans le code C++</li>
                <li><strong>JavaScript intégré</strong> : Gère les interactions utilisateur et les appels AJAX</li>
                <li><strong>Communication bidirectionnelle</strong> : L'utilisateur contrôle les LEDs et reçoit des données des capteurs</li>
                <li><strong>Interface responsive</strong> : S'adapte aux mobiles et ordinateurs</li>
                <li><strong>Actualisation automatique</strong> : Les données des capteurs se mettent à jour toutes les 2 secondes</li>
            </ul>
            
            <div class="warning-box">
                <p><strong>Points clés à retenir :</strong></p>
                <ul>
                    <li>L'ESP32 peut héberger un site web sans connexion Internet</li>
                    <li>La communication se fait via le réseau WiFi local</li>
                    <li>Le code mélange HTML, CSS, JavaScript et C++ dans un seul programme</li>
                    <li>Idéal pour les interfaces de contrôle domotique et IoT</li>
                </ul>
            </div>
        </div>
          <div class="code-example">
            <h5>Exemple : Serveur web avec API REST pour contrôler des LEDs</h5>
            <pre><code><span class="code-comment">/*
Serveur web ESP32 avec API REST
Contrôle de LEDs et lecture de capteurs via HTTP
*/</span>

<span class="code-keyword">#include</span> &lt;WiFi.h&gt;
<span class="code-keyword">#include</span> &lt;WebServer.h&gt;

<span class="code-comment">// Identifiants WiFi</span>
<span class="code-keyword">const</span> <span class="code-type">char</span>* ssid = <span class="code-string">"Votre_SSID"</span>;
<span class="code-keyword">const</span> <span class="code-type">char</span>* password = <span class="code-string">"Votre_Mot_De_Passe"</span>;

<span class="code-comment">// Broches</span>
<span class="code-keyword">const</span> <span class="code-keyword">int</span> LED_ROUGE = 25;
<span class="code-keyword">const</span> <span class="code-keyword">int</span> LED_VERTE = 26;
<span class="code-keyword">const</span> <span class="code-keyword">int</span> LED_BLEUE = 27;
<span class="code-keyword">const</span> <span class="code-keyword">int</span> BOUTON_PIN = 34;
<span class="code-keyword">const</span> <span class="code-keyword">int</span> POT_PIN = 35;

<span class="code-comment">// Variables d'état</span>
<span class="code-keyword">bool</span> ledRougeEtat = <span class="code-keyword">false</span>;
<span class="code-keyword">bool</span> ledVerteEtat = <span class="code-keyword">false</span>;
<span class="code-keyword">bool</span> ledBleueEtat = <span class="code-keyword">false</span>;

<span class="code-comment">// Serveur web sur le port 80</span>
WebServer server(80);

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
Serial.<span class="code-function">begin</span>(115200);

<span class="code-comment">// Configuration des broches</span>
<span class="code-function">pinMode</span>(LED_ROUGE, OUTPUT);
<span class="code-function">pinMode</span>(LED_VERTE, OUTPUT);
<span class="code-function">pinMode</span>(LED_BLEUE, OUTPUT);
<span class="code-function">pinMode</span>(BOUTON_PIN, INPUT);

<span class="code-function">digitalWrite</span>(LED_ROUGE, LOW);
<span class="code-function">digitalWrite</span>(LED_VERTE, LOW);
<span class="code-function">digitalWrite</span>(LED_BLEUE, LOW);

<span class="code-comment">// Connexion WiFi</span>
WiFi.<span class="code-function">begin</span>(ssid, password);
Serial.<span class="code-function">print</span>(<span class="code-string">"Connexion au WiFi..."</span>);

<span class="code-keyword">while</span> (WiFi.<span class="code-function">status</span>() != WL_CONNECTED) {
  <span class="code-function">delay</span>(500);
  Serial.<span class="code-function">print</span>(<span class="code-string">"."</span>);
}

Serial.<span class="code-function">println</span>();
Serial.<span class="code-function">print</span>(<span class="code-string">"Connecte! Adresse IP: "</span>);
Serial.<span class="code-function">println</span>(WiFi.<span class="code-function">localIP</span>());

<span class="code-comment">// Configuration des routes HTTP</span>
<span class="code-function">configurerRoutes</span>();

<span class="code-comment">// Démarrage du serveur</span>
server.<span class="code-function">begin</span>();
Serial.<span class="code-function">println</span>(<span class="code-string">"Serveur HTTP demarre!"</span>);
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
server.<span class="code-function">handleClient</span>();
<span class="code-function">delay</span>(2);  <span class="code-comment">// Permet au CPU de respirer</span>
}

<span class="code-keyword">void</span> <span class="code-function">configurerRoutes</span>() {
<span class="code-comment">// Page d'accueil</span>
server.<span class="code-function">on</span>(<span class="code-string">"/"</span>, HTTP_GET, []() {
  <span class="code-function">envoyerPageAccueil</span>();
});

<span class="code-comment">// API : État du système</span>
server.<span class="code-function">on</span>(<span class="code-string">"/api/etat"</span>, HTTP_GET, []() {
  <span class="code-function">envoyerJSONEtat</span>();
});

<span class="code-comment">// API : Contrôle LED rouge</span>
server.<span class="code-function">on</span>(<span class="code-string">"/api/led/rouge"</span>, HTTP_POST, []() {
  <span class="code-function">controlerLED</span>(LED_ROUGE, ledRougeEtat);
  server.<span class="code-function">send</span>(200, <span class="code-string">"application/json"</span>, <span class="code-string">"{\"status\":\"OK\",\"led\":\"rouge\",\"etat\":"</span> + <span class="code-type">String</span>(ledRougeEtat) + <span class="code-string">"}"</span>);
});

<span class="code-comment">// API : Contrôle LED verte</span>
server.<span class="code-function">on</span>(<span class="code-string">"/api/led/verte"</span>, HTTP_POST, []() {
  <span class="code-function">controlerLED</span>(LED_VERTE, ledVerteEtat);
  server.<span class="code-function">send</span>(200, <span class="code-string">"application/json"</span>, <span class="code-string">"{\"status\":\"OK\",\"led\":\"verte\",\"etat\":"</span> + <span class="code-type">String</span>(ledVerteEtat) + <span class="code-string">"}"</span>);
});

<span class="code-comment">// API : Contrôle LED bleue</span>
server.<span class="code-function">on</span>(<span class="code-string">"/api/led/bleue"</span>, HTTP_POST, []() {
  <span class="code-function">controlerLED</span>(LED_BLEUE, ledBleueEtat);
  server.<span class="code-function">send</span>(200, <span class="code-string">"application/json"</span>, <span class="code-string">"{\"status\":\"OK\",\"led\":\"bleue\",\"etat\":"</span> + <span class="code-type">String</span>(ledBleueEtat) + <span class="code-string">"}"</span>);
});

<span class="code-comment">// API : Lecture capteurs</span>
server.<span class="code-function">on</span>(<span class="code-string">"/api/capteurs"</span>, HTTP_GET, []() {
  <span class="code-function">envoyerJSONCapteurs</span>();
});

<span class="code-comment">// API : Contrôle toutes les LEDs</span>
server.<span class="code-function">on</span>(<span class="code-string">"/api/leds"</span>, HTTP_POST, []() {
  <span class="code-keyword">if</span> (server.<span class="code-function">hasArg</span>(<span class="code-string">"plain"</span>)) {
    <span class="code-type">String</span> body = server.<span class="code-function">arg</span>(<span class="code-string">"plain"</span>);
    <span class="code-function">traiterControleLEDs</span>(body);
  }
  server.<span class="code-function">send</span>(200, <span class="code-string">"application/json"</span>, <span class="code-string">"{\"status\":\"OK\"}"</span>);
});

<span class="code-comment">// Route 404 (non trouvée)</span>
server.<span class="code-function">onNotFound</span>([]() {
  server.<span class="code-function">send</span>(404, <span class="code-string">"text/plain"</span>, <span class="code-string">"404: Page non trouvee"</span>);
});
}

<span class="code-keyword">void</span> <span class="code-function">controlerLED</span>(<span class="code-keyword">int</span> pin, <span class="code-keyword">bool</span> &etat) {
etat = !etat;
<span class="code-function">digitalWrite</span>(pin, etat ? HIGH : LOW);
Serial.<span class="code-function">print</span>(<span class="code-string">"LED "</span>);
Serial.<span class="code-function">print</span>(pin);
Serial.<span class="code-function">print</span>(<span class="code-string">" : "</span>);
Serial.<span class="code-function">println</span>(etat ? <span class="code-string">"ON"</span> : <span class="code-string">"OFF"</span>);
}

<span class="code-keyword">void</span> <span class="code-function">envoyerPageAccueil</span>() {
<span class="code-type">String</span> html = <span class="code-string">"&lt;!DOCTYPE html&gt;\n"</span>;
html += <span class="code-string">"&lt;html lang='fr'&gt;\n"</span>;
html += <span class="code-string">"&lt;head&gt;\n"</span>;
html += <span class="code-string">"  &lt;meta charset='UTF-8'&gt;\n"</span>;
html += <span class="code-string">"  &lt;meta name='viewport' content='width=device-width, initial-scale=1'&gt;\n"</span>;
html += <span class="code-string">"  &lt;title&gt;Controle ESP32&lt;/title&gt;\n"</span>;
html += <span class="code-string">"  &lt;style&gt;\n"</span>;
html += <span class="code-string">"    body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }\n"</span>;
html += <span class="code-string">"    h1 { color: #333; }\n"</span>;
html += <span class="code-string">"    .led-control { margin: 20px 0; }\n"</span>;
html += <span class="code-string">"    .btn { padding: 10px 20px; margin: 5px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; }\n"</span>;
html += <span class="code-string">"    .btn-rouge { background-color: #ff4444; color: white; }\n"</span>;
html += <span class="code-string">"    .btn-vert { background-color: #44ff44; color: black; }\n"</span>;
html += <span class="code-string">"    .btn-bleu { background-color: #4444ff; color: white; }\n"</span>;
html += <span class="code-string">"    .btn-tout { background-color: #333; color: white; }\n"</span>;
html += <span class="code-string">"    .status { padding: 10px; margin: 10px 0; border-radius: 5px; }\n"</span>;
html += <span class="code-string">"    .status-on { background-color: #d4edda; border: 1px solid #c3e6cb; }\n"</span>;
html += <span class="code-string">"    .status-off { background-color: #f8d7da; border: 1px solid #f5c6cb; }\n"</span>;
html += <span class="code-string">"    .sensors { background-color: #e9ecef; padding: 15px; border-radius: 5px; margin: 20px 0; }\n"</span>;
html += <span class="code-string">"  &lt;/style&gt;\n"</span>;
html += <span class="code-string">"  &lt;script&gt;\n"</span>;
html += <span class="code-string">"    function controlerLED(couleur) {\n"</span>;
html += <span class="code-string">"      fetch('/api/led/' + couleur, { method: 'POST' })\n"</span>;
html += <span class="code-string">"        .then(response =&gt; response.json())\n"</span>;
html += <span class="code-string">"        .then(data =&gt; {\n"</span>;
html += <span class="code-string">"          document.getElementById('status-' + couleur).innerHTML = \n"</span>;
html += <span class="code-string">"            'LED ' + couleur.toUpperCase() + ': ' + (data.etat ? 'ALLUMEE' : 'ETEINTE');\n"</span>;
html += <span class="code-string">"          document.getElementById('status-' + couleur).className = \n"</span>;
html += <span class="code-string">"            'status ' + (data.etat ? 'status-on' : 'status-off');\n"</span>;
html += <span class="code-string">"        });\n"</span>;
html += <span class="code-string">"    }\n"</span>;
html += <span class="code-string">"    \n"</span>;
html += <span class="code-string">"    function controlerToutesLEDs(action) {\n"</span>;
html += <span class="code-string">"      fetch('/api/leds', {\n"</span>;
html += <span class="code-string">"        method: 'POST',\n"</span>;
html += <span class="code-string">"        headers: { 'Content-Type': 'application/json' },\n"</span>;
html += <span class="code-string">"        body: JSON.stringify({ action: action })\n"</span>;
html += <span class="code-string">"      }).then(() =&gt; actualiserEtat());\n"</span>;
html += <span class="code-string">"    }\n"</span>;
html += <span class="code-string">"    \n"</span>;
html += <span class="code-string">"    function actualiserCapteurs() {\n"</span>;
html += <span class="code-string">"      fetch('/api/capteurs')\n"</span>;
html += <span class="code-string">"        .then(response =&gt; response.json())\n"</span>;
html += <span class="code-string">"        .then(data =&gt; {\n"</span>;
html += <span class="code-string">"          document.getElementById('bouton').innerHTML = data.bouton ? 'APPUYE' : 'RELAche';\n"</span>;
html += <span class="code-string">"          document.getElementById('potentiometre').innerHTML = data.potentiometre + ' (' + Math.round(data.potentiometre/4095*100) + '%)';\n"</span>;
html += <span class="code-string">"          document.getElementById('temperature').innerHTML = data.temperature + '°C';\n"</span>;
html += <span class="code-string">"        });\n"</span>;
html += <span class="code-string">"    }\n"</span>;
html += <span class="code-string">"    \n"</span>;
html += <span class="code-string">"    function actualiserEtat() {\n"</span>;
html += <span class="code-string">"      fetch('/api/etat')\n"</span>;
html += <span class="code-string">"        .then(response =&gt; response.json())\n"</span>;
html += <span class="code-string">"        .then(data =&gt; {\n"</span>;
html += <span class="code-string">"          ['rouge', 'verte', 'bleue'].forEach(couleur =&gt; {\n"</span>;
html += <span class="code-string">"            document.getElementById('status-' + couleur).innerHTML = \n"</span>;
html += <span class="code-string">"              'LED ' + couleur.toUpperCase() + ': ' + (data['led_' + couleur] ? 'ALLUMEE' : 'ETEINTE');\n"</span>;
html += <span class="code-string">"            document.getElementById('status-' + couleur).className = \n"</span>;
html += <span class="code-string">"              'status ' + (data['led_' + couleur] ? 'status-on' : 'status-off');\n"</span>;
html += <span class="code-string">"          });\n"</span>;
html += <span class="code-string">"        });\n"</span>;
html += <span class="code-string">"    }\n"</span>;
html += <span class="code-string">"    \n"</span>;
html += <span class="code-string">"    // Actualisation automatique toutes les 2 secondes\n"</span>;
html += <span class="code-string">"    setInterval(actualiserCapteurs, 2000);\n"</span>;
html += <span class="code-string">"    setInterval(actualiserEtat, 2000);\n"</span>;
html += <span class="code-string">"    \n"</span>;
html += <span class="code-string">"    // Initialisation\n"</span>;
html += <span class="code-string">"    window.onload = function() {\n"</span>;
html += <span class="code-string">"      actualiserEtat();\n"</span>;
html += <span class="code-string">"      actualiserCapteurs();\n"</span>;
html += <span class="code-string">"    };\n"</span>;
html += <span class="code-string">"  &lt;/script&gt;\n"</span>;
html += <span class="code-string">"&lt;/head&gt;\n"</span>;
html += <span class="code-string">"&lt;body&gt;\n"</span>;
html += <span class="code-string">"  &lt;h1&gt;🌐 Controle ESP32 par Web&lt;/h1&gt;\n"</span>;
html += <span class="code-string">"  \n"</span>;
html += <span class="code-string">"  &lt;div class='sensors'&gt;\n"</span>;
html += <span class="code-string">"    &lt;h3&gt;📊 Capteurs&lt;/h3&gt;\n"</span>;
html += <span class="code-string">"    &lt;p&gt;Bouton: &lt;span id='bouton'&gt;--&lt;/span&gt;&lt;/p&gt;\n"</span>;
html += <span class="code-string">"    &lt;p&gt;Potentiometre: &lt;span id='potentiometre'&gt;--&lt;/span&gt;&lt;/p&gt;\n"</span>;
html += <span class="code-string">"    &lt;p&gt;Temperature: &lt;span id='temperature'&gt;--&lt;/span&gt;&lt;/p&gt;\n"</span>;
html += <span class="code-string">"  &lt;/div&gt;\n"</span>;
html += <span class="code-string">"  \n"</span>;
html += <span class="code-string">"  &lt;h3&gt;💡 Controle LEDs&lt;/h3&gt;\n"</span>;
html += <span class="code-string">"  \n"</span>;
html += <span class="code-string">"  &lt;div class='led-control'&gt;\n"</span>;
html += <span class="code-string">"    &lt;button class='btn btn-rouge' onclick='controlerLED(\"rouge\")'&gt;LED Rouge&lt;/button&gt;\n"</span>;
html += <span class="code-string">"    &lt;div id='status-rouge' class='status'&gt;LED ROUGE: --&lt;/div&gt;\n"</span>;
html += <span class="code-string">"  &lt;/div&gt;\n"</span>;
html += <span class="code-string">"  \n"</span>;
html += <span class="code-string">"  &lt;div class='led-control'&gt;\n"</span>;
html += <span class="code-string">"    &lt;button class='btn btn-vert' onclick='controlerLED(\"verte\")'&gt;LED Verte&lt;/button&gt;\n"</span>;
html += <span class="code-string">"    &lt;div id='status-verte' class='status'&gt;LED VERTE: --&lt;/div&gt;\n"</span>;
html += <span class="code-string">"  &lt;/div&gt;\n"</span>;
html += <span class="code-string">"  \n"</span>;
html += <span class="code-string">"  &lt;div class='led-control'&gt;\n"</span>;
html += <span class="code-string">"    &lt;button class='btn btn-bleu' onclick='controlerLED(\"bleue\")'&gt;LED Bleue&lt;/button&gt;\n"</span>;
html += <span class="code-string">"    &lt;div id='status-bleue' class='status'&gt;LED BLEUE: --&lt;/div&gt;\n"</span>;
html += <span class="code-string">"  &lt;/div&gt;\n"</span>;
html += <span class="code-string">"  \n"</span>;
html += <span class="code-string">"  &lt;div class='led-control'&gt;\n"</span>;
html += <span class="code-string">"    &lt;button class='btn btn-tout' onclick='controlerToutesLEDs(\"all\")'&gt;🔆 Allumer toutes&lt;/button&gt;\n"</span>;
html += <span class="code-string">"    &lt;button class='btn btn-tout' onclick='controlerToutesLEDs(\"none\")'&gt;🌙 Eteindre toutes&lt;/button&gt;\n"</span>;
html += <span class="code-string">"  &lt;/div&gt;\n"</span>;
html += <span class="code-string">"  \n"</span>;
html += <span class="code-string">"  &lt;hr&gt;\n"</span>;
html += <span class="code-string">"  &lt;p&gt;Adresse IP: "</span> + WiFi.<span class="code-function">localIP</span>().<span class="code-function">toString</span>() + <span class="code-string">"&lt;/p&gt;\n"</span>;
html += <span class="code-string">"  &lt;p&gt;Uptime: &lt;span id='uptime'&gt;"</span> + <span class="code-type">String</span>(<span class="code-function">millis</span>() / 1000) + <span class="code-string">"s&lt;/span&gt;&lt;/p&gt;\n"</span>;
html += <span class="code-string">"&lt;/body&gt;\n"</span>;
html += <span class="code-string">"&lt;/html&gt;"</span>;

server.<span class="code-function">send</span>(200, <span class="code-string">"text/html"</span>, html);
}

<span class="code-keyword">void</span> <span class="code-function">envoyerJSONEtat</span>() {
<span class="code-type">String</span> json = <span class="code-string">"{"</span>;
json += <span class="code-string">"\"led_rouge\":"</span> + <span class="code-type">String</span>(ledRougeEtat) + <span class="code-string">","</span>;
json += <span class="code-string">"\"led_verte\":"</span> + <span class="code-type">String</span>(ledVerteEtat) + <span class="code-string">","</span>;
json += <span class="code-string">"\"led_bleue\":"</span> + <span class="code-type">String</span>(ledBleueEtat) + <span class="code-string">","</span>;
json += <span class="code-string">"\"uptime\":"</span> + <span class="code-type">String</span>(<span class="code-function">millis</span>() / 1000);
json += <span class="code-string">"}"</span>;

server.<span class="code-function">send</span>(200, <span class="code-string">"application/json"</span>, json);
}

<span class="code-keyword">void</span> <span class="code-function">envoyerJSONCapteurs</span>() {
<span class="code-keyword">int</span> bouton = <span class="code-function">digitalRead</span>(BOUTON_PIN);
<span class="code-keyword">int</span> potentiometre = <span class="code-function">analogRead</span>(POT_PIN);
<span class="code-keyword">float</span> temperature = <span class="code-function">lireTemperatureSimulee</span>();

<span class="code-type">String</span> json = <span class="code-string">"{"</span>;
json += <span class="code-string">"\"bouton\":"</span> + <span class="code-type">String</span>(bouton) + <span class="code-string">","</span>;
json += <span class="code-string">"\"potentiometre\":"</span> + <span class="code-type">String</span>(potentiometre) + <span class="code-string">","</span>;
json += <span class="code-string">"\"temperature\":"</span> + <span class="code-type">String</span>(temperature, 1);
json += <span class="code-string">"}"</span>;

server.<span class="code-function">send</span>(200, <span class="code-string">"application/json"</span>, json);
}

<span class="code-keyword">void</span> <span class="code-function">traiterControleLEDs</span>(<span class="code-type">String</span> json) {
<span class="code-comment">// Analyse simple du JSON (pour un vrai projet, utilisez une bibliothèque JSON)</span>
<span class="code-keyword">if</span> (json.<span class="code-function">indexOf</span>(<span class="code-string">"\"action\":\"all\""</span>) != -1) {
  <span class="code-comment">// Allumer toutes les LEDs</span>
  ledRougeEtat = <span class="code-keyword">true</span>;
  ledVerteEtat = <span class="code-keyword">true</span>;
  ledBleueEtat = <span class="code-keyword">true</span>;
  <span class="code-function">digitalWrite</span>(LED_ROUGE, HIGH);
  <span class="code-function">digitalWrite</span>(LED_VERTE, HIGH);
  <span class="code-function">digitalWrite</span>(LED_BLEUE, HIGH);
  Serial.<span class="code-function">println</span>(<span class="code-string">"Toutes les LEDs allumees"</span>);
} <span class="code-keyword">else</span> <span class="code-keyword">if</span> (json.<span class="code-function">indexOf</span>(<span class="code-string">"\"action\":\"none\""</span>) != -1) {
  <span class="code-comment">// Éteindre toutes les LEDs</span>
  ledRougeEtat = <span class="code-keyword">false</span>;
  ledVerteEtat = <span class="code-keyword">false</span>;
  ledBleueEtat = <span class="code-keyword">false</span>;
  <span class="code-function">digitalWrite</span>(LED_ROUGE, LOW);
  <span class="code-function">digitalWrite</span>(LED_VERTE, LOW);
  <span class="code-function">digitalWrite</span>(LED_BLEUE, LOW);
  Serial.<span class="code-function">println</span>(<span class="code-string">"Toutes les LEDs eteintes"</span>);
}
}

<span class="code-keyword">float</span> <span class="code-function">lireTemperatureSimulee</span>() {
<span class="code-comment">// Simulation de température basée sur la valeur du potentiomètre</span>
<span class="code-keyword">int</span> pot = <span class="code-function">analogRead</span>(POT_PIN);
<span class="code-keyword">return</span> 20.0 + (pot / 4095.0) * 30.0;  <span class="code-comment">// 20°C à 50°C</span>
}</code></pre>
          </div>
        </section>
      </section>

      <!-- =========================================== -->
      <!-- SECTION PROJETS PRATIQUES -->
      <!-- =========================================== -->
      <section id="projets">
        <h2>Projets pratiques Arduino/ESP</h2>
        <p>Appliquez vos connaissances avec ces projets concrets, du débutant au confirmé.</p>

        <div class="project-gallery">
          <!-- Projet 1 -->
          <div class="project-card">
            <div class="project-image">
              <i class="fas fa-thermometer-half"></i>
            </div>
            <div class="project-content">
              <span class="difficulty beginner">Débutant</span>
              <h4 id="projet1">Station météo avec affichage LCD</h4>
              <p>Mesure la température et l'humidité avec un capteur DHT11 et affiche les données sur un écran LCD 16x2.
              </p>
              <p><strong>Composants :</strong> Arduino Uno, DHT11, LCD 16x2, potentiomètre</p>
            </div>
          </div>

          <!-- Projet 2 -->
          <div class="project-card">
            <div class="project-image">
              <i class="fas fa-home"></i>
            </div>
            <div class="project-content">
              <span class="difficulty intermediate">Intermédiaire</span>
              <h4 id="projet2">Système domotique avec ESP32</h4>
              <p>Contrôle l'éclairage et les appareils via WiFi avec une interface web. Inclut capteurs de mouvement et
                relais.</p>
              <p><strong>Composants :</strong> ESP32, relais 5V, capteur PIR, LED</p>
            </div>
          </div>

          <!-- Projet 3 -->
          <div class="project-card">
            <div class="project-image">
              <i class="fas fa-robot"></i>
            </div>
            <div class="project-content">
              <span class="difficulty intermediate">Intermédiaire</span>
              <h4 id="projet3">Robot suiveur de ligne</h4>
              <p>Robot autonome qui suit une ligne noire au sol. Utilise des capteurs infrarouges et contrôle des
                moteurs DC.</p>
              <p><strong>Composants :</strong> Arduino Nano, capteurs IR, moteurs DC, pont H L298N</p>
            </div>
          </div>

          <!-- Projet 4 -->
          <div class="project-card">
            <div class="project-image">
              <i class="fas fa-tint"></i>
            </div>
            <div class="project-content">
              <span class="difficulty advanced">Avancé</span>
              <h4 id="projet4">Système d'arrosage automatique intelligent</h4>
              <p>Arrose les plantes automatiquement en fonction de l'humidité du sol. Notification via MQTT et
                historique des données.</p>
              <p><strong>Composants :</strong> ESP32, capteur d'humidité sol, électrovanne, module RTC</p>
            </div>
          </div>
        </div>

        <h3>Projet détaillé : Station météo</h3>
        <div class="code-example">
          <pre><code><span class="code-comment">/*
  Station météo avec DHT11 et LCD
  Affiche température et humidité
*/</span>

<span class="code-keyword">#include</span> &lt;LiquidCrystal.h&gt;
<span class="code-keyword">#include</span> &lt;DHT.h&gt;

<span class="code-comment">// Définition des broches</span>
<span class="code-keyword">#define</span> DHTPIN 2          <span class="code-comment">// Broche du capteur DHT</span>
<span class="code-keyword">#define</span> DHTTYPE DHT11     <span class="code-comment">// Type de capteur</span>

<span class="code-comment">// Broches LCD (RS, EN, D4, D5, D6, D7)</span>
LiquidCrystal lcd(12, 11, 5, 4, 3, 2);

<span class="code-comment">// Initialisation du capteur DHT</span>
DHT dht(DHTPIN, DHTTYPE);

<span class="code-comment">// Variables</span>
<span class="code-keyword">float</span> temperature;
<span class="code-keyword">float</span> humidite;
<span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> dernierRefresh = 0;
<span class="code-keyword">const</span> <span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> intervalRefresh = 2000;  <span class="code-comment">// 2 secondes</span>

<span class="code-keyword">void</span> <span class="code-function">setup</span>() {
  Serial.<span class="code-function">begin</span>(9600);
  
  <span class="code-comment">// Initialisation LCD (16 colonnes, 2 lignes)</span>
  lcd.<span class="code-function">begin</span>(16, 2);
  
  <span class="code-comment">// Initialisation DHT</span>
  dht.<span class="code-function">begin</span>();
  
  <span class="code-comment">// Message d'accueil</span>
  lcd.<span class="code-function">print</span>(<span class="code-string">"Station Meteo"</span>);
  <span class="code-function">delay</span>(2000);
  lcd.<span class="code-function">clear</span>();
  
  Serial.<span class="code-function">println</span>(<span class="code-string">"Station meteo initialisee"</span>);
}

<span class="code-keyword">void</span> <span class="code-function">loop</span>() {
  <span class="code-keyword">unsigned</span> <span class="code-keyword">long</span> maintenant = <span class="code-function">millis</span>();
  
  <span class="code-keyword">if</span> (maintenant - dernierRefresh >= intervalRefresh) {
    dernierRefresh = maintenant;
    
    <span class="code-comment">// Lecture des données</span>
    humidite = dht.<span class="code-function">readHumidity</span>();
    temperature = dht.<span class="code-function">readTemperature</span>();
    
    <span class="code-comment">// Vérification de la lecture</span>
    <span class="code-keyword">if</span> (<span class="code-function">isnan</span>(humidite) || <span class="code-function">isnan</span>(temperature)) {
      Serial.<span class="code-function">println</span>(<span class="code-string">"Erreur lecture DHT!"</span>);
      lcd.<span class="code-function">clear</span>();
      lcd.<span class="code-function">print</span>(<span class="code-string">"Erreur capteur"</span>);
      <span class="code-keyword">return</span>;
    }
    
    <span class="code-comment">// Affichage sur LCD</span>
    lcd.<span class="code-function">clear</span>();
    
    <span class="code-comment">// Ligne 1: Température</span>
    lcd.<span class="code-function">setCursor</span>(0, 0);
    lcd.<span class="code-function">print</span>(<span class="code-string">"Temp: "</span>);
    lcd.<span class="code-function">print</span>(temperature, 1);
    lcd.<span class="code-function">print</span>((<span class="code-type">char</span>)223);  <span class="code-comment">// Degré</span>
    lcd.<span class="code-function">print</span>(<span class="code-string">"C"</span>);
    
    <span class="code-comment">// Ligne 2: Humidité</span>
    lcd.<span class="code-function">setCursor</span>(0, 1);
    lcd.<span class="code-function">print</span>(<span class="code-string">"Hum:  "</span>);
    lcd.<span class="code-function">print</span>(humidite, 0);
    lcd.<span class="code-function">print</span>(<span class="code-string">"%"</span>);
    
    <span class="code-comment">// Affichage sur moniteur série</span>
    Serial.<span class="code-function">print</span>(<span class="code-string">"Temperature: "</span>);
    Serial.<span class="code-function">print</span>(temperature);
    Serial.<span class="code-function">print</span>(<span class="code-string">"°C | Humidite: "</span>);
    Serial.<span class="code-function">print</span>(humidite);
    Serial.<span class="code-function">println</span>(<span class="code-string">"%"</span>);
    
    <span class="code-comment">// Avertissement si température trop élevée</span>
    <span class="code-keyword">if</span> (temperature > 30) {
      lcd.<span class="code-function">setCursor</span>(12, 0);
      lcd.<span class="code-function">print</span>(<span class="code-string">"HOT"</span>);
    } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (temperature < 10) {
      lcd.<span class="code-function">setCursor</span>(12, 0);
      lcd.<span class="code-function">print</span>(<span class="code-string">"COLD"</span>);
    }
  }
}</code></pre>
        </div>
      </section>

      <!-- Navigation buttons -->
      <div class="nav-buttons">
        <a href="#premier-programme" class="nav-button prev"><i class="fas fa-arrow-left"></i> Premier programme</a>
        <a href="#exercices" class="nav-button next">Exercices pratiques <i class="fas fa-arrow-right"></i></a>
      </div>
    </main>
  </div>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h3>ArduinoLearn</h3>
          <p>Votre ressource complète pour apprendre la programmation Arduino et ESP. Des tutoriels pour débutants aux
            projets avancés.</p>
        </div>
        <div class="footer-section">
          <h3>Sections principales</h3>
          <ul>
            <li><a href="#structure">Structure avancée</a></li>
            <li><a href="#variables">Variables et types</a></li>
            <li><a href="#fonctions">Fonctions de base</a></li>
            <li><a href="#entrees-sorties">Entrées/Sorties</a></li>
            <li><a href="#allumer-led">Allumer une LED</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h3>Contenu avancé</h3>
          <ul>
            <li><a href="#bibliotheques">Bibliothèques</a></li>
            <li><a href="#structures-controle">Structures de contrôle</a></li>
            <li><a href="#communication">Communication ESP</a></li>
            <li><a href="#projets">Projets pratiques</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h3>À propos</h3>
          <p>Ce site est conçu pour les débutants souhaitant apprendre la programmation Arduino et ESP avec des exemples
            clairs et pratiques.</p>
        </div>
      </div>
      <div class="copyright">
        <p>&copy; 2023 ArduinoLearn. Tous droits réservés. | Conçu pour l'apprentissage</p>
      </div>
    </div>
  </footer>

  <script>
    // Gestion de la navigation et des ancres
    document.addEventListener('DOMContentLoaded', function () {
      // Navigation par ancres
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          const targetId = this.getAttribute('href');
          if (targetId === '#' || targetId === '#tutoriels') return;

          // Si c'est un lien interne (commence par #)
          if (targetId.startsWith('#')) {
            e.preventDefault();
            const targetElement = document.querySelector(targetId);
            if (targetElement) {
              // Scroll vers l'élément
              window.scrollTo({
                top: targetElement.offsetTop - 100,
                behavior: 'smooth'
              });

              // Met à jour l'URL sans recharger la page
              history.pushState(null, null, targetId);

              // Met à jour le lien actif dans la sidebar
              updateActiveSidebarLink(targetId);
            }
          }
        });
      });

      // Fonction pour mettre à jour le lien actif dans la sidebar
      function updateActiveSidebarLink(targetId) {
        // Retire la classe active de tous les liens
        document.querySelectorAll('.sidebar a').forEach(link => {
          link.classList.remove('active');
        });

        // Ajoute la classe active au lien correspondant
        const activeLink = document.querySelector(`.sidebar a[href="${targetId}"]`);
        if (activeLink) {
          activeLink.classList.add('active');

          // Si c'est un sous-menu, active aussi le parent
          const parentLi = activeLink.closest('.sub-menu');
          if (parentLi) {
            const parentLink = parentLi.previousElementSibling;
            if (parentLink && parentLink.tagName === 'A') {
              parentLink.classList.add('active');
            }
          }
        }
      }

      // Gestion de l'état actif au chargement de la page
      if (window.location.hash) {
        const targetElement = document.querySelector(window.location.hash);
        if (targetElement) {
          setTimeout(() => {
            window.scrollTo({
              top: targetElement.offsetTop - 100,
              behavior: 'smooth'
            });
            updateActiveSidebarLink(window.location.hash);
          }, 100);
        }
      }

      // Met à jour l'URL lors du défilement
      let sections = document.querySelectorAll('section[id]');
      window.addEventListener('scroll', function () {
        let current = '';
        let scrollPosition = window.scrollY + 150;

        sections.forEach(section => {
          const sectionTop = section.offsetTop;
          const sectionHeight = section.clientHeight;

          if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
            current = '#' + section.getAttribute('id');
          }
        });

        if (current) {
          history.replaceState(null, null, current);
          updateActiveSidebarLink(current);
        }
      });

      // Sidebar sticky behavior
      const sidebar = document.querySelector('.sidebar');
      const sidebarTop = sidebar.offsetTop;

      window.addEventListener('scroll', function () {
        if (window.innerWidth > 768) { // Desktop seulement
          if (window.scrollY >= sidebarTop - 100) {
            sidebar.style.position = 'sticky';
            sidebar.style.top = '100px';
          } else {
            sidebar.style.position = 'static';
          }
        }
      });
    });
  </script>
</body>

</html>